{"version":3,"sources":["GDriveAuthClient.js","googleIcon.js","GoogleSignInButton.js","HelpWindow.js","AppMenu.js","Popup.js","EmojiPicker.js","Entry.js","VirtualizedList.js","EntriesTable.js","AppContent.js","Interface.js","BackendMap.js","GDriveMap.js","EntriesTableModel.js","BackendQuotaSavers.js","App.js","serviceWorker.js","index.js","CenteredTypography.js","Settings.js"],"names":["GDriveStates","LOADING","SIGNED_IN","SIGNED_OUT","FAILED","Object","freeze","gdriveAuthClient","Set","ondone","console","assert","length","script","document","createElement","async","src","body","appendChild","onload","onerror","loadGapi","a","window","gapi","Error","Promise","resolve","load","client","init","clientId","discoveryDocs","scope","isGapiLoaded","_updateSignInState","auth2","getAuthInstance","isSignedIn","listen","bind","log","_notifyStateChanged","listener","this","has","add","delete","addStateListener","state","removeStateListener","mocha","signIn","prompt","signOut","current_state","get","seal","active","style","display","padding","width","height","xmlns","fill","fillRule","d","ButtonContent","children","paddingLeft","fontWeight","buttonStyle","backgroundColor","alignItems","color","boxShadow","borderRadius","border","fontSize","fontFamily","cursor","disabledStyle","opacity","GoogleSignInButton","authState","props","prevAuthState","buttonAnchor","setState","prevState","assign","alertElement","Alert","severity","AlertTitle","href","ref","onClick","type","key","Popper","zIndex","open","anchorEl","placement","disablePortal","modifiers","flip","enabled","preventOverflow","hide","offset","React","PureComponent","useStyles","makeStyles","theme","root","position","top","left","palette","background","paper","HelpWindow","forwardRef","styles","className","SettingsWindow","lazy","buttonsContainer","justifyContent","titleContainer","flexDirection","modal","default","overflow","breakpoints","up","ModalWindowButton","useState","setOpen","useEffect","model","setIgnoreKeys","onWindowClose","Fragment","IconButton","Modal","onClose","cloneElement","AppMenu","classes","Collapse","appear","in","shown","Toolbar","Slide","direction","AppBar","Grid","container","justify","Hidden","xsDown","item","xs","Typography","variant","align","smUp","sm","Help","edge","Settings","fallback","CenteredTypography","outer","popup","minWidth","Popup","Zoom","alignSelf","margin","borderColor","focused","setupItem","isActive","icon","isSelected","emoji","userSelect","value","EmojiItem","text","role","aria-label","String","fromCodePoint","RadioIcon","selectedValue","SvgIcon","viewBox","y","EmojiSetupItem","onChange","EmojiPicker","setFocus","selectedRow","setSelectedRow","popupRef","useRef","emojiArray","activeEmojiArray","filter","x","rowCounter","tabIndex","onFocus","event","onBlur","current","contains","activeElement","onKeyDown","clone","onEmojiArrayChange","inputRef","focus","preventDefault","map","codePoint","EntryStatus","LastChange","EntryModel","data","description","_data","_key","_initiallyCollapsed","_focused","lastChange","_setDescriptionImpl","cloneModel","isDataLoaded","error","right","result","setDescription","_generateDescription","_emojiArrays","_creationTime","creationTime","collapsed","_description","split","serializedEmoji","serializedCreationTime","Array","from","Number","push","Date","isNaN","getTime","descrciption","every","join","paperStyle","borderWidth","primary","light","inner","flex","input","marginTop","hasCreationTime","minHeight","hasEmoji","down","date","hint","whiteSpace","SubItem","onFocusOuter","emojiText","onDelete","onCollapseExited","deleteXsDown","deleteSmUp","setFocused","emojiFocused","setEmojiFocused","autoFocus","onExited","onEntered","getSelection","toString","moment","format","InputBase","fullWidth","multiline","placeholder","isEnabled","size","Entry","onUpdate","entry","onRightChanged","settings","otherProps","initiallyCollapsed","setCollapsed","colSpan","setInitiallyCollapsed","show","emojiLeft","emojiRight","i","emojiList","emojiArrays","onEntryChanged","updatedEntry","alreadyFocused","setLeft","target","leftHint","newLeftEmojiArray","setEmojiLeft","Skeleton","setRight","rightHint","newRightEmojiArray","setEmojiRight","VirtualizedItem","createRef","onHeightChanged","offsetHeight","ResizeObserver","observe","scrollableContainerRef","disconnect","ItemComponent","VirtualizedList","entries","defaultHeight","PlaceholderComponent","restProps","scrollY","setScrollY","innerHeight","windowHeight","setWindowHeight","Map","realHeightsMap","setRealHeightsMap","useCallback","oldMap","newMap","set","keys","keysToDelete","forEach","_value","onResizeOrScroll","scrollTop","onscroll","addEventListener","removeEventListener","visibleEntries","currentHeight","placeholderTop","placeholderBottom","entryHeight","unshift","Placeholder","rest","EntriesTableRaw","_onEntriesChanged","canRedo","canUndo","DateEntry","calendar","sameDay","lastDay","lastWeek","sameElse","dateToInsert","currentCreationTime","getYear","getMonth","getDay","splice","_tableRef","_scrollableContainerRef","_columnResizer","_resizeObserver","subscribe","ColumnResizer","liveDrag","gripInnerHtml","grip","onResize","e","dispatchEvent","Event","_","throttle","prevProps","unsubscribe","destroy","unobserve","spacing","appBarShown","onShowAppBar","buttons","Button","addNewItemThrottled","undo","disabled","redo","cellPadding","cellSpacing","entriesTable","EntriesTable","withStyles","willChange","transitionDuration","transitionProperty","borderSpacing","borderBottom","verticalAlign","borderLeft","borderRight","AppContent","signInState","setSignInState","Backdrop","invisible","CircularProgress","Interface","name","setTimeout","BackendMap","requireFunction","gdriveMap","find","createEmptyFile","id","firstKey","deleteFile","throwIfNotSignedIn","upload","download","getMd5","element","_getSettingsKey","settingsContent","patchDescription","prom","gapiCall","argObj","stack","reject","then","resp","status","err","mimeType","drive","files","create","resource","parents","fields","fileId","boundary","multipartRequestBody","delimiter","JSON","stringify","request","path","method","params","uploadType","headers","content","md5Checksum","alt","undefined","query","ret","list","spaces","pageSize","pageToken","token","orderBy","q","concat","nextPageToken","EntriesTableModelImpl","backendMap","authClient","addNewItem","omitHistory","_addNewItemMutex","acquire","release","_tryFindVacantEntry","_createNewEntry","clear","setCreationTime","now","_historyIndex","_history","old","new","_entries","_sendEntryToBackend","historyItem","sync","_disposed","_authClient","waitForStateChange","_backendMap","getAllKeys","newEntries","outdated","_descriptions","promises","_settings","_fetchSettings","reverse","_fetch","all","onSettingsUpdate","debounce","setSettings","prevEntry","_addHistoryItem","Mutex","_subscriptions","_syncLoop","_onKeyPress","_ignoreKeys","ctrlKey","keyCode","parse","message","callback","_getFilteredEntriesArray","lastVacantEntry","createKey","newKey","newEntry","ignoreKeys","slice","descriptionPromise","dataPromise","getSettings","serializedSettings","_serializedSettings","values","BackendMultiplexor","innerMap","_changeKeysMutex","_innerKeys","_innerBackendMap","_createChunkConnector","innerkey","setValue","serializedValue","serializedDescription","getValue","indexOf","_chunks","_Chunk","connector","serializedDescriptions","_onValueSet","_serializedValues","_values","_connector","_onDescriptionSet","_serializedDescriptions","_fetchValuesSynchronised","_fetchPromise","_fetchValues","serializedValues","isArray","_initialMd5Checksum","md5","_isDirty","_shouldKeepOnFormatError","subkeys","isFull","subkey","_splitOuterKey","outerKey","separator","prefixKey","substring","innerKey","getLastInnerKey","newInnerKey","createSubKey","keyPrefix","newInnerKeys","outerKeys","newChunks","counter","isFirstChunk","chunk","onMetadataUpdate","listSubKeys","getDescription","ErrorHandler","retriesCount","secondsToNextRetry","_sleep","_exponentialRetry","ms","RequestThrottler","_limiter","Bottleneck","maxConcurrent","minTime","schedule","App","prefersDarkMode","useMediaQuery","useMemo","createMuiTheme","main","blueGrey","blue","setAppBarShown","onTableEntryFocus","arg","showAppBar","setModel","newState","oldModel","dispose","ThemeProvider","CssBaseline","Boolean","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","Hint","_isEnabled","_text","json","_emojiList","_leftHint","_rightHint","_mutateToDefaults"],"mappings":"mVACaA,EAAe,CAC1BC,QAAS,UACTC,UAAW,YACXC,WAAY,aACZC,OAAQ,UAEVC,OAAOC,OAAON,G,2DA4GDO,EAAmB,I,WAzE9B,aAAe,IAAD,2EAhCLP,EAAaC,UAgCR,gDA/BI,IAAIO,MA4GxB,SAAkBC,GAChBC,QAAQC,OAAwB,mBAAVF,GACtBC,QAAQC,OAAyB,IAAlBF,EAAOG,QACtB,IAAIC,EAASC,SAASC,cAAc,UACpCF,EAAOG,OAAQ,EACfH,EAAOI,IAAM,oCACbH,SAASI,KAAKC,YAAYN,GAC1BA,EAAOO,OAASX,EAChBI,EAAOQ,QAAUZ,EApFfa,CAAQ,sBAAC,sBAAAC,EAAA,kEAEAC,OAAOC,KAFP,sBAGG,IAAIC,MAAM,uBAHb,uBAMC,IAAIC,SAAQ,SAACC,GAAD,OAChBJ,OAAOC,KAAKI,KAAK,eAAgBD,MAP9B,uBAUCJ,OAAOC,KAAKK,OAAOC,KAAK,CAC5BC,SACE,2EACFC,cAAe,CACb,8DAEFC,MAAO,oDAhBJ,UAmBAC,IAnBA,sBAoBG,IAAIT,MAAM,iCApBb,OAuBL,EAAKU,qBAELZ,OAAOC,KAAKY,MACTC,kBACAC,WAAWC,OAAO,EAAKJ,mBAAmBK,KAAK,IA3B7C,yDA6BL/B,QAAQgC,IAAR,MACA,cAAI,GAAJ,GAAc1C,EAAaI,OAC3B,EAAKuC,sBA/BA,8E,6DA1BMC,GACflC,QAAQC,OAA0B,mBAAZiC,GACtBlC,QAAQC,OAA2B,IAApBiC,EAAShC,QACxBF,QAAQC,QAAQ,YAAAkC,KAAA,MAAqBC,IAAIF,IAEzC,YAAAC,KAAA,MAAqBE,IAAIH,K,0CAGPA,GAClBlC,QAAQC,OAA0B,mBAAZiC,GACtBlC,QAAQC,OAA2B,IAApBiC,EAAShC,QACxBF,QAAQC,OAAO,YAAAkC,KAAA,MAAqBC,IAAIF,IACxC,YAAAC,KAAA,MAAqBG,OAAOJ,K,gLAIf,IAAIjB,SAAQ,SAACC,GAKxB,EAAKqB,kBAJU,SAAXL,EAAYM,GACd,EAAKC,oBAAoBP,GACzBhB,EAAQsB,S,qKAtBZ,OAAO,YAAAL,KAAP,U,8CAmEAnC,QAAQC,OAAOwB,KACTX,OAAO4B,MACX5B,OAAOC,KAAKY,MAAMC,kBAAkBe,SAEpC7B,OAAOC,KAAKY,MAAMC,kBAAkBe,OAAO,CACzCC,OAAQ,qB,gCAMZ5C,QAAQC,OAAOwB,KACKX,OAAOC,KAAKY,MAAMC,kBACxBiB,Y,4CAGO,IAAD,4BACCV,KADD,WACpB,2BAA2C,EACzCD,EADyC,SAChC,YAAAC,KAAD,QAFU,iC,2CAOpBnC,QAAQC,OAAO,YAAAkC,KAAA,QAAgB7C,EAAaI,QAC5C,IAAIoD,GA8BN9C,QAAQC,OAAOwB,KACRX,OAAOC,KAAKY,MAAMC,kBAAkBC,WAAWkB,MA9BhDzD,EAAaE,UACbF,EAAaG,YACb,YAAA0C,KAAA,QAAgBW,IAClB,YAAAX,KAAA,MAAcW,EACdX,KAAKF,2B,MAoBX,SAASR,IACP,OAAOX,OAAOC,MAAQD,OAAOC,KAAKY,OAASb,OAAOC,KAAKK,OAfzDzB,OAAOqD,KAAKnD,I,8XClHG,gBAAGoD,OAAH,OACb,yBACEC,MAAO,CACLC,QAAS,OACTC,QAAS,KAGX,yBAAKC,MAAM,KAAKC,OAAO,KAAKC,MAAM,8BAChC,uBAAGC,KAAK,OAAOC,SAAS,WACtB,0BACEC,EAAE,gIACFF,KAAK,YAEP,0BACEE,EAAE,kHACFF,KAAK,YAEP,0BACEE,EAAE,4HACFF,KAAK,YAEP,0BACEE,EAAE,8HACFF,KAAK,YAEP,0BAAMA,KAAK,OAAOE,EAAE,sB,2BCrBtBC,EAAgB,SAAC,GAAD,IAAGC,EAAH,EAAGA,SAAH,OACpB,0BACEV,MAAO,CACLE,QAAS,GACTS,YAAa,EACbC,WAAY,MAGbF,IAIDG,EAAc,CAChBC,gBAAiB,OACjBb,QAAS,cACTc,WAAY,SACZC,MAAO,qBACPC,UAAW,+DACXf,QAAS,EACTgB,aAAc,EACdC,OAAQ,wBACRC,SAAU,GACVR,WAAY,MACZS,WAAY,qBACZC,OAAQ,WAGNC,EAAgB,CAClBC,QAAS,I,wHAGEC,EAAb,4MACEnC,MAAQ,CACNoC,UAAW,EAAKC,MAAMhF,iBAAiB2C,MACvCsC,cAAe,EAAKD,MAAMhF,iBAAiBN,QAC3CwF,aAAc,MAJlB,0DAiBkB,SAACH,GACf,EAAKI,UAAS,SAACC,GACb,OAAO,2BAAKA,GAAZ,IAAuBH,cAAeG,EAAUL,UAAWA,oBAnBjE,0DAuBqB,SAACG,GAClB,EAAKC,UAAS,SAACC,GACb,OAAO,2BAAKA,GAAZ,IAAuBF,uBAzB7B,0DA6BoB,WAChB,OACE,EAAKvC,MAAMoC,YAActF,IAAaI,QACtC,EAAK8C,MAAMoC,YAActF,IAAaC,QAE/BI,OAAOuF,OAAO,GAAInB,EAAaU,GAGjCV,KArCX,iGAwCa,sBAAAlD,EAAA,sDACL,EAAK2B,MAAMoC,YAActF,IAAaE,UACxC,EAAKqF,MAAMhF,iBAAiBgD,UACnB,EAAKL,MAAMoC,YAActF,IAAaG,YAC/C,EAAKoF,MAAMhF,iBAAiB8C,SAJrB,2CAxCb,yHAQQR,KAAKK,MAAMoC,YAAczC,KAAK0C,MAAMhF,iBAAiB2C,OACvD,YAAAL,KAAA,MAAmBA,KAAK0C,MAAMhF,iBAAiB2C,OAEjDL,KAAK0C,MAAMhF,iBAAiB0C,iBAA5B,YAA6CJ,KAA7C,SAXJ,6CAcIA,KAAK0C,MAAMhF,iBAAiB4C,oBAA5B,YAAgDN,KAAhD,SAdJ,+BAgDY,IAAD,OACHgD,EAAgB,WAClB,GAAI,EAAK3C,MAAMoC,YAActF,IAAaI,OACxC,OACE,kBAAC0F,EAAA,EAAD,CAAOC,SAAS,SAAhB,kFAOJ,GAAI,EAAK7C,MAAMoC,YAActF,IAAaG,WAAY,CACpD,GAAI,EAAK+C,MAAMsC,gBAAkBxF,IAAaE,UAC5C,OACE,kBAAC4F,EAAA,EAAD,CAAOC,SAAS,WACd,kBAACC,EAAA,EAAD,sBADF,+CAE8C,6BAF9C,gDAG+C,6BAC7C,4BACE,kDACqB,6BACnB,uBAAGC,KAAK,sCAAR,uCAIF,iFAID,GAAI,EAAK/C,MAAMsC,gBAAkBxF,IAAaC,QACnD,OACE,kBAAC6F,EAAA,EAAD,CAAOC,SAAS,QAAhB,0DACyD,6BADzD,sBAGE,+BAjCU,GAwCpB,OACE,4BACEG,IAAK,SAACA,GAAD,mBAAS,EAAT,MAA+BA,IACpCC,QAAO,YAAEtD,KAAF,MACPe,MAAK,YAAEf,KAAF,QACLuD,KAAK,UAEL,kBAAC,EAAD,CAAMC,IAAK,EAAG1C,OAAQd,KAAKK,MAAMS,SACjC,kBAAC,EAAD,CAAe0C,IAAK,GACjBxD,KAAKK,MAAMoC,YAActF,IAAaE,UACnC,WACA,cAGH2F,KAAkBhD,KAAKK,MAAMuC,cAC9B,kBAACa,EAAA,EAAD,CACED,IAAK,EACLzC,MAAO,CAAE2C,OAAQ,MACjBC,MAAM,EACNC,SAAU5D,KAAKK,MAAMuC,aACrBiB,UAAU,aACVC,eAAe,EACfC,UAAW,CACTC,KAAM,CACJC,SAAS,GAEXC,gBAAiB,CACfD,SAAS,GAEXE,KAAM,CACJF,SAAS,GAEXG,OAAQ,CACNA,OAAQ,SAIXpB,QA9Hb,GAAwCqB,IAAMC,eClC1CC,EAAYC,aAAW,SAACC,GAAD,MAAY,CACrCC,KAAM,CACJC,SAAU,WACVC,IAAK,KACLC,KAAM,KACN3D,MAAO,MACPC,OAAQ,MACRU,gBAAiB4C,EAAMK,QAAQC,WAAWC,MAC1CtB,OAAQ,OAICuB,EAAaZ,IAAMa,YAAW,SAACxC,EAAOW,GACjD,IAAI8B,EAASZ,IAEb,OACE,2CAASa,UAAWD,EAAOT,MAAUhC,EAArC,CAA4CW,IAAKA,IAC/C,8C,SCCAgC,GAAiBhB,IAAMiB,MAAK,kBAAM,uDAElCf,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCc,iBAAkB,CAChBvE,QAAS,OACTwE,eAAgB,WAChB1D,WAAY,UAGd2D,eAAgB,CACdzE,QAAS,OACT0E,cAAe,SACf5D,WAAY,SACZ0D,eAAgB,UAGlBG,MAAM,aACJhB,SAAU,WACVC,IAAK,KACLC,KAAM,KACN3D,MAAO,MACPC,OAAQ,MACRU,gBAAiB4C,EAAMK,QAAQC,WAAWa,QAC1ClC,OAAQ,IACRzB,aAAc,EACd4D,SAAU,OACV5E,QAAS,IACRwD,EAAMqB,YAAYC,GAAG,MAAQ,CAC5B9E,QAAS,SAKf,SAAS+E,GAAkBtD,GAAQ,IAAD,EACR2B,IAAM4B,UAAS,GADP,mBACzBtC,EADyB,KACnBuC,EADmB,KAE1Bf,EAASZ,KAKfF,IAAM8B,WAAU,WACVzD,EAAM0D,OAAO1D,EAAM0D,MAAMC,cAAc1C,KAC1C,CAACA,EAAMjB,EAAM0D,QAEhB,IAAME,EAAgB,WACD,MAAf5D,EAAM0D,OACR1D,EAAM0D,MAAMC,eAAc,GAG5BH,GAAQ,IAGV,OACE,kBAAC,IAAMK,SAAP,KACE,kBAACC,EAAA,EAAD,iBAAgB9D,EAAhB,CAAuBY,QAlBL,WACpB4C,GAAQ,MAkBHxD,EAAMjB,SAAS,IAElB,kBAACgF,EAAA,EAAD,CAAO9C,KAAMA,EAAM+C,QAASJ,GAC1B,yBAAKlB,UAAWD,EAAOQ,OACpBtB,IAAMsC,aAAajE,EAAMjB,SAAS,GAAI,CAAEiF,QAASJ,OAOrD,SAASM,GAAQlE,GACtB,IAAMmE,EAAUtC,KAChB,OACE,kBAAC,IAAMgC,SAAP,KACE,kBAACO,EAAA,EAAD,CAAUC,QAAQ,EAAOC,GAAItE,EAAMuE,OACjC,kBAACC,EAAA,EAAD,OAEF,kBAACC,EAAA,EAAD,CAAOJ,QAAQ,EAAOK,UAAU,OAAOJ,GAAItE,EAAMuE,OAC/C,kBAACI,EAAA,EAAD,KACE,kBAACH,EAAA,EAAD,KACE,kBAACI,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAQ,iBACtB,kBAACC,EAAA,EAAD,CAAQC,QAAM,GACZ,kBAACJ,EAAA,EAAD,CAAMK,MAAI,EAACC,GAAI,KAEjB,kBAACN,EAAA,EAAD,CAAMK,MAAI,EAACC,GAAI,EAAGxC,UAAWyB,EAAQpB,gBACnC,kBAACgC,EAAA,EAAD,CAAQC,QAAM,GACZ,kBAACG,EAAA,EAAD,CAAYC,QAAQ,KAAKC,MAAM,UAA/B,oBAGA,kBAACF,EAAA,EAAD,CAAYC,QAAQ,UAAUC,MAAM,UAApC,+BAIF,kBAACN,EAAA,EAAD,CAAQO,MAAI,GACV,kBAACH,EAAA,EAAD,CAAYC,QAAQ,KAAKC,MAAM,UAA/B,sBAKJ,kBAACT,EAAA,EAAD,CAAMK,MAAI,EAACvC,UAAWyB,EAAQtB,iBAAkBqC,GAAI,EAAGK,GAAI,GACzD,kBAACjC,GAAD,KACE,kBAACkC,EAAA,EAAD,MACA,kBAACjD,EAAD,OAGF,kBAACe,GAAD,CAAmBI,MAAO1D,EAAM0D,MAAO+B,KAAK,SAC1C,kBAACC,EAAA,EAAD,MAEA,kBAAC,gBAAD,KACE,kBAAC,WAAD,CACEC,SACE,kBAACC,GAAA,EAAD,oBAGF,kBAACjD,GAAD,CAAgBe,MAAO1D,EAAM0D,WAKnC,kBAAC,EAAD,CACE1I,iBAAkBA,Y,sGCnI9B6G,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvC8D,MAAO,CACL5D,SAAU,YAEZ6D,MAAO,CACL7D,SAAU,WACV3D,QAAS,OACT0E,cAAe,SACfF,eAAgB,SAChBiD,SAAU,IACV/E,OAAQ,EACRzC,QAAS,GACT8D,WAAYN,EAAMK,QAAQC,WAAWC,MACrC9C,OAAQ,iBACRD,aAAc,OAILyG,GAAQrE,IAAMa,YAAW,SAACxC,EAAOW,GAC5C,IAAMwD,EAAUtC,KAChB,OACE7B,EAAMsE,IACJ,yBAAK5B,UAAWyB,EAAQ0B,OACtB,kBAACI,GAAA,EAAD,CAAM3B,GAAItE,EAAMsE,IACd,yBAAK3D,IAAKA,EAAK+B,UAAWyB,EAAQ2B,OAC/B9F,EAAMjB,eC3Bb8C,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvC8C,UAAW,CACTqB,UAAW,aACXC,OAAQ,EACRxG,OAAQ,UACRyG,YAAa,SAACC,GAAD,OAAcA,EAAU,OAAS,SAC9C7G,OAAQ,YACRD,aAAc,EACd0C,SAAU,WACV9C,gBAAiB4C,EAAMK,QAAQC,WAAWC,OAE5CgE,UAAW,CACT9G,OAAQ,YACR4G,YAAa,SAACG,GAAD,OAAeA,EAAW,WAAa,SACpDhH,aAAc,EACdE,SAAU,GACVnB,QAAS,OACTc,WAAY,SACZ0D,eAAgB,UAGlB0D,KAAM,CACJ7G,OAAQ,UACRnB,MAAO,GACP2H,OAAQ,EACR5H,QAAS,UACTE,OAAQ,OACRe,OAAQ,kBAER4G,YAAa,SAACK,GAAD,OAAiBA,EAAa,OAAS,UAGtDC,MAAO,CACLC,WAAY,OACZ1H,WAAY,SAAC2H,GAAD,OAAsB,IAAVA,EAAc,OAAS,SAC/C/G,QAAS,SAAC+G,GAAD,OAAsB,IAAVA,EAAc,EAAc,IAAVA,EAAc,GAAM,SAI/D,SAASC,GAAT,GAA+C,IAA1BH,EAAyB,EAAzBA,MAAOI,EAAkB,EAAlBA,KAAS9G,EAAS,iCACtCmE,EAAUtC,GAAU7B,EAAM4G,OAChC,OACE,wCAAMlE,UAAWyB,EAAQuC,MAAOK,KAAK,MAAMC,aAAYF,GAAU9G,GAC9DiH,OAAOC,cAAcR,IAK5B,SAASS,GAAT,GAAwD,IAAnCC,EAAkC,EAAlCA,cAAeR,EAAmB,EAAnBA,MAAU5G,EAAS,0CAC/CmE,EAAUtC,GAAUuF,IAAkBR,GAExCnI,EAAS,GAAK,EAAImI,GAAS,EAC/B,OACE,kBAACS,GAAA,EAAD,eAAS3E,UAAWyB,EAAQqC,KAAMc,QAAQ,YAAetH,GACvD,0BACEuH,EAAG9I,EACHD,MAAM,IACNC,OAAQ,GAAKA,EACbE,KAAMiI,GAASQ,EAAgB,MAAQ,eAM/C,SAASI,GAAT,GAAwD,IAA9BZ,EAA6B,EAA7BA,MAAOL,EAAsB,EAAtBA,SAAavG,EAAS,qCAC/CmE,EAAUtC,GAAU0E,GAC1B,OACE,yBAAK7D,UAAWyB,EAAQmC,WACtB,kBAACO,GAAD,iBACM7G,EADN,CAEE4G,MAAO,EACPhG,QAAS,kBAAMZ,EAAMyH,UAAUb,EAAQ,GAAK,OAE9C,kBAACO,GAAD,CACEvG,QAAS,kBAAMZ,EAAMyH,SAAS,IAC9BL,cAAeR,EACfA,MAAO,IAET,kBAACO,GAAD,CACEvG,QAAS,kBAAMZ,EAAMyH,SAAS,IAC9BL,cAAeR,EACfA,MAAO,IAET,kBAACO,GAAD,CACEvG,QAAS,kBAAMZ,EAAMyH,SAAS,IAC9BL,cAAeR,EACfA,MAAO,IAET,kBAACO,GAAD,CACEvG,QAAS,kBAAMZ,EAAMyH,SAAS,IAC9BL,cAAeR,EACfA,MAAO,KAMR,SAASc,GAAY1H,GAAQ,IAAD,EACL2B,IAAM4B,UAAS,GADV,mBAC1B8C,EAD0B,KACjBsB,EADiB,OAEGhG,IAAM4B,UAAU,GAFnB,mBAE5BqE,EAF4B,KAEfC,EAFe,KAI3BC,EAAWnG,IAAMoG,SACjB5D,EAAUtC,GAAUwE,GAwD1B,GAAgC,IAA5BrG,EAAMgI,WAAW3M,OAAc,OAAO,KAE1C,IAAI4M,EAAmBjI,EAAMgI,WAAWE,QAAO,SAACC,GAAD,OAAOA,EAAEvB,MAAQ,KAE5DwB,EAAa,EAEjB,OACE,kBAAC,IAAMvE,SAAP,KACE,yBACEwE,SAAU,EACVC,QAhEQ,SAACC,GACbvI,EAAMsI,QAAQC,GACdZ,GAAS,IA+DLa,OA5DO,SAACD,GACPT,EAASW,QAAQC,SAASnN,SAASoN,iBACtChB,GAAS,GACT3H,EAAMwI,OAAOD,KA0DX7F,UAAWyB,EAAQU,UACnB+D,UAvDU,SAACL,GACf,GAAkB,cAAdA,EAAMzH,KAER,GADI8G,EAAc,GAAGC,EAAgBD,EAAc,GAC/CA,EAAc5H,EAAMgI,WAAW3M,OAAQ,CACzC,IAAIwN,EAAK,aAAO7I,EAAMgI,YACtBa,EAAMjB,GAAahB,QACfiC,EAAMjB,GAAahB,MAAQ,IAC7BiC,EAAMjB,GAAahB,MAAQ,GAE7B5G,EAAM8I,mBAAmBD,SAEtB,GAAkB,eAAdN,EAAMzH,KAEf,GADI8G,EAAc,GAAGC,EAAgBD,EAAc,GAC/CA,EAAc5H,EAAMgI,WAAW3M,OAAQ,CACzC,IAAIwN,EAAK,aAAO7I,EAAMgI,YACtBa,EAAMjB,GAAahB,QACfiC,EAAMjB,GAAahB,MAAQ,IAC7BiC,EAAMjB,GAAahB,MAAQ,GAE7B5G,EAAM8I,mBAAmBD,SAEtB,GAAkB,cAAdN,EAAMzH,MACf8G,GACmB5H,EAAMgI,WAAW3M,SAClCuM,EAAc,GAEhBC,EAAeD,QACV,GAAkB,YAAdW,EAAMzH,MACf8G,EACkB,IAChBA,EAAc5H,EAAMgI,WAAW3M,OAAS,GAE1CwM,EAAeD,OACV,IAAkB,WAAdW,EAAMzH,KAAkC,UAAdyH,EAAMzH,IAGzC,OAFAd,EAAM+I,SAASN,QAAQO,QAKzBT,EAAMU,mBAkBDhB,EAAiB5M,OAAS,EACzB4M,EAAiBiB,KAAI,SAACf,GAAD,OACnB,kBAACtB,GAAD,CACE/F,IAAKqH,EAAEgB,UACPzC,MAAOyB,EAAEgB,UACTrC,KAAMqB,EAAErB,KACRF,MAAOuB,EAAEvB,WAIb,kBAACzB,EAAA,EAAD,CAAYC,QAAQ,UAAU/F,MAAM,iBAApC,YAIF,kBAAC2G,GAAD,CAAO1B,GAAI+B,EAAS1F,IAAKmH,GACvB,kBAAC3C,EAAA,EAAD,CAAYE,MAAM,SAASD,QAAQ,SAChCpF,EAAM8G,MAER9G,EAAMgI,WAAWkB,KAAI,SAACf,GAAD,OACpB,kBAACX,GAAD,CACE1G,IAAKqH,EAAEgB,UACP5C,SAAU6B,MAAiBR,EAC3BlB,MAAOyB,EAAEgB,UACTrC,KAAMqB,EAAErB,KACRF,MAAOuB,EAAEvB,MACTa,SAAU,SAACb,GACT5G,EAAM8I,mBACJ9I,EAAMgI,WAAWkB,KAAI,SAAC3B,GAAD,OACnBA,EAAE4B,YAAchB,EAAEgB,UAAlB,2BAAmC5B,GAAnC,IAAsCX,UAAUW,YAO1D,kBAACpC,EAAA,EAAD,CAAYE,MAAM,SAASD,QAAQ,WAAnC,oBAGO,MCxMV,IAAMgE,GAEF,UAFEA,GAKH,SALGA,GAOF,UAGLC,GACO,WADPA,GAEQ,YAFRA,GAGE,OAIKC,GAAb,WAgJE,WAAYxI,EAAKyI,EAAMC,GAAc,oBACnClM,KAAKmM,MAAQF,EACbjM,KAAKoM,KAAO5I,EACZxD,KAAKqM,qBAAsB,EAC3BrM,KAAKsM,UAAW,EAChBtM,KAAKuM,WAAaR,GAClB/L,KAAKwM,oBAAoBN,GAtJ7B,2DAEI,OACElM,KAAKmM,QAAUL,IAAuB9L,KAAKmM,QAAUL,KAH3D,qCAoBiBI,GACb,IAAMO,EAAazM,KAAKuL,QAExB,OADAkB,EAAWD,oBAAoBN,GACxBO,IAvBX,8BA8BU5H,GACN,IAAK7E,KAAK0M,eAER,OADA7O,QAAQ8O,MAAM,cACP3M,KAGT,IAAMyM,EAAazM,KAAKuL,QAGxB,OAFAkB,EAAWN,MAAX,2BAAwBnM,KAAKmM,OAA7B,IAAoCtH,SACpC4H,EAAWF,WAAaR,GACjBU,IAvCX,+BA8CWG,GACP,IAAK5M,KAAK0M,eAER,OADA7O,QAAQ8O,MAAM,cACP3M,KAGT,IAAMyM,EAAazM,KAAKuL,QAGxB,OAFAkB,EAAWN,MAAX,2BAAwBnM,KAAKmM,OAA7B,IAAoCS,UACpCH,EAAWF,WAAaR,GACjBU,IAvDX,mCA8De5H,GACX,IAAIgI,EAAS7M,KAAK8M,eAChBd,EAAWe,qBACTlI,EACA7E,KAAKgN,aAAa,GAClBhN,KAAKiN,gBAIT,OADAJ,EAAON,WAAaR,GACbc,IAvEX,oCA0EgBD,GACZ,IAAIC,EAAS7M,KAAK8M,eAChBd,EAAWe,qBACT/M,KAAKgN,aAAa,GAClBJ,EACA5M,KAAKiN,gBAIT,OADAJ,EAAON,WAAaR,GACbc,IAnFX,sCAyFkBK,GACd,OAAOlN,KAAK8M,eACVd,EAAWe,qBACT/M,KAAKgN,aAAa,GAClBhN,KAAKgN,aAAa,GAClBE,MA9FR,4CAsGwBC,GACpB,IAAMV,EAAazM,KAAKuL,QAExB,OADAkB,EAAWJ,oBAAsBc,EAC1BV,IAzGX,iCA+Ga1D,GACT,IAAM0D,EAAazM,KAAKuL,QAExB,OADAkB,EAAWH,SAAWvD,EACf0D,IAlHX,+BAsHI,OAAO,IAAIT,EAAWhM,KAAKoM,KAAMN,GAAqBA,MAtH1D,8BA0HI,OAAO,IAAIE,EAAWhM,KAAKoM,KAAM,CAAEvH,KAAM,GAAI+H,MAAO,IAAM,MA1H9D,6BA8HI,GAAI5M,KAAKmM,QAAUL,GACjB,MAAM,IAAIjN,MAAM,uDAClB,OAAO,IAAImN,EAAWhM,KAAKoM,KAAMN,GAAqB9L,KAAKoN,gBAhI/D,8BAqII,IAAMX,EAAa,IAAIT,EAAWhM,KAAKoM,KAAMpM,KAAKiM,MAQlD,OAPAQ,EAAWO,aAAehN,KAAKgN,aAC/BP,EAAWQ,cAAgBjN,KAAKiN,cAChCR,EAAWW,aAAepN,KAAKoN,aAC/BX,EAAWJ,oBAAsBrM,KAAKqM,oBACtCI,EAAWH,SAAWtM,KAAKsM,SAC3BG,EAAWF,WAAavM,KAAKuM,WAEtBE,IA7IX,2BAQI,OAAIzM,KAAKmM,iBAAiB3O,OAAe,eAAKwC,KAAKmM,OAC5CnM,KAAKmM,QAThB,0BAaI,OAAOnM,KAAKoM,OAbhB,kCAiBI,OAAKpM,KAAK0M,eACH1M,KAAKoN,aADqB,KAjBrC,2BA2BI,OAAKpN,KAAK0M,eACH1M,KAAKmM,MAAMtH,KADe,KA3BrC,4BA2CI,OAAK7E,KAAK0M,eACH1M,KAAKmM,MAAMS,MADe,KA3CrC,kCA2DI,OAAO5M,KAAKgN,eA3DhB,mCAuFI,OAAOhN,KAAKiN,gBAvFhB,yCAoGI,OAAOjN,KAAKqM,sBApGhB,8BA6GI,OAAOrM,KAAKsM,aA7GhB,yDAoKsBJ,GAIlB,GAHAlM,KAAKgN,aAAe,CAAC,GAAI,IACzBhN,KAAKiN,cAAgB,KACrBjN,KAAKoN,aAAelB,EAEK,kBAAhBA,GACPA,EAAYnO,OAAS,GACrBmO,IAAgBJ,GAChB,CAAC,IAAD,EACkDI,EAAYmB,MAAM,KADpE,mBACOC,EADP,KACwBC,EADxB,KAGAvN,KAAKgN,aAAeM,EACjBD,MAAM,KACNzB,KAAI,SAACf,GAAD,OAAO2C,MAAMC,KAAK5C,GAAGe,KAAI,SAAC3B,GAAD,OAAOyD,OAAOzD,SACb,IAA7BjK,KAAKgN,aAAajP,QAAciC,KAAKgN,aAAaW,KAAK,IAE3D3N,KAAKiN,cAAgB,IAAIW,KAAKF,OAAOH,IACjCM,MAAM7N,KAAKiN,cAAca,aAC3B9N,KAAKiN,cAAgB,UAtL7B,4CA2L8BpI,EAAM+H,EAAOM,GACvC,IAAIa,EASJ,OAPEA,EADElJ,EAAKmJ,OAAM,SAACnD,GAAD,OAAa,IAANA,MAAY+B,EAAMoB,OAAM,SAACnD,GAAD,OAAa,IAANA,KACpC,GAEAhG,EAAKoJ,KAAK,IAAM,IAAMrB,EAAMqB,KAAK,IAG9B,MAAhBf,IACFa,EAAeA,EAAe,IAAMb,EAAaY,WAC5CC,MArMX,KAyMMG,GAAa,SAACzJ,GAAD,MAAY,CAC7BvC,OAAQ,QACRD,aAAc,EACdJ,gBAAiB4C,EAAMK,QAAQC,WAAWC,MAC1C/D,QAAS,qBAAG8H,QAAyB,EAAI,GACzCoF,YAAa,YACX,OAAmB,IADS,EAAdpF,QACY,EAAI,GAEhCD,YAAa,YACX,OAAmB,IADS,EAAdC,QACYtE,EAAMK,QAAQsJ,QAAQC,MAAQ,UAItD9J,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvC6J,MAAM,aACJtN,QAAS,OACTuN,KAAM,EAEN7I,cAAe,SACff,SAAU,YACTF,EAAMqB,YAAYC,GAAG,MAAQmI,GAAWzJ,IAE3C+J,MAAO,CACLvN,QAAS,EACTwN,UAAW,qBAAGC,gBAAyC,EAAI,IAC3DC,UAAW,qBAAGC,SAA2B,GAAK,KAC9C9M,WAAY,cAEdyG,MAAM,aACJvH,QAAS,OACTc,WAAY,aACZ4D,cAAe,OACdjB,EAAMqB,YAAY+I,KAAK,MAAQX,GAAWzJ,IAE7CqK,KAAM,CACJ5M,OAAQ,kBAEV6M,KAAM,CACJlN,gBAAiB4C,EAAMK,QAAQC,WAAWC,MAC1CgK,WAAY,gBAIhB,SAASC,GAAT,GAYI,IAXOC,EAWR,EAXDlE,QACAmE,EAUC,EAVDA,UACAzE,EASC,EATDA,WACA0E,EAQC,EARDA,SACAlC,EAOC,EAPDA,aACA1B,EAMC,EANDA,mBACA6D,EAKC,EALDA,iBACAlC,EAIC,EAJDA,UACAmC,EAGC,EAHDA,aACAC,EAEC,EAFDA,WACG7M,EACF,iKAC6B2B,IAAM4B,UAAS,GAD5C,mBACM8C,EADN,KACeyG,EADf,OAEuCnL,IAAM4B,UAAS,GAFtD,mBAEMwJ,EAFN,KAEoBC,EAFpB,KAIDrL,IAAM8B,WAAU,WACV4C,GACFmG,EAAa,MAAM,KAEpB,CAACnG,EAASmG,IAEb,IAAMrI,EAAUtC,GAAU,CACxBmK,kBAAmBxB,EACnB0B,SAAUlE,EAAW3M,OAAS,EAC9BgL,QAASA,GAAW0G,IAEhBhE,EAAWpH,IAAMoG,SAyBvB,OANApG,IAAM8B,WAAU,YACTgH,GAAazK,EAAMiN,WACtBlE,EAASN,QAAQO,UAElB,CAACyB,EAAWzK,EAAMiN,YAGnB,kBAAC7I,EAAA,EAAD,CACEE,IAAKmG,EACLyC,SAAUP,EACVQ,UAAW,WACLnN,EAAMiN,WACRlE,EAASN,QAAQO,UAIrB,yBAAKtG,UAAWyB,EAAQ0B,OACtB,yBACEnD,UAAWyB,EAAQyH,MACnBhL,QAAS,WACyC,IAA5C3E,OAAOmR,eAAeC,WAAWhS,QACnC0N,EAASN,QAAQO,UAGpBwB,GACC,kBAACrF,EAAA,EAAD,CAAYC,QAAQ,UAAU/F,MAAM,gBAAgBgG,MAAM,UACvDiI,KAAO9C,GAAc+C,OAAO,WAIjC,kBAACC,GAAA,EAAD,eACE9K,UAAWyB,EAAQ2H,MACnB2B,WAAS,EACTC,WAAS,EACTC,YAAe3N,EAAMqM,KAAOrM,EAAMqM,KAAKvF,KAAO,GAC9C1B,QAAQ,WACR2D,SAAUA,EACVT,QAtDM,SAACC,GACfuE,GAAW,GACXN,EAAajE,IAqDLC,OAlDK,SAACD,GACduE,GAAW,KAkDC9M,IAEN,kBAAC0H,GAAD,CACEZ,KAAM2F,EACN3D,mBAAoBA,EACpBd,WAAYA,EACZe,SAAUA,EACVT,QAtDa,SAACC,GACtBiE,EAAajE,GACbyE,GAAgB,IAqDRxE,OAnDU,SAACD,GACnByE,GAAgB,MAoDK,MAAdhN,EAAMqM,MACLrM,EAAMqM,KAAKuB,WACX5N,EAAM4G,MAAMvL,OAAS,GACnB,kBAAC2K,GAAD,CAAO1B,GAAI+B,GACT,kBAAClB,EAAA,EAAD,CACEzC,UAAWyB,EAAQkI,KACnBhN,MAAM,gBACNd,QAAS,IAERyB,EAAMqM,KAAKvF,QAKtB,kBAAC/B,EAAA,EAAD,CAAQC,QAAS4H,EAActH,MAAOuH,GACpC,kBAAC/I,EAAA,EAAD,CAAYkD,aAAW,SAAS6G,KAAK,QAAQjN,QAAS8L,GACpD,kBAAC,KAAD,CAAYrN,MAAM,SAASI,SAAS,cAQzC,IAAMqO,GAAQnM,IAAMa,YACzB,WASE7B,GACI,IARO6L,EAQR,EARDlE,QACAyF,EAOC,EAPDA,SAEAC,GAKC,EANDC,eAMC,EALDD,OACAE,EAIC,EAJDA,SACGC,EAGF,2EACGhK,EAAUtC,KAEVuM,IAAuBJ,EAAMlH,MAAQkH,EAAMI,mBAH9C,EAI+BzM,IAAM4B,SAAS6K,GAJ9C,mBAII3D,EAJJ,KAIe4D,EAJf,KAWH,GANA1M,IAAM8B,WAAU,WACV2K,GACFC,GAAa,KAEd,CAACD,IAEEJ,EAAMlH,KACV,OACE,wBAAInG,IAAKA,EAAK+B,UAAWyB,EAAQiI,MAC/B,wBAAIkC,QAAS,GACX,kBAAClK,EAAA,EAAD,CAAUE,IAAKmG,GACb,kBAACtF,EAAA,EAAD,CAAYC,QAAQ,QAAQC,MAAM,SAAShG,MAAM,iBAC9C2O,EAAMlH,SAQnB3L,QAAQC,OAAO4S,aAAiB1E,IAEhC3H,IAAM8B,WAAU,WACVuK,EAAMI,oBACRL,EAASC,EAAMO,uBAAsB,IAAQ,KAE9C,CAACP,EAAOD,IAEXpM,IAAM8B,WAAU,WACVuK,EAAMzE,OAASH,IAAoB2E,EAASC,EAAMQ,QAAQ,MAGhE,IAAIC,EAAY,GACZC,EAAa,GAEjB,GAAgB,MAAZR,EACF,IAAK,IAAIS,EAAI,EAAGA,EAAIT,EAASU,UAAUvT,OAAQsT,IAC7CF,EAAUxD,KAAV,aACErE,MAAkC,MAA3BoH,EAAMa,YAAY,GAAGF,GAAa,EAAIX,EAAMa,YAAY,GAAGF,IAC/DT,EAASU,UAAUD,KAExBD,EAAWzD,KAAX,aACErE,MAAkC,MAA3BoH,EAAMa,YAAY,GAAGF,GAAa,EAAIX,EAAMa,YAAY,GAAGF,IAC/DT,EAASU,UAAUD,KAK5B,IAAMG,EAAiB,SAACC,GACtBhB,EAASgB,IAGLzG,EAAU,SAACC,EAAOyG,GAClBhB,EAAM3H,SAAS0H,EAASC,EAAMlB,YAAW,IAAQ,GAChDkC,GAAgBxC,EAAajE,IAGpC,OACE,wBAAI5H,IAAKA,GACP,wBAAIG,IAAI,gBACLkN,EAAMhE,eACL,kBAACuC,GAAD,eACEU,UACEe,EAAM3H,SAAW2H,EAAMnE,aAAeR,GAExChK,MAAM,YACNmL,aAAcwD,EAAMxD,aACpB5D,MAAOoH,EAAM7L,KACbsF,SAAU,SAACc,GAAD,OACRuG,EAAed,EAAMiB,QAAQ1G,EAAM2G,OAAOtI,SAE5C0B,QAASA,EACToE,SAAU,WACR2B,GAAa,IAEfzB,cAAY,EACZnC,UAAWA,EACX4B,KAAkB,MAAZ6B,EAAmB,KAAOA,EAASiB,SACzC1C,UAAU,uBACVzE,WAAYyG,EACZ3F,mBAAoB,SAACsG,GAAD,OAClBN,EACEd,EAAMqB,aAAaD,EAAkBlG,KAAI,SAACf,GAAD,OAAOA,EAAEvB,aAGlDuH,IAGN,kBAACmB,GAAA,EAAD,CAAUlK,QAAQ,OAAO3G,OAAQ,OAIrC,wBAAIqC,IAAI,qBACLkN,EAAMhE,eACL,kBAACuC,GAAD,eACEU,UACEe,EAAM3H,SAAW2H,EAAMnE,aAAeR,GAExChK,MAAM,UACN+F,QAAQ,WACRwB,MAAOoH,EAAM9D,MACbzC,SAAU,SAACc,GAAD,OACRuG,EAAed,EAAMuB,SAAShH,EAAM2G,OAAOtI,SAE7C0B,QAASA,EACTuE,YAAU,EACVH,SAAU,WACR2B,GAAa,IAEf5D,UAAWA,EACXkC,iBAAkB,SAACpE,GAAD,OAAWwF,EAASC,EAAMvQ,WAC5C4O,KAAkB,MAAZ6B,EAAmB,KAAOA,EAASsB,UACzC/C,UAAU,4CACVzE,WAAY0G,EACZ5F,mBAAoB,SAAC2G,GAAD,OAClBX,EACEd,EAAM0B,cAAcD,EAAmBvG,KAAI,SAACf,GAAD,OAAOA,EAAEvB,aAGpDuH,IAGN,kBAACmB,GAAA,EAAD,CAAUlK,QAAQ,OAAO3G,OAAQ,W,uICnhBvCkR,G,4MACJhP,IAAMgB,IAAMiO,Y,2DAEO,WACX,EAAKjP,IAAI8H,SACb,EAAKzI,MAAM6P,gBACT,EAAK7P,MAAMgO,MACX,EAAKrN,IAAI8H,QAAQqH,iB,2DAKL,O,kEAGVxS,KAAKqD,IAAI8H,UACb,YAAAnL,KAAA,QAAuB,IAAIyS,eAAJ,YAAmBzS,KAAnB,SACvB,YAAAA,KAAA,QAAqB0S,QAAQ1S,KAAKqD,IAAI8H,Y,6CAMtCnL,KAAKqD,IAAI8H,QAAQC,SAASnN,SAASoN,gBACjCrL,KAAK0C,MAAMiQ,uBAAuBxH,SAEpCnL,KAAK0C,MAAMiQ,uBAAuBxH,QAAQO,QAGtC,YAAA1L,KAAD,UACH,YAAAA,KAAA,QAAqB4S,aACrB,YAAA5S,KAAA,QAAuB,Q,+BAIjB,IAAD,EAMHA,KAAK0C,MAHPmQ,GAHK,EAELF,uBAFK,EAGLE,eAEGhC,GALE,EAIL0B,gBAJK,8EAQP,OAAO,kBAACM,EAAD,eAAexP,IAAKrD,KAAKqD,KAASwN,Q,GA3CfxM,IAAMC,eA+C7B,SAASwO,GAAT,GAOH,IANFC,EAMC,EANDA,QAMC,IALDC,qBAKC,MALe,IAKf,EAJDL,EAIC,EAJDA,uBACAE,EAGC,EAHDA,cACAI,EAEC,EAFDA,qBACGC,EACF,8GAC6B7O,IAAM4B,SAAS,GAD5C,mBACMkN,EADN,KACeC,EADf,OAEuC/O,IAAM4B,SAAStH,OAAO0U,aAF7D,mBAEMC,EAFN,KAEoBC,EAFpB,OAI2ClP,IAAM4B,SAAS,IAAIuN,KAJ9D,mBAIMC,EAJN,KAIsBC,EAJtB,KAQKnB,EAAkBlO,IAAMsP,aAAY,SAACjD,EAAOvP,GAChDuS,GAAkB,SAACE,GACjB,IAAIC,EAAS,IAAIL,IAAII,GAGrB,OADAC,EAAOC,IAAIpD,EAAMlN,IAAKrC,GACf0S,OAER,IAEGE,EAAO,IAAIpW,IAAIoV,EAAQnH,KAAI,SAACf,GAAD,OAAOA,EAAErH,QACpCwQ,EAAe,GACrBP,EAAeQ,SAAQ,SAACC,EAAQ1Q,GACzBuQ,EAAK9T,IAAIuD,IACZwQ,EAAarG,KAAKnK,MAGlBwQ,EAAajW,OAAS,GACxB2V,GAAkB,SAACE,GACjB,IAAIC,EAAS,IAAIL,IAAII,GAIrB,OAHAI,EAAaC,SAAQ,SAACzQ,GAChBoQ,EAAO3T,IAAIuD,IAAMqQ,EAAO1T,OAAOqD,MAE9BqQ,KAIX,IAAMM,EAAmB,WACjBxB,EAAuBxH,SAC3BiI,EAAWT,EAAuBxH,QAAQiJ,WAC5Cb,EAAgB5U,OAAO0U,cAGzBhP,IAAM8B,WAAU,WAId,OAHMwM,EAAuBxH,UAC3BwH,EAAuBxH,QAAQkJ,SAAWF,GAC5CxV,OAAO2V,iBAAiB,SAAUH,GAC3B,WACLxV,OAAO4V,oBAAoB,SAAUJ,OAIzC,IAjDC,EAiDGK,EAAiB,GACjBC,EAAgB,EAChBC,EAAiB,EACjBC,EAAoB,EApDvB,eAsDiB5B,GAtDjB,IAsDD,2BAA2B,CAAC,IAAnBrC,EAAkB,QACrBkE,EAAc5B,EACdS,EAAexT,IAAIyQ,EAAMlN,OAC3BoR,EAAcnB,EAAe7S,IAAI8P,EAAMlN,MAGrCiR,EAAgBG,EAAczB,EAAUxU,OAAO0U,aAC7C3C,EAAM3H,SAAa4J,EAAuBxH,UAC5CwH,EAAuBxH,QAAQiJ,UAAYK,GAG7CC,GAAkBE,GACTH,EAAgBtB,EAAU,EAAIG,EACvCkB,EAAe7G,KACb,kBAAC,GAAD,eACEnK,IAAKkN,EAAMlN,IACX+O,gBAAiBA,EACjB7B,MAAOA,EACPmC,cAAeA,EACfF,uBAAwBA,GACpBO,MAIJxC,EAAM3H,SAAa4J,EAAuBxH,UAC5CwH,EAAuBxH,QAAQiJ,UAAYK,GAG7CE,GAAqBC,GAEvBH,GAAiBG,GApFlB,8BAqGD,OAfuB,IAAnBF,GACFF,EAAeK,QACb,kBAAC5B,EAAD,CAAsB9R,OAAQuT,EAAgBlR,IAAI,oBAI5B,IAAtBmR,GACFH,EAAe7G,KACb,kBAACsF,EAAD,CACE9R,OAAQwT,EACRnR,IAAI,uBAKHgR,E,cCpET,SAASM,GAAT,GAA2C,IAApB3T,EAAmB,EAAnBA,OAAW4T,EAAQ,2BACxC,OACE,uBAAQA,EACN,wBAAI/D,QAAQ,KACV,yBAAKjQ,MAAO,CAAEI,c,IAMhB6T,G,4MACJ3U,MAAQ,CACN0S,QAAS,I,EAGXkC,kBAAoB,SAAClC,EAASnC,EAAV,GAA8C,IAAxBsE,EAAuB,EAAvBA,QAASC,EAAc,EAAdA,QACjD,GAAIpC,EAAQhV,OAAS,EAAG,CAWtB,IAXuB,IACdqX,EAAT,SAAmBtG,GACjB9O,KAAKwD,IAAMxD,KAAKwJ,KAAOwG,KAAOlB,GAAMuG,SAAS,CAC3CC,QAAS,uBACTC,QAAS,4BACTC,SAAU,mBACVC,SAAU,sBAIVC,GADJ3C,EAAO,aAAOA,IACaA,EAAQhV,OAAS,GAAGmP,aACtCmE,EAAI0B,EAAQhV,OAAS,EAAGsT,GAAK,EAAGA,IAAK,CAC5C,IAAIsE,EAAsB5C,EAAQ1B,GAAGnE,aAEjB,MAAhBwI,EAMqB,MAAvBC,GACAA,EAAoB7H,UAAY4H,EAAa5H,WAKtB,MAAvB6H,GACAA,EAAoBC,YAAcF,EAAaE,WAC/CD,EAAoBE,aAAeH,EAAaG,YAChDF,EAAoBG,WAAaJ,EAAaI,WAKhD/C,EAAQgD,OAAO1E,EAAI,EAAG,EAAG,IAAI+D,EAAUM,IACvCA,EAAeC,GApBbD,EAAeC,EAuBC,MAAhBD,GACF3C,EAAQgD,OAAO,EAAG,EAAG,IAAIX,EAAUM,IAIvC,EAAK7S,SAAS,CAAEkQ,UAASnC,WAAUsE,UAASC,a,EAG9Ca,UAAY3R,IAAMiO,Y,EAClB2D,wBAA0B5R,IAAMiO,Y,EAChC4D,eAAiB,K,EACjBC,gBAAkB,K,kEAEG,IAAD,OAClBnW,KAAK0C,MAAM0D,MAAMgQ,UAAUpW,KAAKiV,mBAEhCjV,KAAKkW,eAAiB,IAAIG,KAAcrW,KAAKgW,UAAU7K,QAAS,CAC9DmL,UAAU,EACV7N,SAAU,IACV8N,cAAc,eAAD,OAAiBvW,KAAK0C,MAAMmE,QAAQ2P,KAApC,YACbC,SAAU,SAACC,GAST/X,OAAOgY,cAAc,IAAIC,MAAM,cAQnCjY,OAAO4V,oBAAoB,SAAUvU,KAAKkW,eAAeO,UACzDzW,KAAKmW,gBAAkB,IAAI1D,eACzBoE,KAAEC,UAAS,WACT,EAAKZ,eAAeO,aACnB,MAELzW,KAAKmW,gBAAgBzD,QAAQ1S,KAAKgW,UAAU7K,W,yCAG3B4L,GACb/W,KAAK0C,MAAM0D,QAAU2Q,EAAU3Q,QACjC2Q,EAAU3Q,MAAM4Q,YAAYhX,KAAKiV,mBACjCjV,KAAK0C,MAAM0D,MAAMgQ,UAAUpW,KAAKiV,sB,6CAKlCjV,KAAK0C,MAAM0D,MAAM4Q,YAAYhX,KAAKiV,mBAElCjV,KAAKkW,eAAee,UACpBjX,KAAKmW,gBAAgBe,UAAUlX,KAAKgW,UAAU7K,W,+BAGtC,IAAD,OACP,OACE,kBAAC,IAAM5E,SAAP,KACE,kBAACe,EAAA,EAAD,CACElC,UAAWpF,KAAK0C,MAAMmE,QAAQtB,iBAC9BgC,WAAS,EACTC,QAAQ,gBACR2P,QAAS,GAET,kBAAC7P,EAAA,EAAD,CAAMK,MAAI,EAACC,GAAI,EAAGK,GAAI,IAClBjI,KAAK0C,MAAM0U,aACX,kBAAC5Q,EAAA,EAAD,CAAY+J,KAAK,QAAQjN,QAAStD,KAAK0C,MAAM2U,cAC3C,kBAAC,KAAD,CAAWtV,MAAM,cAIvB,kBAACuF,EAAA,EAAD,CAAMlC,UAAWpF,KAAK0C,MAAMmE,QAAQyQ,QAAS3P,MAAI,EAACC,GAAI,EAAGK,GAAI,GAC3D,kBAACsP,GAAA,EAAD,CACEhH,KAAK,QACLjN,QAAS,WACP,EAAKZ,MAAM0D,MAAMoR,wBAHrB,iBASF,kBAAClQ,EAAA,EAAD,CAAMlC,UAAWpF,KAAK0C,MAAMmE,QAAQyQ,QAAS3P,MAAI,EAACC,GAAI,EAAGK,GAAI,GAC3D,kBAACsP,GAAA,EAAD,CACEpH,WAAS,EACTI,KAAK,QACLpO,SAAS,QACTmB,QAAStD,KAAK0C,MAAM0D,MAAMqR,KAC1BC,UAAW1X,KAAKK,MAAM8U,SALxB,QASA,kBAACoC,GAAA,EAAD,CACEpH,WAAS,EACTI,KAAK,QACLpO,SAAS,QACTuV,UAAW1X,KAAKK,MAAM6U,QACtB5R,QAAStD,KAAK0C,MAAM0D,MAAMuR,MAL5B,UAYJ,yBACEtU,IAAKrD,KAAKiW,wBACV7Q,UAAWpF,KAAK0C,MAAMmE,QAAQU,UAC9BwD,SAAU,GAEV,2BACE6M,YAAa,EACbC,YAAa,EACbzS,UAAWpF,KAAK0C,MAAMmE,QAAQiR,aAC9BzU,IAAKrD,KAAKgW,WAGV,+BACE,4BACE,6BACA,+BAIJ,+BACE,kBAAClD,GAAD,CACEC,QAAS/S,KAAKK,MAAM0S,QACpBF,cAAerC,GACfyC,qBAAsB6B,GACtBnC,uBAAwB3S,KAAKiW,wBAE7BxF,SAAUzQ,KAAK0C,MAAM0D,MAAMqK,SAC3BzF,QAAShL,KAAK0C,MAAMsI,QACpB4F,SAAU5Q,KAAKK,MAAMuQ,mB,GApLPvM,IAAMC,eA6LvByT,GAAeC,cApRb,SAACvT,GAAD,MAAY,CACzB8C,UAAW,CACT1B,SAAU,OACV0I,KAAM,EACN0J,WAAY,aAEdzB,KAAM,CACJ,UAAW,CACT3U,gBAAiB,QACjBqW,mBAAoB,MAEtBhX,MAAO,EACPwC,OAAQ,GACRiB,SAAU,WACVxD,OAAQ,OACRU,gBAAiB,QACjBQ,OAAQ,aACR8V,mBAAoB,mBACpBD,mBAAoB,MAEtBJ,aAAa,aACX5W,MAAO,OACPkX,cAAe,EACf,OAAQ,CACNvW,gBAAiB4C,EAAMK,QAAQC,WAAWC,MAC1CtB,OAAQ,EACRkB,IAAK,EACLD,SAAU,SACVyT,cAAe,EACfC,aAAc,uBAEhB,OAAQ,CACNpX,QAAS,EACTqX,cAAe,MACfC,WAAY,kBAEZ1S,SAAU,sBAEZ,sBAAuB,CACrB2S,YAAa,kBACbD,WAAY,qBAGb9T,EAAMqB,YAAY+I,KAAK,MAAQ,CAC9B,UAAW,CACT7N,QAAS,QAGX,aAAc,CACZA,QAAS,OACTC,QAAS,EACTgB,aAAc,EACdC,OAAQ,kBAGV,sBAAuB,CACrBsW,YAAa,EACbD,WAAY,GAGd,aAAc,CACZvX,QAAS,QACTuX,WAAY,KAKlBhT,iBAAkB,CAChB1D,gBAAiB4C,EAAMK,QAAQC,WAAWC,OAG5CsS,QAAS,CACPtW,QAAS,OACTwE,eAAgB,aA2MQwS,CAAmBhD,I,oBC1RxC,SAASyD,GAAT,GAA0C,IAApBrS,EAAmB,EAAnBA,MAAU1D,EAAS,4BACR2B,IAAM4B,SAASvI,IAAiB2C,OADxB,mBACvCqY,EADuC,KAC1BC,EAD0B,KAM9C,OAJAtU,IAAM8B,WAAU,WACdzI,IAAiB0C,iBAAiBuY,KACjC,IAECD,IAAgBvb,IAAaE,WAAe+I,EACvC,kBAAC2R,GAAD,iBAAkBrV,EAAlB,CAAyB0D,MAAOA,KAC9BsS,IAAgBvb,IAAaG,WAC/B,kBAACgL,GAAA,EAAD,8BAGL,kBAAC,IAAM/B,SAAP,KACE,kBAACqS,GAAA,EAAD,CAAUC,WAAS,EAAClV,MAAM,GACxB,kBAACmV,GAAA,EAAD,CAAkB/W,MAAM,aAF5B,IAIG,kBAACuG,GAAA,EAAD,oBAAqD,K,cCtBjDyQ,GAAb,wGACkBC,GAAgB,IAAD,OAC7BC,YAAW,WACT,GAA0B,oBAAf,EAAKD,GACd,MAAM,IAAIna,MAAMma,EAAO,yBACxB,OALP,KCEaE,GAAb,kDACE,aAAe,IAAD,8BACZ,gBACKC,gBAAgB,aACrB,EAAKA,gBAAgB,SAAU,OAC/B,EAAKA,gBAAgB,MAAO,MAAO,iBACnC,EAAKA,gBAAgB,MAAO,OAC5B,EAAKA,gBAAgB,SAAU,OAC/B,EAAKA,gBAAgB,cACrB,EAAKA,gBAAgB,eACrB,EAAKA,gBAAgB,cAAe,YACpC,EAAKA,gBAAgB,iBAAkB,MAAO,eAVlC,EADhB,UAAgCJ,I,+BC2EnBK,GAAY,I,sQAzEP,O,uLAEa,OAAvB,YAAApZ,KAAA,Q,qDACKA,K,gCAGQqZ,GAAK,0B,UACF,KADhBtF,E,QACKhW,O,gCACMub,GAAgB,iB,kDAEX,IAAhBvF,EAAKhW,O,0CACAgW,EAAK,GAAGwF,I,eAGjB1b,QAAQ8O,MAAM,2C,eACgBoH,GAAzByF,E,gBAEI5N,KAAI,SAACf,GAAD,OAAO4O,GAAW5O,EAAE0O,O,kBAE1BC,EAASD,I,0PAIhBG,K,SACaJ,GAAgB,a,+MAGlB9V,G,wEACXkW,K,SACaD,GAAWjW,G,6MAGhBA,EAAK8F,G,wEACboQ,K,SACaC,GAAOnW,EAAK8F,G,+MAGjB9F,G,8EACRkW,K,SACmBE,GAASpW,G,cAAxBqJ,E,yBACGA,G,wKAGIrJ,G,wEACXkW,K,SACaG,GAAOrW,G,oSAIpBkW,K,SACmBL,GAAK,sB,cAApBxM,E,QACGoH,SAAQ,SAAC6F,GACTA,EAAQ5N,cAAa4N,EAAQ5N,YAAc,O,kBAE3CW,G,sPAIP6M,K,KACaE,G,SAAe5Z,KAAK+Z,kB,2QAGjBC,G,wEAChBN,K,KACMC,G,SAAa3Z,KAAK+Z,kB,+BAAmBC,E,kNAGxBxW,EAAK0I,G,wEACxBwN,K,kBACOO,GAAiBzW,EAAK0I,I,yGAtETgN,KAgFxB,SAASQ,KACP,GAAIhc,IAAiB2C,QAAUlD,IAAaE,UAC1C,MAAM,IAAIwB,MAAM,yCAGpB,SAASqb,GAAKC,EAAUC,GACtB,IAAIC,GAAQ,IAAIxb,OAAQwb,MACxB,OAAO,IAAIvb,SAAQ,SAACC,EAASub,GAC3BH,EAASC,GAAQG,MACf,SAACC,GACKA,IAASA,EAAKC,OAAS,KAAOD,EAAKC,OAAS,MAC9C5c,QAAQgC,IAAI,gCAAiCwa,EAAOG,GACpDF,EAAOE,IAEPzb,EAAQyb,MAGZ,SAACE,GACC7c,QAAQgC,IAAI,oBAAqBwa,EAAOK,GACxCJ,EAAOI,S,SAOApB,G,mFAAf,WAA+BN,EAAM2B,GAArC,eAAAjc,EAAA,sEACqBwb,GAAKvb,OAAOC,KAAKK,OAAO2b,MAAMC,MAAMC,OAAQ,CAC7DC,SAAU,CACR/B,KAAMA,EACN2B,SAAUA,GAAY,aACtBK,QAAS,CAAC,kBAEZC,OAAQ,OAPZ,cACQT,EADR,yBASSA,EAAK3N,OAAO0M,IATrB,4C,+BAYeU,G,mFAAf,WAAgCiB,EAAQhP,GAAxC,iBAAAxN,EAAA,6DACEb,QAAQC,OAA8B,kBAAhBoO,GAGJ,UADZiP,EAAW,gCACuB,OACpB,SAAWA,EAAW,KAEtCC,EACFC,+EAEAC,KAAKC,UAAU,CAAErP,gBALC,uCALtB,SAaQgO,GAAKvb,OAAOC,KAAKK,OAAOuc,QAAS,CACrCC,KAAK,0BAAD,OAA4BP,GAChCQ,OAAQ,QACRC,OAAQ,CAAEC,WAAY,aACtBvd,KAAM+c,EACNS,QAAS,CACP,eAAgB,8BAAgCV,EAAW,OAnBjE,4C,+BAwBexB,G,mFAAf,WAAsBuB,EAAQY,GAA9B,SAAApd,EAAA,6DACEb,QAAQC,OAA0B,kBAAZge,GADxB,SAEQ5B,GAAKvb,OAAOC,KAAKK,OAAOuc,QAAS,CACrCC,KAAK,0BAAD,OAA4BP,GAChCQ,OAAQ,QACRC,OAAQ,CAAEC,WAAY,SACtBX,OAAQ,cACR5c,KAAMyd,IAPV,4C,+BAWejC,G,iFAAf,WAAsBqB,GAAtB,eAAAxc,EAAA,sEACqBwb,GAAKvb,OAAOC,KAAKK,OAAOuc,QAAS,CAClDC,KAAK,mBAAD,OAAqBP,GACzBQ,OAAQ,MACRC,OAAQ,CAAEV,OAAQ,iBAJtB,cACMpO,EADN,yBAOSA,EAAOA,OAAOkP,aAPvB,4C,+BAUenC,G,iFAAf,WAAwBsB,GAAxB,eAAAxc,EAAA,+EAEuBwb,GAAKvb,OAAOC,KAAKK,OAAO2b,MAAMC,MAAMja,IAAK,CAC1Dsa,OAAQA,EACRc,IAAK,UAJX,cAEUxB,EAFV,yBAOWA,EAAKnc,MAPhB,mCASqB,MAAb,KAAEoc,OATV,kEAUWwB,GAVX,0D,+BAee5C,G,iFAAf,WAAoB6C,GAApB,mBAAAxd,EAAA,+DAEQyd,EAAM,GAFd,uBAKyBjC,GAAKvb,OAAOC,KAAKK,OAAO2b,MAAMC,MAAMuB,KAAM,CAC3DC,OAAQ,gBACRpB,OAAQ,qDACRqB,SAAU,IACVC,UAAWC,EACXC,QAAS,cACTC,EAAGR,IAXX,OAKY1B,EALZ,OAaM2B,EAAMA,EAAIQ,OAAOnC,EAAK3N,OAAOgO,OAC7B2B,EAAQhC,EAAK3N,OAAO+P,cAd1B,UAeaJ,EAfb,gDAgBWL,GAhBX,2DAkBW,IAlBX,2D,+BAsBe1C,G,iFAAf,WAA0ByB,GAA1B,SAAAxc,EAAA,+EAEUwb,GAAKvb,OAAOC,KAAKK,OAAO2b,MAAMC,MAAM1a,OAAQ,CAChD+a,OAAQA,IAHd,iCAKW,GALX,mCAOuB,MAAf,KAAIT,OAPZ,2CAQa,GARb,6E,sBA7HAjd,OAAOqD,KAAKuY,I,sBCpDCyD,GAAb,kDACE,WAAYC,EAAYC,GAAa,IAAD,6BAClClf,QAAQC,OAAOgf,aAAsB5D,KACrC,gBAuBF1B,oBAAsBX,KAAEC,UAAS,WAC/B,EAAKkG,eACJ,KA3BiC,EA6BpCA,WA7BoC,sBA6BvB,4CAAAte,EAAA,6DAAOue,EAAP,yCACS,EAAKC,iBAAiBC,UAD/B,UACPC,EADO,YAGG,EAAKC,sBAHR,qCAGwC,EAAKC,kBAH7C,0BAGL5M,EAHK,KAKX,EAAKD,SACHC,EACG6M,QACA/N,YAAW,GACXyB,uBAAsB,GACtBuM,gBAAgB,IAAI5P,KAAKA,KAAK6P,QACjCR,GAGFG,IAdW,4CA7BuB,EAoFpC3F,KAAO,WACL,GAA2B,IAAvB,EAAKiG,cAAT,CAEA,EAAKA,gBAEL,IAAIhN,EAAQ,EAAKiN,SAAS,EAAKD,eAAeE,IAC1ClN,EAAMzE,OAASH,KACjB4E,EAAQA,EAAMlB,YAAW,GACrB,EAAKmO,SAAS,EAAKD,eAAeG,IAAI5R,OAASH,KACjD4E,EAAQA,EAAMO,uBAAsB,KAIxC,EAAK6M,SAAShK,IAAIpD,EAAMlN,IAAKkN,GAC7B,EAAKqN,oBAAoBrN,GACzB,EAAKuE,sBAnG6B,EAsGpC0C,KAAO,WACL,KAAI,EAAK+F,eAAiB,EAAKC,SAAS5f,QAAxC,CAEA,IAAIigB,EAAc,EAAKL,SAAS,EAAKD,iBACjChN,EAAQsN,EAAYH,IACpBnN,EAAMzE,OAASH,KACjB4E,EAAQA,EAAMlB,YAAW,GACrBwO,EAAYJ,IAAI3R,OAASH,KAC3B4E,EAAQA,EAAMO,uBAAsB,KAIxC,EAAK6M,SAAShK,IAAIpD,EAAMlN,IAAKkN,GAC7B,EAAKqN,oBAAoBrN,GACzB,EAAKuE,sBApH6B,EAuHpCgJ,KAvHoC,sBAuH7B,gCAAAvf,EAAA,0DACD,EAAKwf,UADJ,oDAGE,EAAKC,YAAY9d,QAAUlD,IAAaE,UAH1C,gCAIG,EAAK8gB,YAAYC,qBAJpB,6CAOY,EAAKC,YAAYC,aAP7B,UAODvK,EAPC,OASDwK,EAAa,IAAI/K,IAErBO,EAAKE,SAAQ,SAACpJ,GACZ,IAAI6F,EACA,EAAKoN,SAAS7d,IAAI4K,EAAE0O,IACtB7I,EAAQ,EAAKoN,SAASld,IAAIiK,EAAE0O,IACnB1O,EAAEqB,cAAgBJ,IAC3BjB,EAAE2T,UAAW,EACb9N,EAAQ,IAAI1E,GAAWnB,EAAE0O,IAAIpZ,WAE7B0K,EAAE2T,UAAW,EACb9N,EAAQ,IAAI1E,GACVnB,EAAE0O,GACFgF,EAAWhO,KAAOwD,EAAKhW,OAAS,GAC5B+N,GACAA,GACJjB,EAAEqB,aAEJ,EAAKuS,cAAc3K,IAAIjJ,EAAE0O,GAAI1O,EAAEqB,cAG7BrB,EAAEqB,cAAgB,EAAKuS,cAAc7d,IAAIiK,EAAE0O,MAC7C7I,EAAQA,EAAM5D,eAAejC,EAAEqB,aAC/B,EAAKuS,cAAc3K,IAAIjJ,EAAE0O,GAAI1O,EAAEqB,cAEjCqS,EAAWzK,IAAIjJ,EAAE0O,GAAI7I,MAGnBgO,EAAW,GACO,MAAlB,EAAKC,WAAmBD,EAAS/Q,KAAK,EAAKiR,kBAE/C7K,EAAK8K,UAAU5K,SAAQ,SAACpJ,GAClBA,EAAE2T,UAAYD,EAAW3d,IAAIiK,EAAE0O,IAAItN,OAASH,IAC9C4S,EAAS/Q,KAAK,EAAKmR,OAAOjU,EAAE0O,QAI5B,EAAKuE,SAAS7d,IAAI,OACpBse,EAAWzK,IAAI,KAAM,EAAKgK,SAASld,IAAI,OAGzC,EAAKkd,SAAWS,EAEW,IAAvB,EAAKT,SAASvN,KApDb,kCAqDG,EAAKyM,YAAW,GArDnB,iDAyDL,EAAK/H,oBAzDA,UA2DCnW,QAAQigB,IAAIL,GA3Db,4CAvH6B,EAqLpCM,iBAAmBnI,KAAEoI,UAAS,SAACrO,GAC7B,EAAK+N,UAAY/N,EACjB,EAAKqE,oBACL,EAAKoJ,YAAYa,YAAYtO,EAAS2K,eACrC,KAzLiC,EA2LpC9K,SAAW,SAACC,GAAgC,IAAzBuM,EAAwB,wDACzC,GAAK,EAAKa,SAAS7d,IAAIyQ,EAAMlN,KAA7B,CAEA,IAAI2b,EAAY,EAAKrB,SAASld,IAAI8P,EAAMlN,KAEpCkN,EAAMzE,OAASH,IAQnB,EAAKiS,oBAAoBrN,GACpBuM,GAAa,EAAKmC,gBAAgB1O,GACvC,EAAKoN,SAAShK,IAAIpD,EAAMlN,IAAKkN,GAE7B,EAAKuE,qBAXCkK,EAAUlT,OAASH,KACrB,EAAKgT,OAAOpO,EAAMlN,KAClB,EAAKsa,SAAShK,IAAIpD,EAAMlN,IAAKkN,MAnMC,EAmNpCwN,WAAY,EAnNwB,EAoNpCR,cAAgB,EApNoB,EAqNpCC,SAAW,GArNyB,EAsNpCQ,YAAc,KAtNsB,EAuNpCE,YAAc,KAvNsB,EAwNpCnB,iBAAmB,IAAImC,KAxNa,EA6NpCvB,SAAW,IAAItK,IA7NqB,EA8NpCmL,UAAY,KA9NwB,EA+NpCF,cAAgB,IAAIjL,IA/NgB,EAgOpC8L,eAAiB,IAAI3hB,IAhOe,EAkOpC4hB,UAlOoC,sBAkOxB,sBAAA7gB,EAAA,sEACJ,EAAKuf,OADD,OAEVhF,WAAW,EAAKsG,UAAW,MAFjB,2CAlOwB,EAuOpCC,YAAc,SAAC9I,GACb,IAAI,EAAK+I,aACL/I,EAAEgJ,QAAS,CACb,GAAkB,KAAdhJ,EAAEiJ,QAEJ,EAAKlI,YACA,GAAkB,KAAdf,EAAEiJ,QAEX,EAAKhI,WACA,IAAkB,KAAdjB,EAAEiJ,QAGN,OADL,EAAKnI,sBAEPd,EAAE/K,mBApP8B,EA4SpCmT,OA5SoC,uCA4S3B,WAAOtb,GAAP,qBAAA9E,EAAA,sEACa,EAAK2f,YAAYzd,IAAI4C,GADlC,UACHsY,EADG,OAGF,EAAKgC,SAAS7d,IAAIuD,GAHhB,uBAIL3F,QAAQ8O,MAAM,0CAA4CnJ,GAJrD,kCAQSyY,IAAZH,EARG,wBASLje,QAAQ8O,MAAM,OAASnJ,EAAM,eAC7B,EAAKsa,SAAS3d,OAAOqD,GACrB,EAAKyR,oBAXA,wCAgBW,KAAZ6G,EAhBC,iBAiBCpL,EAAQ,IAAI1E,GAAWxI,GAAKrD,SAChC,EAAKif,gBAAgB1O,GACrB,EAAKoN,SAAShK,IAAItQ,EAAKkN,GAnBpB,4BAqBGzE,EAAOqP,KAAKsE,MAAM9D,MAGbhQ,IACK,MAAbG,EAAKpH,MAA8B,MAAdoH,EAAKW,MAzB1B,uBA2BK,IAAI/N,MAAM,cAAgBid,GA3B/B,QA+BD7P,IAASH,IACT,EAAK2S,cAAc7d,IAAI4C,KAASsI,IAEhC,EAAKuS,YAAYvR,eAAetJ,EAAKsI,IAGnC4E,EAAQ,IAAI1E,GAAWxI,EAAKyI,EAAM,EAAKwS,cAAc7d,IAAI4C,IAE7D,EAAK4b,gBAAgB1O,GACrB,EAAKoN,SAAShK,IAAItQ,EAAKkN,GAxCpB,2DA2CL7S,QAAQ8O,MAAM,KAAEkT,QAAU,IAAMrc,EAAM,IAAMsY,GACvC,EAAKgC,SAASld,IAAI4C,GAAKkJ,iBAC1B,EAAKoR,SAAS3d,OAAOqD,GACrB,EAAKib,cAActe,OAAOqD,GAC1B,EAAK6a,YAAYle,OAAOqD,IA/CrB,QAmDP,EAAKyR,oBAnDE,2DA5S2B,sDAGlC,EAAKoJ,YAAcvB,EACnB,EAAKqB,YAAcpB,EACnB,EAAKwC,YACL5gB,OAAO2V,iBAAiB,UAAW,EAAKkL,aANN,EADtC,sDAWIxf,KAAKke,WAAY,EACjBvf,OAAO4V,oBAAoB,UAAWvU,KAAKwf,aAC3Cxf,KAAKsf,eAAiB,IAAI3hB,MAb9B,gCAgBYmiB,GACR9f,KAAKsf,eAAepf,IAAI4f,GACpB9f,KAAK8d,SAASvN,KAAO,GACvBuP,EAAS9f,KAAK+f,2BAA4B/f,KAAK2e,aAnBrD,kCAsBcmB,GACV9f,KAAKsf,eAAenf,OAAO2f,KAvB/B,4CAmDI,IAAIE,EAAkB,KAStB,OARAhgB,KAAK8d,SAAS7J,SAAQ,SAACvD,GACjBA,EAAMzE,OAASH,GACM,MAAnBkU,IAAyBA,EAAkBtP,GAE/CsP,EAAkB,QAIfA,IA5DX,8JAiEQhgB,KAAK8d,SAAS7d,IAAI,MAjE1B,wDAoEID,KAAK8d,SAAShK,IAAI,KAAM,IAAI9H,GAAW,MAAM7L,UApEjD,SAsEuBH,KAAKqe,YAAY4B,YAtExC,UAsEQC,EAtER,OAwESlgB,KAAK8d,SAAS7d,IAAI,MAxE3B,sBAyEY,IAAIpB,MAAM,0DAzEtB,cA4EQshB,EAAW,IAAInU,GAAWkU,EAAQlgB,KAAK8d,SAASld,IAAI,MAAMqL,KAAM,IACpEjM,KAAK8d,SAAShK,IAAIoM,EAAQC,GA7E9B,UA8EUngB,KAAK+d,oBAAoBoC,GA9EnC,eAgFIngB,KAAK8d,SAAS3d,OAAO,MAhFzB,kBAkFWggB,GAlFX,2IAgNgBC,GACZpgB,KAAKyf,YAAcW,IAjNvB,sCAyPkBD,GACd,GAAoB,MAAhBA,EAAS3c,IACX,MAAM,IAAI3E,MACR,mEAKDmB,KAAK8d,SAAS7d,IAAIkgB,EAAS3c,MAC3BxD,KAAK8d,SAASld,IAAIuf,EAAS3c,KAAKkJ,iBAKnC1M,KAAK2d,SAAW3d,KAAK2d,SAAS0C,MAAM,EAAGrgB,KAAK0d,eAC5C1d,KAAK2d,SAAShQ,KAAK,CACjBiQ,IAAK5d,KAAK8d,SAAS7d,IAAIkgB,EAAS3c,KAC5BxD,KAAK8d,SAASld,IAAIuf,EAAS3c,KAC3B,IAAIwI,GAAWmU,EAAS3c,KAAKrD,SACjC0d,IAAKsC,IAEPngB,KAAK0d,cAAgB1d,KAAK2d,SAAS5f,UA9QvC,mFAiR4B2S,GAjR5B,gFAkRQ4P,EAAqB,KACrB5P,EAAMxE,cAAgBlM,KAAKye,cAAc7d,IAAI8P,EAAMlN,OACrD8c,EAAqBtgB,KAAKqe,YAAYvR,eACpC4D,EAAMlN,IACNkN,EAAMxE,aAERlM,KAAKye,cAAc3K,IAAIpD,EAAMlN,IAAKkN,EAAMxE,cAGtCqU,EAAc,KACd7P,EAAMhE,iBACR6T,EAAcvgB,KAAKqe,YAAYvK,IAAIpD,EAAMlN,IAAK8X,KAAKC,UAAU7K,EAAMzE,QA7RzE,SA+RUnN,QAAQigB,IAAI,CAACuB,EAAoBC,IA/R3C,8QAmSqCvgB,KAAKqe,YAAYmC,cAnStD,UAmSUC,EAnSV,OAoSQzgB,KAAK0gB,sBAAwBD,EApSrC,iDAsSIzgB,KAAK0gB,oBAAsBD,EAE3BzgB,KAAK2e,UAAY,IAAIvW,KAASqY,GAE9BzgB,KAAKiV,oBA1ST,uJAoWI,OAAOzH,MAAMC,KAAKzN,KAAK8d,SAAS6C,UAC7B9B,UACAjU,QAAO,SAACC,GAAD,OAAOA,EAAEoB,OAASH,IAAiC,OAAVjB,EAAErH,SAtWzD,0CAyWuB,IAAD,OACZuP,EAAU/S,KAAK+f,2BACrB/f,KAAKsf,eAAerL,SAAQ,SAAC6L,GAC3BA,EAAS/M,EAAS,EAAK4L,UAAW,CAChCzJ,QAAS,EAAKyI,SAAS5f,OAAS,EAAK2f,cACrCvI,QAAS,EAAKwI,SAAS5f,OAAS,GAAK,EAAK2f,cAAgB,WA9WlE,GAlBA,kDACE,aAAe,IAAD,8BACZ,gBACKvE,gBAAgB,YAAa,YAClC,EAAKA,gBAAgB,cAAe,YACpC,EAAKA,gBAAgB,WAAY,QAAS,eAC1C,EAAKA,gBAAgB,mBAAoB,YACzC,EAAKA,gBAAgB,gBAAiB,cAEtC,EAAKA,gBAAgB,cAErB,EAAKA,gBAAgB,QACrB,EAAKA,gBAAgB,QAErB,EAAKA,gBAAgB,QAbT,EADhB,UAAuCJ,K,yCCehC,IAAM6H,GAAb,kDACE,WAAYC,GAAW,IAAD,EAEpB,GAFoB,qBACpB,gBA6IFC,iBAAmB,IAAIzB,KA9ID,EAgJtB0B,WAAa,KAhJS,EAiJtBC,iBAAmB,KAjJG,EAmJtBC,sBAAwB,SAACC,GACvB,MAAO,CACLC,SAAU,SAACC,GACT,EAAKJ,iBAAiBlN,IAAIoN,EAAUE,IAEtCtU,eAAgB,SAACuU,GACf,EAAKL,iBAAiBlU,eAAeoU,EAAUG,IAEjDC,SAAS,WAAD,4BAAE,sBAAA5iB,EAAA,sEACK,EAAKsiB,iBAAiBpgB,IAAIsgB,GAD/B,mFAAF,kDAAC,GAGT/gB,OAAO,WAAD,4BAAE,sBAAAzB,EAAA,6DACN,EAAKqiB,WAAWhL,OAAO,EAAKgL,WAAWQ,QAAQL,GAAW,GAC1D,EAAKM,QAAQrhB,OAAO+gB,GAFd,SAGA,EAAKF,iBAAiB7gB,OAAO+gB,GAH7B,2CAAF,kDAAC,KA9JW,EAuKtBM,QAAU,IAAIhO,IAvKQ,EAiLtBiO,OAjLsB,WAkLpB,cAAiE,IAAD,OAAlDC,EAAkD,EAAlDA,UAAWC,EAAuC,EAAvCA,uBAAwB5F,EAAe,EAAfA,YAAe,yBAoJhE6F,YAAc/K,KAAEoI,UAAS,WACvB,EAAK4C,kBAAoBvG,KAAKC,UAAU,EAAKuG,SAC7C,EAAKC,WAAWZ,SAAS,EAAKU,qBAC7B,KAvJ6D,KAyJhEG,kBAAoBnL,KAAEoI,UAAS,WAC7B,EAAKgD,wBAA0B,EAAKxD,cACjC7S,KAAI,SAACf,GAAD,OAAc,OAANA,EAAa,OAASA,KAClCoD,KAAK,KAER,EAAK8T,WAAWjV,eAAe,EAAKmV,2BACnC,KA/J6D,KAiKhEC,yBAjKgE,sBAiKrC,sBAAAxjB,EAAA,6DACC,MAAtB,EAAKyjB,gBACP,EAAKA,cAAgB,EAAKC,gBAFH,SAInB,EAAKD,cAJc,OAKzB,EAAKA,cAAgB,KALI,2CAjKqC,KAwKhEA,cAAgB,KAxKgD,KAyKhEC,aAzKgE,sBAyKjD,8BAAA1jB,EAAA,sEACgB,EAAKqjB,WAAWT,WADhC,UACTe,EADS,gBAGP1B,EAASrF,KAAKsE,MAAMyC,GACnB7U,MAAM8U,QAAQ3B,GAJR,sBAKH,IAAI9hB,MAAM,oCALP,OAQX,KAAO8hB,EAAO5iB,OAAS,EAAK0gB,cAAc1gB,QACxC4iB,EAAOhT,KAAK,IAEd,EAAKmU,QAAUnB,EACf,EAAKkB,kBAAoBQ,EACzB,EAAKE,oBAAsBC,KAAIH,GAC/B,EAAKI,UAAW,EAdL,kDAkBX5kB,QAAQ8O,MACN,4BAA8B,KAAMkT,QAAU,IAAMwC,GAElD,EAAKK,0BACP,EAAKZ,QAAUtU,MAnYP,GAmYwBnM,KAAK,IACrC,EAAKohB,UAAW,EAChB,EAAKZ,kBAAoB,KACzB,EAAKD,eAEL,EAAKG,WAAW5hB,SA3BP,0DAxKbH,KAAK+hB,WAAaL,EAClB1hB,KAAKuiB,oBAAsBxG,OACIE,IAA3B0F,GACF3hB,KAAK8hB,QAAUtU,MAxML,GAwMsBnM,KAAK,IACrCrB,KAAKye,cAAgB,GACrBze,KAAKyiB,UAAW,IAEhBziB,KAAKiiB,wBAA0BN,EAC/B3hB,KAAKyiB,UAAW,EAChBziB,KAAKye,cAAgBkD,EAClBtU,MAAM,KACNzB,KAAI,SAACf,GAAD,MAAc,SAANA,EAAe,KAAOA,MA9LrB,qDAmMlB,OAAO7K,KAAKye,cAAc1gB,QArNd,IAkBM,oCAwMlB,IADA,IAAI4kB,EAAU,GACLtR,EAAI,EAAGA,EAAIrR,KAAKye,cAAc1gB,QAAUsT,EA1NrC,EA0NoDA,IACjC,MAAzBrR,KAAKye,cAAcpN,IAAYsR,EAAQhV,KAAK0D,GAClD,OAAOsR,IA1MW,wJA8MlB3iB,KAAK0iB,0BAA2B,EA9Md,SAiNI,MAAhB1iB,KAAK8hB,QAjNO,gCAiNgB9hB,KAAKkiB,2BAjNrB,UAkNI,MAAhBliB,KAAK8hB,QAlNO,yCAkNiB,MAlNjB,WAoNZ9hB,KAAK4iB,SApNO,sBAqNR,IAAI/jB,MAAM,4CArNF,cAuNZgkB,EAAS7iB,KAAKye,cAAc1gB,OAChCiC,KAAKye,cAAc9Q,KAAK,IAExB3N,KAAK8M,eAAe+V,EAAQ,IA1NZ,kBA4NTA,GA5NS,yBA8NhB7iB,KAAK0iB,0BAA2B,EA9NhB,uMAkOPG,GAlOO,oEAmOgB,MAA9B7iB,KAAKye,cAAcoE,GAnOL,sBAoOV,IAAIhkB,MAAM,2BApOA,UAqOyC,IAAvDmB,KAAKye,cAAc7T,QAAO,SAACC,GAAD,OAAY,MAALA,KAAW9M,OArO9B,gCAsOViC,KAAK+hB,WAAW5hB,SAtON,6BAuObH,KAAK8M,eAAe+V,EAAQ,MAvOf,+KA0OLA,EAAQvZ,GA1OH,oEA2OE,MAAhBtJ,KAAK8hB,QA3OS,gCA2Oc9hB,KAAKkiB,2BA3OnB,UA4OE,MAAhBliB,KAAK8hB,QA5OS,iDA8OlB9hB,KAAK8hB,QAAQe,GAAUvZ,EACvBtJ,KAAKyiB,UAAW,EAChBziB,KAAK6hB,kBAAoB,KACzB7hB,KAAK4hB,cAjPa,iLAoPLiB,GApPK,oEAqPiB,OAA/B7iB,KAAKye,cAAcoE,GArPL,8CAqP8B5G,GArP9B,UAsPE,MAAhBjc,KAAK8hB,QAtPS,gCAsPc9hB,KAAKkiB,2BAtPnB,UAuPE,MAAhBliB,KAAK8hB,QAvPS,8CAuPe7F,GAvPf,gCAyPXjc,KAAK8hB,QAAQe,IAzPF,4IA4PLA,EAAQ3W,GACrB,GACE2W,GAAU7iB,KAAKye,cAAc1gB,QACC,MAA9BiC,KAAKye,cAAcoE,GAEnB,MAAM,IAAIhkB,MACR,wEAIJmB,KAAKye,cAAcoE,GAAU3W,EAC7BlM,KAAKiiB,wBAA0B,KAC/BjiB,KAAKyiB,UAAW,EAEhBziB,KAAKgiB,sBA1Qa,qCA6QLa,GACb,OAAO7iB,KAAKye,cAAcoE,KA9QR,uCAiRHlB,EAAwB5F,GACvC,OAAI/b,KAAKyiB,UAEqB,MAA1BziB,KAAK6hB,mBAC2B,MAAhC7hB,KAAKiiB,yBACLO,KAAIxiB,KAAK6hB,qBAAuB9F,GAChC/b,KAAKiiB,0BAA4BN,IAEjC3hB,KAAKyiB,UAAW,EAChBziB,KAAKuiB,oBAAsBxG,GAEtB,CAAEyC,UAAU,KAGjBxe,KAAKiiB,0BAA4BN,IACnC3hB,KAAKiiB,wBAA0BN,EAE/B3hB,KAAKye,cAAgBkD,EAClBtU,MAAM,KACNzB,KAAI,SAACf,GAAD,MAAc,SAANA,EAAe,KAAOA,MAGnC7K,KAAKuiB,sBAAwBxG,GAC/B/b,KAAK6hB,kBAAoB,KACzB7hB,KAAK8hB,QAAU,KACR,CAAEtD,UAAU,IAGd,CAAEA,UAAU,QA7SD,OA4XtBsE,eAAiB,SAACC,GAChB,IAAIC,EAAYD,EAASxB,QAAQ,KAGjC,MAAO,CAAE0B,UAFOvV,OAAOqV,EAASG,UAAU,EAAGF,IAEzBG,SADLJ,EAASG,UAAUF,EAAY,MA7XzCnC,aAAoB3H,GACvB,MAAM,IAAIra,MACR,4DAJgB,OAMpB,EAAKmiB,iBAAmBH,EANJ,EADxB,uMAWwB7gB,KAAK8gB,iBAAiB3D,UAX9C,UAWQC,EAXR,gBAa8B,OAApBpd,KAAK+gB,WAbf,sBAcc,IAAIliB,MAAM,oCAdxB,UAiBUukB,EAAkB,WACpB,GAA+B,IAA3B,EAAKrC,WAAWhjB,OACpB,OAAO,EAAKgjB,WAAW,EAAKA,WAAWhjB,OAAS,IAIrB,IAA3BiC,KAAK+gB,WAAWhjB,SAChBiC,KAAKwhB,QAAQ5gB,IAAIwiB,KAAmBR,SAxB5C,kCA0BgC5iB,KAAKghB,iBAAiBf,YA1BtD,QA0BYoD,EA1BZ,OA2BQrjB,KAAK+gB,WAAWpT,KAAK0V,GACrBrjB,KAAKwhB,QAAQ1N,IACXuP,EACA,IAAIrjB,KAAKyhB,OAAO,CACdC,UAAW1hB,KAAKihB,sBAAsBoC,MA/BlD,eAoCUF,EAAWC,IApCrB,UAqC4BpjB,KAAKwhB,QAAQ5gB,IAAIuiB,GAAUG,eArCvD,eAqCUC,EArCV,yBAsCaA,EAAY,IAAMJ,GAtC/B,yBAwCM/F,IAxCN,uMA4Ce5Z,GA5Cf,6FA6CwBxD,KAAK8gB,iBAAiB3D,UA7C9C,UA6CQC,EA7CR,kBA+CsCpd,KAAK8iB,eAAetf,GAA5Cyf,EA/Cd,EA+CcA,UAAWE,EA/CzB,EA+CyBA,SACdnjB,KAAKwhB,QAAQvhB,IAAIkjB,GAhD5B,iEAkDYnjB,KAAKwhB,QAAQ5gB,IAAIuiB,GAAUhjB,OAAO8iB,GAlD9C,uBAoDM7F,IApDN,mMAwDY5Z,EAAK8F,GAxDjB,gFAyDoCtJ,KAAK8iB,eAAetf,GAA5Cyf,EAzDZ,EAyDYA,UAAWE,EAzDvB,EAyDuBA,SACdnjB,KAAKwhB,QAAQvhB,IAAIkjB,GA1D1B,iDA2DInjB,KAAKwhB,QAAQ5gB,IAAIuiB,GAAUhC,SAAS8B,EAAW3Z,GA3DnD,+KA8De9F,GA9Df,uEA+DU,IAAI3E,MACR,4LAhEN,qKAsEY2E,GAtEZ,gFAuEoCxD,KAAK8iB,eAAetf,GAA5Cyf,EAvEZ,EAuEYA,UAAWE,EAvEvB,EAuEuBA,SACdnjB,KAAKwhB,QAAQvhB,IAAIkjB,GAxE1B,8CAwE4ClH,GAxE5C,gCAyEWjc,KAAKwhB,QAAQ5gB,IAAIuiB,GAAU7B,SAAS2B,IAzE/C,yRA6EwBjjB,KAAK8gB,iBAAiB3D,UA7E9C,cA6EQC,EA7ER,yBA+E+Bpd,KAAKghB,iBAAiB1C,aA/ErD,cA+EUkF,EA/EV,OAgFUC,EAAY,GACZC,EAAY,IAAIlQ,IAChBmQ,EAAU,EAEdH,EAAavP,SAAQ,SAACkP,GACpB,IAAI3E,GAAW,EACXoF,EAA6B,IAAdD,IAEnB,GAAI,EAAKnC,QAAQvhB,IAAIkjB,EAAS5J,IAAK,CACjC,IAAIsK,EAAQ,EAAKrC,QAAQ5gB,IAAIuiB,EAAS5J,IACtCmK,EAAU5P,IAAIqP,EAAS5J,GAAIsK,GAE3BrF,EAAWqF,EAAMC,iBACfX,EAASjX,YACTiX,EAASpH,aACTyC,cAEFkF,EAAU5P,IACRqP,EAAS5J,GACT,IAAI,EAAKkI,OAAO,CACdC,UAAW,EAAKT,sBAAsBkC,EAAS5J,IAC/CoI,uBAAwBwB,EAASjX,YACjC0X,eACA7H,YAAaoH,EAASpH,eAI5B,IAAI8H,EAAQH,EAAU9iB,IAAIuiB,EAAS5J,IACnCsK,EAAME,cAAc9P,SAAQ,SAAC4O,GAC3BY,EAAU9V,KAAK,CACb4L,GAAIsJ,EAAS,IAAMM,EAAS5J,GAC5BiF,WACAtS,YAAa2X,EAAMG,eAAenB,WAKxC7iB,KAAKwhB,QAAUkC,EACf1jB,KAAK+gB,WAAayC,EAAa5X,KAAI,SAACf,GAAD,OAAOA,EAAE0O,MAtHlD,kBAwHakK,GAxHb,yBA0HMrG,IA1HN,+RA+HiBpd,KAAKghB,iBAAiBR,cA/HvC,yNAkIoBxG,GAlIpB,uFAmIwBha,KAAK8gB,iBAAiB3D,UAnI9C,cAmIQC,EAnIR,gBAoIUpd,KAAKghB,iBAAiB9B,YAAYlF,GApI5C,OAqIIoD,IArIJ,qLAwIuB5Z,EAAK0I,GAxI5B,gFAyIoClM,KAAK8iB,eAAetf,GAA5Cyf,EAzIZ,EAyIYA,UAAWE,EAzIvB,EAyIuBA,SACdnjB,KAAKwhB,QAAQvhB,IAAIkjB,GA1I1B,iDA2IInjB,KAAKwhB,QAAQ5gB,IAAIuiB,GAAUrW,eAAemW,EAAW/W,GA3IzD,8GAAwCgN,IAqY3B+K,GAAb,kDACE,WAAYpD,GAAW,IAAD,EAEpB,GAFoB,qBACpB,gBAsFFG,iBAAmB,MArFZH,aAAoB3H,GACvB,MAAM,IAAIra,MACR,4DAJgB,OAMpB,EAAKmiB,iBAAmBH,EANJ,EADxB,uGAU0Bf,GAV1B,yEAWQoE,EAAe,EAXvB,YAYWA,EAAe,IAZ1B,0CAcqBpE,IAdrB,+EAgBYqE,EAAqB,WAAI,EAAKD,KAClCrmB,QAAQ8O,MAAR,yBACoBmT,EAAS9G,KAD7B,cACuC,KAAM6G,QAD7C,kCAC8EsE,EAD9E,cAjBR,UAoBcnkB,KAAKokB,OAA4B,IAArBD,GApB1B,+BAwBItmB,QAAQ8O,MAAM,yBAxBlB,4QA4BiB3M,KAAKqkB,kBAChBrkB,KAAKghB,iBAAiBf,UAAUrgB,KAAKI,KAAKghB,mBA7BhD,oNAiCexd,GAjCf,iFAkCiBxD,KAAKqkB,kBAChBrkB,KAAKghB,iBAAiB7gB,OAAOP,KAAKI,KAAKghB,iBAAkBxd,IAnC/D,kNAuCYA,EAAK8F,GAvCjB,iFAwCiBtJ,KAAKqkB,kBAChBrkB,KAAKghB,iBAAiBlN,IAAIlU,KAAKI,KAAKghB,iBAAkBxd,EAAK8F,IAzCjE,oNA6CY9F,GA7CZ,iFA8CiBxD,KAAKqkB,kBAChBrkB,KAAKghB,iBAAiBpgB,IAAIhB,KAAKI,KAAKghB,iBAAkBxd,IA/C5D,qNAmDeA,GAnDf,iFAoDiBxD,KAAKqkB,kBAChBrkB,KAAKghB,iBAAiBnH,OAAOja,KAAKI,KAAKghB,iBAAkBxd,IArD/D,4SA0DiBxD,KAAKqkB,kBAChBrkB,KAAKghB,iBAAiB1C,WAAW1e,KAAKI,KAAKghB,mBA3DjD,4SAgEiBhhB,KAAKqkB,kBAChBrkB,KAAKghB,iBAAiBR,YAAY5gB,KAAKI,KAAKghB,mBAjElD,yNAqEoBhH,GArEpB,iFAsEiBha,KAAKqkB,kBAChBrkB,KAAKghB,iBAAiB9B,YAAYtf,KAChCI,KAAKghB,iBACLhH,IAzER,6NA8EuBxW,EAAK0I,GA9E5B,iFA+EiBlM,KAAKqkB,kBAChBrkB,KAAKghB,iBAAiBlU,eAAelN,KACnCI,KAAKghB,iBACLxd,EACA0I,IAnFR,8KAyFSoY,GACL,OAAO,IAAIxlB,SAAQ,SAACC,GAAD,OAAaka,WAAWla,EAASulB,UA1FxD,GAAkCpL,IA8FrBqL,GAAb,kDAEE,WAAY1D,GAAW,IAAD,EAEpB,GAFoB,qBACpB,gBAFFG,iBAAmB,MAGZH,aAAoB3H,GACvB,MAAM,IAAIra,MACR,4DAJgB,OAMpB,EAAKmiB,iBAAmBH,EACxB,EAAK2D,SAAW,IAAIC,KAAW,CAC7BC,cAAe,EACfC,QAAS,KATS,EAFxB,6LAgBiB3kB,KAAKwkB,SAASI,UAAS,kBAClC,EAAK5D,iBAAiBf,eAjB5B,oNAqBezc,GArBf,4FAsBiBxD,KAAKwkB,SAASI,UAAS,kBAClC,EAAK5D,iBAAiB7gB,OAAOqD,MAvBnC,kNA2BYA,EAAK8F,GA3BjB,4FA4BiBtJ,KAAKwkB,SAASI,UAAS,kBAClC,EAAK5D,iBAAiBlN,IAAItQ,EAAK8F,MA7BrC,oNAiCY9F,GAjCZ,4FAkCiBxD,KAAKwkB,SAASI,UAAS,kBAAM,EAAK5D,iBAAiBpgB,IAAI4C,MAlCxE,qNAqCeA,GArCf,4FAsCiBxD,KAAKwkB,SAASI,UAAS,kBAClC,EAAK5D,iBAAiBnH,OAAOrW,MAvCnC,uTA4CiBxD,KAAKwkB,SAASI,UAAS,kBAClC,EAAK5D,iBAAiB1C,gBA7C5B,uTAkDiBte,KAAKwkB,SAASI,UAAS,kBAClC,EAAK5D,iBAAiBR,iBAnD5B,yNAuDoBxG,GAvDpB,4FAwDiBha,KAAKwkB,SAASI,UAAS,kBAClC,EAAK5D,iBAAiB9B,YAAYlF,MAzDxC,6NA6DuBxW,EAAK0I,GA7D5B,4FA8DiBlM,KAAKwkB,SAASI,UAAS,kBAClC,EAAK5D,iBAAiBlU,eAAetJ,EAAK0I,MA/DhD,sJAAsCgN,IC3avB2L,OA7Df,WACE,IAAMC,EAAkBC,YAAc,gCAEhCtgB,EAAQJ,IAAM2gB,SAClB,kBACEC,YAAe,CACbngB,QAAS,CACPvB,KAAMuhB,EAAkB,OAAS,QACjC1W,QAAS,CAAE8W,KAAMJ,EAAkBK,IAAS,KAAOC,IAAK,MACxDrgB,WAAY,CACVa,QAASkf,EAAkB,UAAYK,IAAS,UAIxD,CAACL,IAdU,EAgByBzgB,IAAM4B,UAAS,GAhBxC,mBAgBNmR,EAhBM,KAgBOiO,EAhBP,KAiBPC,EAAoBjhB,IAAMsP,aAAY,SAAC4R,GACvC5mB,OAAO0U,YAAc,KACvBgS,GAAe,KAEhB,IAEGG,EAAanhB,IAAMsP,aAAY,SAAC4R,GACpCF,GAAe,KACd,IAzBU,EA2BahhB,IAAM4B,SAAS,MA3B5B,mBA2BNG,EA3BM,KA2BCqf,EA3BD,KA+Cb,OAlBAphB,IAAM8B,WAAU,WACdzI,IAAiB0C,kBAAiB,SAACslB,GAC7BA,IAAavoB,IAAaE,UAC5BooB,EACE,IAAI5I,GD1CL,IAAI+D,GACT,IAAI2D,GAAiB,IAAIN,GC0CA7K,MACjB1b,MAIJ+nB,GAAS,SAACE,GAER,OADMA,GAAUA,EAASC,UAClB,aAIZ,IAGD,kBAACC,EAAA,EAAD,CAAephB,MAAOA,GACpB,kBAACqhB,EAAA,EAAD,MACA,kBAAClf,GAAD,CAASK,MAAOmQ,EAAahR,MAAOA,IACpC,kBAACqS,GAAD,CACEzN,QAASsa,EACTlO,YAAaA,EACbC,aAAcmO,EACdpf,MAAOA,MC7DK2f,QACW,cAA7BpnB,OAAOqnB,SAASC,UAEe,UAA7BtnB,OAAOqnB,SAASC,UAEhBtnB,OAAOqnB,SAASC,SAASC,MACvB,2DCZNC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,GAAD,OAEFpoB,SAASqoB,eAAe,SDyHpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBlM,MAAK,SAAAmM,GACJA,EAAaC,gBAEdC,OAAM,SAAAja,GACL9O,QAAQ8O,MAAMA,EAAMkT,a,gCEzI5B,wEAGMtb,EAAYC,YAAW,CAC3B+C,UAAW,CACTgH,KAAM,EACNvN,QAAS,OACTwE,eAAgB,SAChB1D,WAAY,YAGT,SAASwG,EAAmB5F,GACjC,IAAMmE,EAAUtC,IAChB,OACE,yBAAKa,UAAWyB,EAAQU,WACtB,kBAAC,IAAD,eAAYO,QAAQ,MAASpF,GAC1BA,EAAMjB,a,sFChBTolB,E,WAmBJ,WAAY5a,GAGV,GAHiB,oBACG,kBAATA,IAAmBA,EAAOqP,KAAKsE,MAAM3T,IAElB,mBAAnBA,EAAKqE,WAAgD,kBAAdrE,EAAKzC,KACrD,MAAM,IAAI3K,MAAM,mBAAqByc,KAAKC,UAAUtP,IACtDjM,KAAK8mB,WAAa7a,EAAKqE,UACvBtQ,KAAK+mB,MAAQ9a,EAAKzC,K,yDAdP8G,GACX,OAAO,IAAIuW,EAAK,CAAEvW,YAAW9G,KAAMxJ,KAAK+mB,U,8BAGlCvd,GACN,OAAO,IAAIqd,EAAK,CAAErd,OAAM8G,UAAWtQ,KAAK8mB,e,gCAXxC,OAAO9mB,KAAK8mB,a,2BAGZ,OAAO9mB,KAAK+mB,U,iDAqBZ,OAAOzL,KAAKC,UAAU,CAAEjL,UAAWtQ,KAAK8mB,WAAYtd,KAAMxJ,KAAK+mB,Y,KAItD3e,EAAb,WA0CE,WAAY4e,GAAO,oBACjB,IAGE,GAFoB,kBAATA,IAAmBA,EAAO1L,KAAKsE,MAAMoH,KAG7CxZ,MAAM8U,QAAQ0E,EAAK1V,aACnB0V,EAAK1V,UAAUtD,OACd,SAACnD,GAAD,MAAoD,kBAAtClB,OAAOC,cAAciB,EAAEgB,cAGvC,MAAM,IAAIhN,MAAM,mBAAqByc,KAAKC,UAAUyL,IAGtDhnB,KAAKinB,WAAaD,EAAK1V,UACvBtR,KAAKknB,UAAY,IAAIL,EAAKG,EAAKnV,UAC/B7R,KAAKmnB,WAAa,IAAIN,EAAKG,EAAK9U,WAChC,MAAOvF,GACDqa,GAAMnpB,QAAQ8O,MAAM,yBAA2BA,EAAMkT,SAC3D7f,KAAKonB,qBA5DX,yDAWe9V,GACX,OAAO,IAAIlJ,EAAS,CAClBkJ,YACAO,SAAU7R,KAAKknB,UACfhV,UAAWlS,KAAKmnB,eAftB,kCAkBctV,GACV,OAAO,IAAIzJ,EAAS,CAClBkJ,UAAWtR,KAAKinB,WAChBpV,WACAK,UAAWlS,KAAKmnB,eAtBtB,mCA0BejV,GACX,OAAO,IAAI9J,EAAS,CAClBkJ,UAAWtR,KAAKinB,WAChBpV,SAAU7R,KAAKknB,UACfhV,gBA9BN,kCAmCI,OAAOoJ,KAAKC,UAAU,CACpBjK,UAAWtR,KAAKinB,WAChBpV,SAAU7R,KAAKknB,UAAU3L,YACzBrJ,UAAWlS,KAAKmnB,WAAW5L,gBAtCjC,gCAEI,OAAOvb,KAAKinB,aAFhB,+BAKI,OAAOjnB,KAAKknB,YALhB,gCAQI,OAAOlnB,KAAKmnB,eARhB,yDAiEInnB,KAAKknB,UAAY,IAAIL,EAAK,CACxBvW,WAAW,EACX9G,KAAM,uDAGRxJ,KAAKmnB,WAAa,IAAIN,EAAK,CACzBvW,WAAW,EACX9G,KACE,wFAKJxJ,KAAKinB,WAAa,CAChB,CAAEpb,UAAW,OAASrC,KAAM,cAC5B,CAAEqC,UAAW,OAASrC,KAAM,QAC5B,CAAEqC,UAAW,OAASrC,KAAM,WAC5B,CAAEqC,UAAW,OAASrC,KAAM,SAC5B,CAAEqC,UAAW,OAASrC,KAAM,UAC5B,CAAEqC,UAAW,OAASrC,KAAM,QAC5B,CAAEqC,UAAW,OAASrC,KAAM,SAC5B,CAAEqC,UAAW,OAASrC,KAAM,gBAtFlC,O","file":"static/js/main.d6c5f9df.chunk.js","sourcesContent":["// PUBLIC SECTION\nexport const GDriveStates = {\n  LOADING: \"loading\",\n  SIGNED_IN: \"signed_in\",\n  SIGNED_OUT: \"signed_out\",\n  FAILED: \"failed\",\n};\nObject.freeze(GDriveStates);\n\nclass GDriveAuthClient {\n  #state = GDriveStates.LOADING;\n  #stateListeners = new Set();\n\n  get state() {\n    return this.#state;\n  }\n\n  addStateListener(listener) {\n    console.assert(typeof listener == \"function\");\n    console.assert(listener.length === 1);\n    console.assert(!this.#stateListeners.has(listener));\n\n    this.#stateListeners.add(listener);\n  }\n\n  removeStateListener(listener) {\n    console.assert(typeof listener == \"function\");\n    console.assert(listener.length === 1);\n    console.assert(this.#stateListeners.has(listener));\n    this.#stateListeners.delete(listener);\n  }\n\n  async waitForStateChange() {\n    return await new Promise((resolve) => {\n      let listener = (state) => {\n        this.removeStateListener(listener);\n        resolve(state);\n      };\n      this.addStateListener(listener);\n    });\n  }\n\n  constructor() {\n    loadGapi(async () => {\n      try {\n        if (!window.gapi) {\n          throw new Error(\"Failed loading GAPI\");\n        }\n\n        await new Promise((resolve) =>\n          window.gapi.load(\"client:auth2\", resolve)\n        );\n\n        await window.gapi.client.init({\n          clientId:\n            \"479709565206-4ek8a502261s9sussiehpa5v146ns2ku.apps.googleusercontent.com\",\n          discoveryDocs: [\n            \"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\",\n          ],\n          scope: \"https://www.googleapis.com/auth/drive.appfolder\",\n        });\n\n        if (!isGapiLoaded()) {\n          throw new Error(\"Failed registering client_id.\");\n        }\n\n        this._updateSignInState();\n\n        window.gapi.auth2\n          .getAuthInstance()\n          .isSignedIn.listen(this._updateSignInState.bind(this));\n      } catch (error) {\n        console.log(error);\n        this.#state = GDriveStates.FAILED;\n        this._notifyStateChanged();\n        return;\n      }\n    });\n  }\n\n  signIn() {\n    console.assert(isGapiLoaded());\n    if (!!window.mocha) {\n      window.gapi.auth2.getAuthInstance().signIn();\n    } else {\n      window.gapi.auth2.getAuthInstance().signIn({\n        prompt: \"select_account\",\n      });\n    }\n  }\n\n  signOut() {\n    console.assert(isGapiLoaded());\n    let auth_instance = window.gapi.auth2.getAuthInstance();\n    auth_instance.signOut();\n  }\n\n  _notifyStateChanged() {\n    for (let listener of this.#stateListeners) {\n      listener(this.#state);\n    }\n  }\n\n  _updateSignInState() {\n    console.assert(this.#state !== GDriveStates.FAILED);\n    let current_state = isSignedIn()\n      ? GDriveStates.SIGNED_IN\n      : GDriveStates.SIGNED_OUT;\n    if (this.#state !== current_state) {\n      this.#state = current_state;\n      this._notifyStateChanged();\n    }\n  }\n}\n\nexport const gdriveAuthClient = new GDriveAuthClient();\nObject.seal(gdriveAuthClient);\n\n// PRIVATE SECTION\nfunction loadGapi(ondone) {\n  console.assert(typeof ondone == \"function\");\n  console.assert(ondone.length === 0);\n  var script = document.createElement(\"script\");\n  script.async = true;\n  script.src = \"https://apis.google.com/js/api.js\";\n  document.body.appendChild(script);\n  script.onload = ondone;\n  script.onerror = ondone;\n}\n\nfunction isGapiLoaded() {\n  return window.gapi && window.gapi.auth2 && window.gapi.client;\n}\n\nfunction isSignedIn() {\n  console.assert(isGapiLoaded());\n  return window.gapi.auth2.getAuthInstance().isSignedIn.get();\n}\n","import React from \"react\";\n\nexport default ({ active }) => (\n  <div\n    style={{\n      display: \"flex\",\n      padding: 10,\n    }}\n  >\n    <svg width=\"18\" height=\"18\" xmlns=\"http://www.w3.org/2000/svg\">\n      <g fill=\"#000\" fillRule=\"evenodd\">\n        <path\n          d=\"M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z\"\n          fill=\"#EA4335\"\n        />\n        <path\n          d=\"M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z\"\n          fill=\"#4285F4\"\n        />\n        <path\n          d=\"M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z\"\n          fill=\"#FBBC05\"\n        />\n        <path\n          d=\"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z\"\n          fill=\"#34A853\"\n        />\n        <path fill=\"none\" d=\"M0 0h18v18H0z\" />\n      </g>\n    </svg>\n  </div>\n);\n","import React from \"react\";\nimport Icon from \"./googleIcon\";\nimport { GDriveStates } from \"./GDriveAuthClient.js\";\nimport Popper from \"@material-ui/core/Popper\";\nimport { Alert, AlertTitle } from \"@material-ui/lab\";\n\nconst ButtonContent = ({ children }) => (\n  <span\n    style={{\n      padding: 10,\n      paddingLeft: 0,\n      fontWeight: 500,\n    }}\n  >\n    {children}\n  </span>\n);\n\nlet buttonStyle = {\n  backgroundColor: \"#fff\",\n  display: \"inline-flex\",\n  alignItems: \"center\",\n  color: \"rgba(0, 0, 0, .54)\",\n  boxShadow: \"0 2px 2px 0 rgba(0, 0, 0, .24), 0 0 1px 0 rgba(0, 0, 0, .24)\",\n  padding: 0,\n  borderRadius: 2,\n  border: \"1px solid transparent\",\n  fontSize: 14,\n  fontWeight: \"500\",\n  fontFamily: \"Roboto, sans-serif\",\n  cursor: \"pointer\",\n};\n\nlet disabledStyle = {\n  opacity: 0.6,\n};\n\nexport class GoogleSignInButton extends React.PureComponent {\n  state = {\n    authState: this.props.gdriveAuthClient.state,\n    prevAuthState: this.props.gdriveAuthClient.LOADING,\n    buttonAnchor: null,\n  };\n\n  componentDidMount() {\n    if (this.state.authState !== this.props.gdriveAuthClient.state) {\n      this.#setAuthState(this.props.gdriveAuthClient.state);\n    }\n    this.props.gdriveAuthClient.addStateListener(this.#setAuthState);\n  }\n  componentWillUnmount() {\n    this.props.gdriveAuthClient.removeStateListener(this.#setAuthState);\n  }\n\n  #setAuthState = (authState) => {\n    this.setState((prevState) => {\n      return { ...prevState, prevAuthState: prevState.authState, authState };\n    });\n  };\n\n  #setButtonAnchor = (buttonAnchor) => {\n    this.setState((prevState) => {\n      return { ...prevState, buttonAnchor };\n    });\n  };\n\n  #getButtonStyle = () => {\n    if (\n      this.state.authState === GDriveStates.FAILED ||\n      this.state.authState === GDriveStates.LOADING\n    ) {\n      return Object.assign({}, buttonStyle, disabledStyle);\n    }\n\n    return buttonStyle;\n  };\n\n  #onClick = async () => {\n    if (this.state.authState === GDriveStates.SIGNED_IN) {\n      this.props.gdriveAuthClient.signOut();\n    } else if (this.state.authState === GDriveStates.SIGNED_OUT) {\n      this.props.gdriveAuthClient.signIn();\n    }\n  };\n\n  render() {\n    let alertElement = (() => {\n      if (this.state.authState === GDriveStates.FAILED) {\n        return (\n          <Alert severity=\"error\">\n            Failed connecting to google. Check your connection and try reloading\n            the page.\n          </Alert>\n        );\n      }\n\n      if (this.state.authState === GDriveStates.SIGNED_OUT) {\n        if (this.state.prevAuthState === GDriveStates.SIGNED_IN) {\n          return (\n            <Alert severity=\"warning\">\n              <AlertTitle>Privacy note!</AlertTitle>\n              If other people have access to this browser <br />\n              AND you don't want them to read your sheets: <br />\n              <ol>\n                <li>\n                  sign out globally: <br />\n                  <a href=\"https://accounts.google.com/Logout\">\n                    https://accounts.google.com/Logout\n                  </a>\n                </li>\n                <li>delete Google account password from the browser</li>\n              </ol>\n            </Alert>\n          );\n        } else if (this.state.prevAuthState === GDriveStates.LOADING) {\n          return (\n            <Alert severity=\"info\">\n              This site stores data in a hidden Google Drive folder. <br />\n              Sign in to proceed.\n              <br />\n            </Alert>\n          );\n        }\n      }\n    })();\n\n    return (\n      <button\n        ref={(ref) => this.#setButtonAnchor(ref)}\n        onClick={this.#onClick}\n        style={this.#getButtonStyle()}\n        type=\"button\"\n      >\n        <Icon key={0} active={this.state.active} />\n        <ButtonContent key={2}>\n          {this.state.authState === GDriveStates.SIGNED_IN\n            ? \"Sign Out\"\n            : \"Sign In \"}\n        </ButtonContent>\n\n        {!!alertElement && !!this.state.buttonAnchor && (\n          <Popper\n            key={1}\n            style={{ zIndex: 1200 }}\n            open={true}\n            anchorEl={this.state.buttonAnchor}\n            placement=\"bottom-end\"\n            disablePortal={false}\n            modifiers={{\n              flip: {\n                enabled: false,\n              },\n              preventOverflow: {\n                enabled: false,\n              },\n              hide: {\n                enabled: false,\n              },\n              offset: {\n                offset: \"0,5\",\n              },\n            }}\n          >\n            {alertElement}\n          </Popper>\n        )}\n      </button>\n    );\n  }\n}\n","import React from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\n\r\nlet useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    position: \"absolute\",\r\n    top: \"5%\",\r\n    left: \"5%\",\r\n    width: \"90%\",\r\n    height: \"90%\",\r\n    backgroundColor: theme.palette.background.paper,\r\n    zIndex: 1,\r\n  },\r\n}));\r\n\r\nexport const HelpWindow = React.forwardRef((props, ref) => {\r\n  let styles = useStyles();\r\n\r\n  return (\r\n    <article className={styles.root} {...props} ref={ref}>\r\n      <h1>User Guide</h1>\r\n    </article>\r\n  );\r\n});\r\n","import React, { Suspense } from \"react\";\n\nimport { ErrorBoundary } from \"react-error-boundary\";\nimport { Settings as SettingsIcon, Help as HelpIcon } from \"@material-ui/icons\";\nimport {\n  AppBar,\n  Collapse,\n  Hidden,\n  IconButton,\n  Modal,\n  Slide,\n  makeStyles,\n  Toolbar,\n  Typography,\n  Grid,\n} from \"@material-ui/core\";\n\nimport { gdriveAuthClient } from \"./GDriveAuthClient.js\";\nimport { GoogleSignInButton } from \"./GoogleSignInButton.js\";\nimport { HelpWindow } from \"./HelpWindow.js\";\nimport { CenteredTypography } from \"./CenteredTypography\";\nconst SettingsWindow = React.lazy(() => import(\"./SettingsWindow\"));\n\nconst useStyles = makeStyles((theme) => ({\n  buttonsContainer: {\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    alignItems: \"center\",\n  },\n\n  titleContainer: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n\n  modal: {\n    position: \"absolute\",\n    top: \"5%\",\n    left: \"5%\",\n    width: \"90%\",\n    height: \"90%\",\n    backgroundColor: theme.palette.background.default,\n    zIndex: 1000,\n    borderRadius: 4,\n    overflow: \"auto\",\n    padding: 10,\n    [theme.breakpoints.up(\"sm\")]: {\n      padding: 30,\n    },\n  },\n}));\n\nfunction ModalWindowButton(props) {\n  const [open, setOpen] = React.useState(false);\n  const styles = useStyles();\n  const onButtonClick = () => {\n    setOpen(true);\n  };\n\n  React.useEffect(() => {\n    if (props.model) props.model.setIgnoreKeys(open);\n  }, [open, props.model]);\n\n  const onWindowClose = () => {\n    if (props.model != null) {\n      props.model.setIgnoreKeys(false);\n    }\n\n    setOpen(false);\n  };\n\n  return (\n    <React.Fragment>\n      <IconButton {...props} onClick={onButtonClick}>\n        {props.children[0]}\n      </IconButton>\n      <Modal open={open} onClose={onWindowClose}>\n        <div className={styles.modal}>\n          {React.cloneElement(props.children[1], { onClose: onWindowClose })}\n        </div>\n      </Modal>\n    </React.Fragment>\n  );\n}\n\nexport function AppMenu(props) {\n  const classes = useStyles();\n  return (\n    <React.Fragment>\n      <Collapse appear={false} in={props.shown}>\n        <Toolbar />\n      </Collapse>\n      <Slide appear={false} direction=\"down\" in={props.shown}>\n        <AppBar>\n          <Toolbar>\n            <Grid container justify=\"space-between\">\n              <Hidden xsDown>\n                <Grid item xs={4}></Grid>\n              </Hidden>\n              <Grid item xs={4} className={classes.titleContainer}>\n                <Hidden xsDown>\n                  <Typography variant=\"h6\" align=\"center\">\n                    Self-help sheets\n                  </Typography>\n                  <Typography variant=\"caption\" align=\"center\">\n                    Document your inner dialog\n                  </Typography>\n                </Hidden>\n                <Hidden smUp>\n                  <Typography variant=\"h7\" align=\"center\">\n                    Self-help sheets\n                  </Typography>\n                </Hidden>\n              </Grid>\n              <Grid item className={classes.buttonsContainer} xs={8} sm={4}>\n                <ModalWindowButton>\n                  <HelpIcon />\n                  <HelpWindow></HelpWindow>\n                </ModalWindowButton>\n\n                <ModalWindowButton model={props.model} edge=\"start\">\n                  <SettingsIcon />\n\n                  <ErrorBoundary>\n                    <Suspense\n                      fallback={\n                        <CenteredTypography>Ladding...</CenteredTypography>\n                      }\n                    >\n                      <SettingsWindow model={props.model} />\n                    </Suspense>\n                  </ErrorBoundary>\n                </ModalWindowButton>\n\n                <GoogleSignInButton\n                  gdriveAuthClient={gdriveAuthClient}\n                ></GoogleSignInButton>\n              </Grid>\n            </Grid>\n          </Toolbar>\n        </AppBar>\n      </Slide>\n    </React.Fragment>\n  );\n}\n","// Material ui popper is too slow buggy and overcomplicated.\r\n// Do not expect much from this popup. It doesn't respect screen boundaries etc.\r\n\r\nimport React from \"react\";\r\nimport { Zoom, makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  outer: {\r\n    position: \"relative\",\r\n  },\r\n  popup: {\r\n    position: \"absolute\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"center\",\r\n    minWidth: 140,\r\n    zIndex: 2,\r\n    padding: 10,\r\n    background: theme.palette.background.paper,\r\n    border: \"gray solid 2px\",\r\n    borderRadius: 4,\r\n  },\r\n}));\r\n\r\nexport const Popup = React.forwardRef((props, ref) => {\r\n  const classes = useStyles();\r\n  return (\r\n    props.in && (\r\n      <div className={classes.outer}>\r\n        <Zoom in={props.in}>\r\n          <div ref={ref} className={classes.popup}>\r\n            {props.children}\r\n          </div>\r\n        </Zoom>\r\n      </div>\r\n    )\r\n  );\r\n});\r\n","import React from \"react\";\nimport { Typography, makeStyles, SvgIcon } from \"@material-ui/core\";\nimport { Popup } from \"./Popup\";\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    alignSelf: \"flex-start\",\n    margin: 2,\n    cursor: \"pointer\",\n    borderColor: (focused) => (focused ? \"gray\" : \"#0000\"),\n    border: \"solid 2px\",\n    borderRadius: 4,\n    position: \"relative\",\n    backgroundColor: theme.palette.background.paper,\n  },\n  setupItem: {\n    border: \"2px solid\",\n    borderColor: (isActive) => (isActive ? \"darkgray\" : \"#0000\"),\n    borderRadius: 4,\n    fontSize: 20,\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n\n  icon: {\n    cursor: \"pointer\",\n    width: 15,\n    margin: 0,\n    padding: \"4px 1px\",\n    height: \"30px\",\n    border: \"1px solid #0000\",\n\n    borderColor: (isSelected) => (isSelected ? \"gray\" : \"#0000\"),\n  },\n\n  emoji: {\n    userSelect: \"none\",\n    fontWeight: (value) => (value === 3 ? \"bold\" : \"unset\"),\n    opacity: (value) => (value === 3 ? 1 : value === 2 ? 0.7 : 0.3),\n  },\n}));\n\nfunction EmojiItem({ emoji, text, ...props }) {\n  const classes = useStyles(props.value);\n  return (\n    <span className={classes.emoji} role=\"img\" aria-label={text} {...props}>\n      {String.fromCodePoint(emoji)}\n    </span>\n  );\n}\n\nfunction RadioIcon({ selectedValue, value, ...props }) {\n  const classes = useStyles(selectedValue === value);\n\n  let height = 5 * (3 - value) + 1;\n  return (\n    <SvgIcon className={classes.icon} viewBox=\"1 1 7 15\" {...props}>\n      <rect\n        y={height}\n        width=\"9\"\n        height={16 - height}\n        fill={value <= selectedValue ? \"red\" : \"lightGray\"}\n      />\n    </SvgIcon>\n  );\n}\n\nfunction EmojiSetupItem({ value, isActive, ...props }) {\n  const classes = useStyles(isActive);\n  return (\n    <div className={classes.setupItem}>\n      <EmojiItem\n        {...props}\n        value={3}\n        onClick={() => props.onChange((value + 1) % 4)}\n      />\n      <RadioIcon\n        onClick={() => props.onChange(0)}\n        selectedValue={value}\n        value={0}\n      />\n      <RadioIcon\n        onClick={() => props.onChange(1)}\n        selectedValue={value}\n        value={1}\n      />\n      <RadioIcon\n        onClick={() => props.onChange(2)}\n        selectedValue={value}\n        value={2}\n      />\n      <RadioIcon\n        onClick={() => props.onChange(3)}\n        selectedValue={value}\n        value={3}\n      />\n    </div>\n  );\n}\n\nexport function EmojiPicker(props) {\n  const [focused, setFocus] = React.useState(false);\n  let [selectedRow, setSelectedRow] = React.useState(-1);\n\n  const popupRef = React.useRef();\n  const classes = useStyles(focused);\n\n  let onFocus = (event) => {\n    props.onFocus(event);\n    setFocus(true);\n  };\n\n  let onBlur = (event) => {\n    if (!popupRef.current.contains(document.activeElement)) {\n      setFocus(false);\n      props.onBlur(event);\n    }\n  };\n\n  let onKeyDown = (event) => {\n    if (event.key === \"ArrowLeft\") {\n      if (selectedRow < 0) setSelectedRow((selectedRow = 0));\n      if (selectedRow < props.emojiArray.length) {\n        let clone = [...props.emojiArray];\n        clone[selectedRow].value--;\n        if (clone[selectedRow].value < 0) {\n          clone[selectedRow].value = 3;\n        }\n        props.onEmojiArrayChange(clone);\n      }\n    } else if (event.key === \"ArrowRight\") {\n      if (selectedRow < 0) setSelectedRow((selectedRow = 0));\n      if (selectedRow < props.emojiArray.length) {\n        let clone = [...props.emojiArray];\n        clone[selectedRow].value++;\n        if (clone[selectedRow].value > 3) {\n          clone[selectedRow].value = 0;\n        }\n        props.onEmojiArrayChange(clone);\n      }\n    } else if (event.key === \"ArrowDown\") {\n      selectedRow++;\n      if (selectedRow >= props.emojiArray.length) {\n        selectedRow = 0;\n      }\n      setSelectedRow(selectedRow);\n    } else if (event.key === \"ArrowUp\") {\n      selectedRow--;\n      if (selectedRow < 0) {\n        selectedRow = props.emojiArray.length - 1;\n      }\n      setSelectedRow(selectedRow);\n    } else if (event.key === \"Escape\" || event.key === \"Enter\") {\n      props.inputRef.current.focus();\n    } else {\n      return;\n    }\n\n    event.preventDefault();\n  };\n\n  if (props.emojiArray.length === 0) return null;\n\n  let activeEmojiArray = props.emojiArray.filter((x) => x.value > 0);\n\n  let rowCounter = 0;\n\n  return (\n    <React.Fragment>\n      <div\n        tabIndex={0}\n        onFocus={onFocus}\n        onBlur={onBlur}\n        className={classes.container}\n        onKeyDown={onKeyDown}\n      >\n        {activeEmojiArray.length > 0 ? (\n          activeEmojiArray.map((x) => (\n            <EmojiItem\n              key={x.codePoint}\n              emoji={x.codePoint}\n              text={x.text}\n              value={x.value}\n            />\n          ))\n        ) : (\n          <Typography variant=\"caption\" color=\"textSecondary\">\n            add mood\n          </Typography>\n        )}\n        <Popup in={focused} ref={popupRef}>\n          <Typography align=\"center\" variant=\"body1\">\n            {props.text}\n          </Typography>\n          {props.emojiArray.map((x) => (\n            <EmojiSetupItem\n              key={x.codePoint}\n              isActive={rowCounter++ === selectedRow}\n              emoji={x.codePoint}\n              text={x.text}\n              value={x.value}\n              onChange={(value) => {\n                props.onEmojiArrayChange(\n                  props.emojiArray.map((y) =>\n                    y.codePoint === x.codePoint ? { ...y, value } : y\n                  )\n                );\n              }}\n            />\n          ))}\n\n          <Typography align=\"center\" variant=\"caption\">\n            Use arrow keys.\n          </Typography>\n        </Popup>{\" \"}\n      </div>\n    </React.Fragment>\n  );\n}\n","import React from \"react\";\nimport {\n  IconButton,\n  InputBase,\n  makeStyles,\n  Typography,\n  Collapse,\n  Hidden,\n} from \"@material-ui/core\";\nimport { Skeleton } from \"@material-ui/lab\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport moment from \"moment\";\nimport { EmojiPicker } from \"./EmojiPicker\";\nimport { Popup } from \"./Popup\";\n\nexport const EntryStatus = {\n  // The http request for the text of the entry has been sent.\n  LOADING: \"loading\",\n  // This entry has never been rendered because user never\n  // scrolled to its position.\n  HIDDEN: \"hidden\",\n  // User pressed DELETE button.\n  DELETED: \"deleted\",\n};\n\nconst LastChange = {\n  EDIT_LEFT: \"editLeft\",\n  EDIT_RIGHT: \"editRight\",\n  NONE: \"none\",\n};\n\n// EntryModel is immutable. setLeft setRight delete and clear return a new copy.\nexport class EntryModel {\n  isDataLoaded() {\n    return (\n      this._data !== EntryStatus.LOADING && this._data !== EntryStatus.HIDDEN\n    );\n  }\n\n  get data() {\n    if (this._data instanceof Object) return { ...this._data };\n    return this._data;\n  }\n\n  get key() {\n    return this._key;\n  }\n\n  get description() {\n    if (!this.isDataLoaded()) return \"\";\n    return this._description;\n  }\n  setDescription(description) {\n    const cloneModel = this.clone();\n    cloneModel._setDescriptionImpl(description);\n    return cloneModel;\n  }\n\n  get left() {\n    if (!this.isDataLoaded()) return \"\";\n    return this._data.left;\n  }\n  setLeft(left) {\n    if (!this.isDataLoaded()) {\n      console.error(\"bad status\");\n      return this;\n    }\n\n    const cloneModel = this.clone();\n    cloneModel._data = { ...this._data, left };\n    cloneModel.lastChange = LastChange.EDIT_LEFT;\n    return cloneModel;\n  }\n\n  get right() {\n    if (!this.isDataLoaded()) return \"\";\n    return this._data.right;\n  }\n  setRight(right) {\n    if (!this.isDataLoaded()) {\n      console.error(\"bad status\");\n      return this;\n    }\n\n    const cloneModel = this.clone();\n    cloneModel._data = { ...this._data, right };\n    cloneModel.lastChange = LastChange.EDIT_RIGHT;\n    return cloneModel;\n  }\n\n  get emojiArrays() {\n    return this._emojiArrays;\n  }\n\n  setEmojiLeft(left) {\n    let result = this.setDescription(\n      EntryModel._generateDescription(\n        left,\n        this._emojiArrays[1],\n        this._creationTime\n      )\n    );\n    result.lastChange = LastChange.EDIT_LEFT;\n    return result;\n  }\n\n  setEmojiRight(right) {\n    let result = this.setDescription(\n      EntryModel._generateDescription(\n        this._emojiArrays[0],\n        right,\n        this._creationTime\n      )\n    );\n    result.lastChange = LastChange.EDIT_RIGHT;\n    return result;\n  }\n\n  get creationTime() {\n    return this._creationTime;\n  }\n  setCreationTime(creationTime) {\n    return this.setDescription(\n      EntryModel._generateDescription(\n        this._emojiArrays[0],\n        this._emojiArrays[1],\n        creationTime\n      )\n    );\n  }\n\n  get initiallyCollapsed() {\n    return this._initiallyCollapsed;\n  }\n  setInitiallyCollapsed(collapsed) {\n    const cloneModel = this.clone();\n    cloneModel._initiallyCollapsed = collapsed;\n    return cloneModel;\n  }\n\n  get focused() {\n    return this._focused;\n  }\n  setFocused(focused) {\n    const cloneModel = this.clone();\n    cloneModel._focused = focused;\n    return cloneModel;\n  }\n\n  delete() {\n    return new EntryModel(this._key, EntryStatus.DELETED, EntryStatus.DELETED);\n  }\n\n  clear() {\n    return new EntryModel(this._key, { left: \"\", right: \"\" }, \"\");\n  }\n\n  show() {\n    if (this._data !== EntryStatus.HIDDEN)\n      throw new Error(\"show() has been called for entry that is not hidden\");\n    return new EntryModel(this._key, EntryStatus.LOADING, this._description);\n  }\n\n  clone() {\n    // this.data creates shallow copy of this._data\n    const cloneModel = new EntryModel(this._key, this.data);\n    cloneModel._emojiArrays = this._emojiArrays;\n    cloneModel._creationTime = this._creationTime;\n    cloneModel._description = this._description;\n    cloneModel._initiallyCollapsed = this._initiallyCollapsed;\n    cloneModel._focused = this._focused;\n    cloneModel.lastChange = this.lastChange;\n\n    return cloneModel;\n  }\n\n  constructor(key, data, description) {\n    this._data = data;\n    this._key = key;\n    this._initiallyCollapsed = false;\n    this._focused = false;\n    this.lastChange = LastChange.NONE;\n    this._setDescriptionImpl(description);\n  }\n\n  _data;\n  _description;\n  _key;\n\n  _initiallyCollapsed;\n  _focused;\n\n  // Cached values for performance. Got recomputed only when setDescription is called.\n  _emojiArrays;\n  _creationTime;\n\n  _setDescriptionImpl(description) {\n    this._emojiArrays = [[], []];\n    this._creationTime = null;\n    this._description = description;\n    if (\n      typeof description === \"string\" &&\n      description.length > 0 &&\n      description !== EntryStatus.DELETED\n    ) {\n      const [serializedEmoji, serializedCreationTime] = description.split(\"-\");\n\n      this._emojiArrays = serializedEmoji\n        .split(\":\")\n        .map((x) => Array.from(x).map((y) => Number(y)));\n      if (this._emojiArrays.length !== 2) this._emojiArrays.push([]);\n\n      this._creationTime = new Date(Number(serializedCreationTime));\n      if (isNaN(this._creationTime.getTime())) {\n        this._creationTime = null;\n      }\n    }\n  }\n\n  static _generateDescription(left, right, creationTime) {\n    let descrciption;\n    if (left.every((x) => x === 0) && right.every((x) => x === 0)) {\n      descrciption = \"\";\n    } else {\n      descrciption = left.join(\"\") + \":\" + right.join(\"\");\n    }\n\n    if (creationTime != null)\n      descrciption = descrciption + \"-\" + creationTime.getTime();\n    return descrciption;\n  }\n}\n\nconst paperStyle = (theme) => ({\n  border: \"solid\",\n  borderRadius: 4,\n  backgroundColor: theme.palette.background.paper,\n  padding: ({ focused }) => (focused ? 4 : 5),\n  borderWidth: ({ focused }) => {\n    return focused === true ? 2 : 1;\n  },\n  borderColor: ({ focused }) => {\n    return focused === true ? theme.palette.primary.light : \"gray\";\n  },\n});\n\nconst useStyles = makeStyles((theme) => ({\n  inner: {\n    display: \"flex\",\n    flex: 1,\n\n    flexDirection: \"column\",\n    position: \"relative\",\n    [theme.breakpoints.up(\"sm\")]: paperStyle(theme),\n  },\n  input: {\n    padding: 0,\n    marginTop: ({ hasCreationTime }) => (hasCreationTime ? 0 : 19),\n    minHeight: ({ hasEmoji }) => (hasEmoji ? 76 : 76 + 28),\n    alignItems: \"flex-start\",\n  },\n  outer: {\n    display: \"flex\",\n    alignItems: \"flex-start\",\n    flexDirection: \"row\",\n    [theme.breakpoints.down(\"xs\")]: paperStyle(theme),\n  },\n  date: {\n    border: \"0px !important\",\n  },\n  hint: {\n    backgroundColor: theme.palette.background.paper,\n    whiteSpace: \"pre-line\",\n  },\n}));\n\nfunction SubItem({\n  onFocus: onFocusOuter,\n  emojiText,\n  emojiArray,\n  onDelete,\n  creationTime,\n  onEmojiArrayChange,\n  onCollapseExited,\n  collapsed,\n  deleteXsDown,\n  deleteSmUp,\n  ...props\n}) {\n  const [focused, setFocused] = React.useState(false);\n  const [emojiFocused, setEmojiFocused] = React.useState(false);\n\n  React.useEffect(() => {\n    if (focused) {\n      onFocusOuter(null, true);\n    }\n  }, [focused, onFocusOuter]);\n\n  const classes = useStyles({\n    hasCreationTime: !!creationTime,\n    hasEmoji: emojiArray.length > 0,\n    focused: focused || emojiFocused,\n  });\n  const inputRef = React.useRef();\n\n  const onFocus = (event) => {\n    setFocused(true);\n    onFocusOuter(event);\n  };\n\n  const onBlur = (event) => {\n    setFocused(false);\n  };\n\n  const onEmojiFocused = (event) => {\n    onFocusOuter(event);\n    setEmojiFocused(true);\n  };\n  const onEmojiBlur = (event) => {\n    setEmojiFocused(false);\n  };\n\n  React.useEffect(() => {\n    if (!collapsed && props.autoFocus) {\n      inputRef.current.focus();\n    }\n  }, [collapsed, props.autoFocus]);\n\n  return (\n    <Collapse\n      in={!collapsed}\n      onExited={onCollapseExited}\n      onEntered={() => {\n        if (props.autoFocus) {\n          inputRef.current.focus();\n        }\n      }}\n    >\n      <div className={classes.outer}>\n        <div\n          className={classes.inner}\n          onClick={() => {\n            if (window.getSelection().toString().length === 0)\n              inputRef.current.focus();\n          }}\n        >\n          {creationTime && (\n            <Typography variant=\"caption\" color=\"textSecondary\" align=\"center\">\n              {moment(creationTime).format(\"h:mm a\")}\n            </Typography>\n          )}\n\n          <InputBase\n            className={classes.input}\n            fullWidth\n            multiline\n            placeholder={!!props.hint ? props.hint.text : \"\"}\n            variant=\"outlined\"\n            inputRef={inputRef}\n            onFocus={onFocus}\n            onBlur={onBlur}\n            {...props}\n          />\n          <EmojiPicker\n            text={emojiText}\n            onEmojiArrayChange={onEmojiArrayChange}\n            emojiArray={emojiArray}\n            inputRef={inputRef}\n            onFocus={onEmojiFocused}\n            onBlur={onEmojiBlur}\n          ></EmojiPicker>\n          {props.hint != null &&\n            props.hint.isEnabled &&\n            props.value.length > 0 && (\n              <Popup in={focused}>\n                <Typography\n                  className={classes.hint}\n                  color=\"textSecondary\"\n                  padding={10}\n                >\n                  {props.hint.text}\n                </Typography>\n              </Popup>\n            )}\n        </div>\n        <Hidden xsDown={!deleteXsDown} smUp={!deleteSmUp}>\n          <IconButton aria-label=\"delete\" size=\"small\" onClick={onDelete}>\n            <DeleteIcon color=\"action\" fontSize=\"small\"></DeleteIcon>\n          </IconButton>\n        </Hidden>\n      </div>\n    </Collapse>\n  );\n}\n\nexport const Entry = React.forwardRef(\n  (\n    {\n      onFocus: onFocusOuter,\n      onUpdate,\n      onRightChanged,\n      entry,\n      settings,\n      ...otherProps\n    },\n    ref\n  ) => {\n    const classes = useStyles();\n\n    const initiallyCollapsed = !!entry.text || entry.initiallyCollapsed;\n    const [collapsed, setCollapsed] = React.useState(initiallyCollapsed);\n    React.useEffect(() => {\n      if (initiallyCollapsed) {\n        setCollapsed(false);\n      }\n    }, [initiallyCollapsed]);\n\n    if (!!entry.text) {\n      return (\n        <tr ref={ref} className={classes.date}>\n          <td colSpan={2}>\n            <Collapse in={!collapsed}>\n              <Typography variant=\"body2\" align=\"center\" color=\"textSecondary\">\n                {entry.text}\n              </Typography>\n            </Collapse>\n          </td>\n        </tr>\n      );\n    }\n\n    console.assert(entry instanceof EntryModel);\n\n    React.useEffect(() => {\n      if (entry.initiallyCollapsed) {\n        onUpdate(entry.setInitiallyCollapsed(false), true);\n      }\n    }, [entry, onUpdate]);\n\n    React.useEffect(() => {\n      if (entry.data === EntryStatus.HIDDEN) onUpdate(entry.show(), true);\n    });\n\n    let emojiLeft = [];\n    let emojiRight = [];\n\n    if (settings != null) {\n      for (let i = 0; i < settings.emojiList.length; i++) {\n        emojiLeft.push({\n          value: entry.emojiArrays[0][i] == null ? 0 : entry.emojiArrays[0][i],\n          ...settings.emojiList[i],\n        });\n        emojiRight.push({\n          value: entry.emojiArrays[1][i] == null ? 0 : entry.emojiArrays[1][i],\n          ...settings.emojiList[i],\n        });\n      }\n    }\n\n    const onEntryChanged = (updatedEntry) => {\n      onUpdate(updatedEntry);\n    };\n\n    const onFocus = (event, alreadyFocused) => {\n      if (entry.focused) onUpdate(entry.setFocused(false), true);\n      if (!alreadyFocused) onFocusOuter(event);\n    };\n\n    return (\n      <tr ref={ref}>\n        <td key=\"issueElement\">\n          {entry.isDataLoaded() ? (\n            <SubItem\n              autoFocus={\n                entry.focused && entry.lastChange !== LastChange.EDIT_RIGHT\n              }\n              color=\"secondary\"\n              creationTime={entry.creationTime}\n              value={entry.left}\n              onChange={(event) =>\n                onEntryChanged(entry.setLeft(event.target.value))\n              }\n              onFocus={onFocus}\n              onDelete={() => {\n                setCollapsed(true);\n              }}\n              deleteXsDown\n              collapsed={collapsed}\n              hint={settings == null ? null : settings.leftHint}\n              emojiText=\"How do you feel now?\"\n              emojiArray={emojiLeft}\n              onEmojiArrayChange={(newLeftEmojiArray) =>\n                onEntryChanged(\n                  entry.setEmojiLeft(newLeftEmojiArray.map((x) => x.value))\n                )\n              }\n              {...otherProps}\n            ></SubItem>\n          ) : (\n            <Skeleton variant=\"rect\" height={135}></Skeleton>\n          )}\n        </td>\n\n        <td key=\"resolutionElement\">\n          {entry.isDataLoaded() ? (\n            <SubItem\n              autoFocus={\n                entry.focused && entry.lastChange === LastChange.EDIT_RIGHT\n              }\n              color=\"primary\"\n              variant=\"outlined\"\n              value={entry.right}\n              onChange={(event) =>\n                onEntryChanged(entry.setRight(event.target.value))\n              }\n              onFocus={onFocus}\n              deleteSmUp\n              onDelete={() => {\n                setCollapsed(true);\n              }}\n              collapsed={collapsed}\n              onCollapseExited={(event) => onUpdate(entry.delete())}\n              hint={settings == null ? null : settings.rightHint}\n              emojiText=\"How do you feel after writing resolution?\"\n              emojiArray={emojiRight}\n              onEmojiArrayChange={(newRightEmojiArray) =>\n                onEntryChanged(\n                  entry.setEmojiRight(newRightEmojiArray.map((x) => x.value))\n                )\n              }\n              {...otherProps}\n            />\n          ) : (\n            <Skeleton variant=\"rect\" height={135}></Skeleton>\n          )}\n        </td>\n      </tr>\n    );\n  }\n);\n","import React from \"react\";\n\nclass VirtualizedItem extends React.PureComponent {\n  ref = React.createRef();\n\n  #onHeightChanged = () => {\n    if (!!this.ref.current) {\n      this.props.onHeightChanged(\n        this.props.entry,\n        this.ref.current.offsetHeight\n      );\n    }\n  };\n\n  #resizeObserver = null;\n\n  componentDidMount() {\n    if (!!this.ref.current) {\n      this.#resizeObserver = new ResizeObserver(this.#onHeightChanged);\n      this.#resizeObserver.observe(this.ref.current);\n    }\n  }\n\n  componentWillUnmount() {\n    if (\n      this.ref.current.contains(document.activeElement) &&\n      !!this.props.scrollableContainerRef.current\n    ) {\n      this.props.scrollableContainerRef.current.focus();\n    }\n\n    if (!!this.#resizeObserver) {\n      this.#resizeObserver.disconnect();\n      this.#resizeObserver = null;\n    }\n  }\n\n  render() {\n    const {\n      scrollableContainerRef,\n      ItemComponent,\n      onHeightChanged,\n      ...otherProps\n    } = this.props;\n\n    return <ItemComponent ref={this.ref} {...otherProps} />;\n  }\n}\n\nexport function VirtualizedList({\n  entries,\n  defaultHeight = 150,\n  scrollableContainerRef,\n  ItemComponent,\n  PlaceholderComponent,\n  ...restProps\n}) {\n  const [scrollY, setScrollY] = React.useState(0);\n  const [windowHeight, setWindowHeight] = React.useState(window.innerHeight);\n\n  const [realHeightsMap, setRealHeightsMap] = React.useState(new Map());\n  // Beware of maintainig VirtualizedItem pureness during refactoring.\n  // If one entry has changed it shouldn't lead to render() calls for other\n  // entries.\n  const onHeightChanged = React.useCallback((entry, height) => {\n    setRealHeightsMap((oldMap) => {\n      let newMap = new Map(oldMap);\n\n      newMap.set(entry.key, height);\n      return newMap;\n    });\n  }, []);\n\n  const keys = new Set(entries.map((x) => x.key));\n  const keysToDelete = [];\n  realHeightsMap.forEach((_value, key) => {\n    if (!keys.has(key)) {\n      keysToDelete.push(key);\n    }\n  });\n  if (keysToDelete.length > 0) {\n    setRealHeightsMap((oldMap) => {\n      let newMap = new Map(oldMap);\n      keysToDelete.forEach((key) => {\n        if (oldMap.has(key)) newMap.delete(key);\n      });\n      return newMap;\n    });\n  }\n\n  const onResizeOrScroll = () => {\n    if (!!scrollableContainerRef.current)\n      setScrollY(scrollableContainerRef.current.scrollTop);\n    setWindowHeight(window.innerHeight);\n  };\n\n  React.useEffect(() => {\n    if (!!scrollableContainerRef.current)\n      scrollableContainerRef.current.onscroll = onResizeOrScroll;\n    window.addEventListener(\"resize\", onResizeOrScroll);\n    return () => {\n      window.removeEventListener(\"resize\", onResizeOrScroll);\n    };\n  });\n\n  let visibleEntries = [];\n  let currentHeight = 0;\n  let placeholderTop = 0;\n  let placeholderBottom = 0;\n\n  for (let entry of entries) {\n    let entryHeight = defaultHeight;\n    if (realHeightsMap.has(entry.key)) {\n      entryHeight = realHeightsMap.get(entry.key);\n    }\n\n    if (currentHeight + entryHeight < scrollY - window.innerHeight) {\n      if (entry.focused && !!scrollableContainerRef.current) {\n        scrollableContainerRef.current.scrollTop = currentHeight;\n      }\n\n      placeholderTop += entryHeight;\n    } else if (currentHeight < scrollY + 2 * windowHeight) {\n      visibleEntries.push(\n        <VirtualizedItem\n          key={entry.key}\n          onHeightChanged={onHeightChanged}\n          entry={entry}\n          ItemComponent={ItemComponent}\n          scrollableContainerRef={scrollableContainerRef}\n          {...restProps}\n        />\n      );\n    } else {\n      if (entry.focused && !!scrollableContainerRef.current) {\n        scrollableContainerRef.current.scrollTop = currentHeight;\n      }\n\n      placeholderBottom += entryHeight;\n    }\n    currentHeight += entryHeight;\n  }\n  if (placeholderTop !== 0) {\n    visibleEntries.unshift(\n      <PlaceholderComponent height={placeholderTop} key=\"placeholderTop\" />\n    );\n  }\n\n  if (placeholderBottom !== 0) {\n    visibleEntries.push(\n      <PlaceholderComponent\n        height={placeholderBottom}\n        key=\"placeholderBottom\"\n      />\n    );\n  }\n\n  return visibleEntries;\n}\n","import React from \"react\";\nimport { Entry } from \"./Entry.js\";\nimport ColumnResizer from \"column-resizer\";\nimport _ from \"lodash\";\nimport moment from \"moment\";\n\nimport { withStyles, Button, IconButton, Grid } from \"@material-ui/core\";\n\nimport { VirtualizedList } from \"./VirtualizedList\";\n\nimport { ArrowDropDown as ArrowIcon } from \"@material-ui/icons\";\n\nconst styles = (theme) => ({\n  container: {\n    overflow: \"auto\",\n    flex: 1,\n    willChange: \"transform\",\n  },\n  grip: {\n    \"&:hover\": {\n      backgroundColor: \"#00F8\",\n      transitionDuration: \"0s\",\n    },\n    width: 8,\n    zIndex: 10,\n    position: \"absolute\",\n    height: \"100%\",\n    backgroundColor: \"#0000\",\n    cursor: \"col-resize\",\n    transitionProperty: \"background-color\",\n    transitionDuration: \"1s\",\n  },\n  entriesTable: {\n    width: \"100%\",\n    borderSpacing: 0,\n    \"& th\": {\n      backgroundColor: theme.palette.background.paper,\n      zIndex: 3,\n      top: 0,\n      position: \"sticky\",\n      borderSpacing: 0,\n      borderBottom: \"1px solid lightGray\",\n    },\n    \"& td\": {\n      padding: 2,\n      verticalAlign: \"top\",\n      borderLeft: \"5px solid #0000\",\n      // ColumnResizer sets it to \"hidden\". This cuts emoji popups.\n      overflow: \"inherit !important\",\n    },\n    \"& td:nth-child(odd)\": {\n      borderRight: \"5px solid #0000\",\n      borderLeft: \"20px solid #0000\",\n    },\n\n    [theme.breakpoints.down(\"xs\")]: {\n      \"& thead\": {\n        display: \"none\",\n      },\n\n      \"& tbody tr\": {\n        display: \"grid\",\n        padding: 5,\n        borderRadius: 4,\n        border: \"1px solid #000\",\n      },\n\n      \"& td:nth-child(odd)\": {\n        borderRight: 0,\n        borderLeft: 0,\n      },\n\n      \"& tbody td\": {\n        display: \"block\",\n        borderLeft: 0,\n      },\n    },\n  },\n\n  buttonsContainer: {\n    backgroundColor: theme.palette.background.paper,\n  },\n\n  buttons: {\n    display: \"flex\",\n    justifyContent: \"center\",\n  },\n});\n\nfunction Placeholder({ height, ...rest }) {\n  return (\n    <tr {...rest}>\n      <td colSpan=\"2\">\n        <div style={{ height }} />\n      </td>\n    </tr>\n  );\n}\n\nclass EntriesTableRaw extends React.PureComponent {\n  state = {\n    entries: [],\n  };\n\n  _onEntriesChanged = (entries, settings, { canRedo, canUndo }) => {\n    if (entries.length > 0) {\n      function DateEntry(date) {\n        this.key = this.text = moment(date).calendar({\n          sameDay: \"[Today], MMM Do, ddd\",\n          lastDay: \"[Yesterday] , MMM Do, ddd\",\n          lastWeek: \"MMM Do YYYY, ddd\",\n          sameElse: \"MMM Do YYYY, ddd\",\n        });\n      }\n      entries = [...entries];\n      let dateToInsert = entries[entries.length - 1].creationTime;\n      for (let i = entries.length - 2; i >= 0; i--) {\n        let currentCreationTime = entries[i].creationTime;\n\n        if (dateToInsert == null) {\n          dateToInsert = currentCreationTime;\n          continue;\n        }\n\n        if (\n          currentCreationTime == null ||\n          currentCreationTime.getTime() < dateToInsert.getTime()\n        )\n          continue;\n\n        if (\n          currentCreationTime != null &&\n          currentCreationTime.getYear() === dateToInsert.getYear() &&\n          currentCreationTime.getMonth() === dateToInsert.getMonth() &&\n          currentCreationTime.getDay() === dateToInsert.getDay()\n        ) {\n          continue;\n        }\n\n        entries.splice(i + 1, 0, new DateEntry(dateToInsert));\n        dateToInsert = currentCreationTime;\n      }\n\n      if (dateToInsert != null) {\n        entries.splice(0, 0, new DateEntry(dateToInsert));\n      }\n    }\n\n    this.setState({ entries, settings, canRedo, canUndo });\n  };\n\n  _tableRef = React.createRef();\n  _scrollableContainerRef = React.createRef();\n  _columnResizer = null;\n  _resizeObserver = null;\n\n  componentDidMount() {\n    this.props.model.subscribe(this._onEntriesChanged);\n\n    this._columnResizer = new ColumnResizer(this._tableRef.current, {\n      liveDrag: true,\n      minWidth: 100,\n      gripInnerHtml: `<div class='${this.props.classes.grip}'></div>`,\n      onResize: (e) => {\n        // TextArea adjusts its height only when the browser window\n        // resizes. It ignores resize of its parent.\n        // This logic is encapsulated badly, you cannot change\n        // it without modifying library sources.\n        //\n        // So, the esiest way of forcing TextArea height adjustment is\n        // to dispatch a window resize event hoping that it\n        // won't break anything.\n        window.dispatchEvent(new Event(\"resize\"));\n      },\n    });\n\n    // this._columnResizer doesn't observe resizes of the table.\n    // It listens for browser window \"resize\" events instead.\n    // This doesn't play well when table content asynchronously adjusts\n    // its height listening for the same \"resize\" event.\n    window.removeEventListener(\"resize\", this._columnResizer.onResize);\n    this._resizeObserver = new ResizeObserver(\n      _.throttle(() => {\n        this._columnResizer.onResize();\n      }, 200)\n    );\n    this._resizeObserver.observe(this._tableRef.current);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.model !== prevProps.model) {\n      prevProps.model.unsubscribe(this._onEntriesChanged);\n      this.props.model.subscribe(this._onEntriesChanged);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.model.unsubscribe(this._onEntriesChanged);\n\n    this._columnResizer.destroy();\n    this._resizeObserver.unobserve(this._tableRef.current);\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        <Grid\n          className={this.props.classes.buttonsContainer}\n          container\n          justify=\"space-between\"\n          spacing={0}\n        >\n          <Grid item xs={1} sm={2}>\n            {!this.props.appBarShown && (\n              <IconButton size=\"small\" onClick={this.props.onShowAppBar}>\n                <ArrowIcon color=\"primary\" />\n              </IconButton>\n            )}\n          </Grid>\n          <Grid className={this.props.classes.buttons} item xs={6} sm={3}>\n            <Button\n              size=\"small\"\n              onClick={() => {\n                this.props.model.addNewItemThrottled();\n              }}\n            >\n              Add new item\n            </Button>\n          </Grid>\n          <Grid className={this.props.classes.buttons} item xs={5} sm={2}>\n            <Button\n              fullWidth\n              size=\"small\"\n              fontSize=\"small\"\n              onClick={this.props.model.undo}\n              disabled={!this.state.canUndo}\n            >\n              Undo\n            </Button>\n            <Button\n              fullWidth\n              size=\"small\"\n              fontSize=\"small\"\n              disabled={!this.state.canRedo}\n              onClick={this.props.model.redo}\n            >\n              Redo\n            </Button>\n          </Grid>\n        </Grid>\n\n        <div\n          ref={this._scrollableContainerRef}\n          className={this.props.classes.container}\n          tabIndex={0}\n        >\n          <table\n            cellPadding={0}\n            cellSpacing={0}\n            className={this.props.classes.entriesTable}\n            ref={this._tableRef}\n          >\n            {/* ColumnResizer doesn't work without thead */}\n            <thead>\n              <tr>\n                <th></th>\n                <th></th>\n              </tr>\n            </thead>\n\n            <tbody>\n              <VirtualizedList\n                entries={this.state.entries}\n                ItemComponent={Entry}\n                PlaceholderComponent={Placeholder}\n                scrollableContainerRef={this._scrollableContainerRef}\n                // Additional props for Entry\n                onUpdate={this.props.model.onUpdate}\n                onFocus={this.props.onFocus}\n                settings={this.state.settings}\n              />\n            </tbody>\n          </table>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\nexport const EntriesTable = withStyles(styles)(EntriesTableRaw);\n","import React from \"react\";\r\nimport { EntriesTable } from \"./EntriesTable.js\";\r\nimport { gdriveAuthClient, GDriveStates } from \"./GDriveAuthClient\";\r\nimport { CenteredTypography } from \"./CenteredTypography\";\r\nimport { Backdrop, CircularProgress } from \"@material-ui/core\";\r\n\r\nexport function AppContent({ model, ...props }) {\r\n  const [signInState, setSignInState] = React.useState(gdriveAuthClient.state);\r\n  React.useEffect(() => {\r\n    gdriveAuthClient.addStateListener(setSignInState);\r\n  }, []);\r\n\r\n  if (signInState === GDriveStates.SIGNED_IN && !!model) {\r\n    return <EntriesTable {...props} model={model} />;\r\n  } else if (signInState === GDriveStates.SIGNED_OUT) {\r\n    return <CenteredTypography>Sign in to proceed...</CenteredTypography>;\r\n  } else {\r\n    return (\r\n      <React.Fragment>\r\n        <Backdrop invisible open={true}>\r\n          <CircularProgress color=\"inherit\" />\r\n        </Backdrop>\r\n        ;<CenteredTypography> Loading...</CenteredTypography>{\" \"}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n","export class Interface {\n  requireFunction(name, ...args) {\n    setTimeout(() => {\n      if (typeof this[name] !== \"function\")\n        throw new Error(name + \" is not implemented\");\n    }, 0);\n  }\n}\n","import { Interface } from \"./Interface.js\";\n\nexport class BackendMap extends Interface {\n  constructor() {\n    super();\n    this.requireFunction(\"createKey\");\n    this.requireFunction(\"delete\", \"key\");\n    this.requireFunction(\"set\", \"key\", \"contentString\");\n    this.requireFunction(\"get\", \"key\");\n    this.requireFunction(\"getMd5\", \"key\");\n    this.requireFunction(\"getAllKeys\");\n    this.requireFunction(\"getSettings\");\n    this.requireFunction(\"setSettings\", \"settings\");\n    this.requireFunction(\"setDescription\", \"key\", \"description\");\n  }\n}\n","import { gdriveAuthClient, GDriveStates } from \"./GDriveAuthClient.js\";\nimport { BackendMap } from \"./BackendMap.js\";\n\nclass GDriveMap extends BackendMap {\n  #settings_key = null;\n  async _getSettingsKey() {\n    if (this.#settings_key !== null) {\n      return this.#settings_key;\n    }\n\n    let keys = await find('name = \"settings.json\"');\n    if (keys.length === 0) {\n      return await createEmptyFile(\"settings.json\");\n    }\n    if (keys.length === 1) {\n      return keys[0].id;\n    }\n\n    console.error(\"Invalid state. Multiple settings.json. \");\n    let [firstKey, ...restKeys] = keys;\n\n    restKeys.map((x) => deleteFile(x.id));\n\n    return firstKey.id;\n  }\n\n  async createKey() {\n    throwIfNotSignedIn();\n    return await createEmptyFile(\"item.json\");\n  }\n\n  async delete(key) {\n    throwIfNotSignedIn();\n    return await deleteFile(key);\n  }\n\n  async set(key, value) {\n    throwIfNotSignedIn();\n    return await upload(key, value);\n  }\n\n  async get(key) {\n    throwIfNotSignedIn();\n    let result = await download(key);\n    return result;\n  }\n\n  async getMd5(key) {\n    throwIfNotSignedIn();\n    return await getMd5(key);\n  }\n\n  async getAllKeys() {\n    throwIfNotSignedIn();\n    let result = await find('name = \"item.json\"');\n    result.forEach((element) => {\n      if (!element.description) element.description = \"\";\n    });\n    return result;\n  }\n\n  async getSettings() {\n    throwIfNotSignedIn();\n    return await download(await this._getSettingsKey());\n  }\n\n  async setSettings(settingsContent) {\n    throwIfNotSignedIn();\n    await upload(await this._getSettingsKey(), settingsContent);\n  }\n\n  async setDescription(key, description) {\n    throwIfNotSignedIn();\n    return patchDescription(key, description);\n  }\n}\n\nexport const gdriveMap = new GDriveMap();\nObject.seal(gdriveMap);\n\n// PRIVATE SECTION\n// Borrowed from here: https://habr.com/ru/post/440844/\n\nfunction throwIfNotSignedIn() {\n  if (gdriveAuthClient.state !== GDriveStates.SIGNED_IN)\n    throw new Error(\"Incorrect state. Sign in to continue.\");\n}\n\nfunction prom(gapiCall, argObj) {\n  let stack = new Error().stack;\n  return new Promise((resolve, reject) => {\n    gapiCall(argObj).then(\n      (resp) => {\n        if (resp && (resp.status < 200 || resp.status > 299)) {\n          console.log(\"GAPI call returned bad status\", stack, resp);\n          reject(resp);\n        } else {\n          resolve(resp);\n        }\n      },\n      (err) => {\n        console.log(\"GAPI call failed \", stack, err);\n        reject(err);\n      }\n    );\n  });\n}\n\n// returns fileId\nasync function createEmptyFile(name, mimeType) {\n  const resp = await prom(window.gapi.client.drive.files.create, {\n    resource: {\n      name: name,\n      mimeType: mimeType || \"text/plain\",\n      parents: [\"appDataFolder\"],\n    },\n    fields: \"id\",\n  });\n  return resp.result.id;\n}\n\nasync function patchDescription(fileId, description) {\n  console.assert(typeof description === \"string\");\n\n  const boundary = \"-------314159265358979323846\";\n  const delimiter = \"\\r\\n--\" + boundary + \"\\r\\n\";\n  const close_delim = \"\\r\\n--\" + boundary + \"--\";\n\n  let multipartRequestBody =\n    delimiter +\n    \"Content-Type: application/json\\r\\n\\r\\n\" +\n    JSON.stringify({ description }) +\n    close_delim;\n\n  await prom(window.gapi.client.request, {\n    path: `/upload/drive/v3/files/${fileId}`,\n    method: \"PATCH\",\n    params: { uploadType: \"multipart\" },\n    body: multipartRequestBody,\n    headers: {\n      \"Content-Type\": 'multipart/mixed; boundary=\"' + boundary + '\"',\n    },\n  });\n}\n\nasync function upload(fileId, content) {\n  console.assert(typeof content === \"string\");\n  await prom(window.gapi.client.request, {\n    path: `/upload/drive/v3/files/${fileId}`,\n    method: \"PATCH\",\n    params: { uploadType: \"media\" },\n    fields: \"md5Checksum\",\n    body: content,\n  });\n}\n\nasync function getMd5(fileId) {\n  let result = await prom(window.gapi.client.request, {\n    path: `/drive/v3/files/${fileId}`,\n    method: \"GET\",\n    params: { fields: \"md5Checksum\" },\n  });\n\n  return result.result.md5Checksum;\n}\n\nasync function download(fileId) {\n  try {\n    const resp = await prom(window.gapi.client.drive.files.get, {\n      fileId: fileId,\n      alt: \"media\",\n    });\n\n    return resp.body;\n  } catch (e) {\n    if (e.status !== 404) throw e;\n    return undefined;\n  }\n}\n\n// returns file ids sorted by creation time\nasync function find(query) {\n  try {\n    let ret = [];\n    let token;\n    do {\n      const resp = await prom(window.gapi.client.drive.files.list, {\n        spaces: \"appDataFolder\",\n        fields: \"files(id, description, md5Checksum), nextPageToken\",\n        pageSize: 1000,\n        pageToken: token,\n        orderBy: \"createdTime\",\n        q: query,\n      });\n      ret = ret.concat(resp.result.files);\n      token = resp.result.nextPageToken;\n    } while (token);\n    return ret;\n  } catch {\n    return [];\n  }\n}\n\nasync function deleteFile(fileId) {\n  try {\n    await prom(window.gapi.client.drive.files.delete, {\n      fileId: fileId,\n    });\n    return true;\n  } catch (err) {\n    if (err.status === 404) {\n      return false;\n    }\n    throw err;\n  }\n}\n","import { Interface } from \"./Interface.js\";\nimport { BackendMap } from \"./BackendMap\";\nimport { GDriveStates } from \"./GDriveAuthClient\";\nimport { Settings } from \"./Settings\";\nimport { EntryStatus, EntryModel } from \"./Entry\";\nimport _ from \"lodash\";\nimport { Mutex } from \"async-mutex\";\n\nexport class EntriesTableModel extends Interface {\n  constructor() {\n    super();\n    this.requireFunction(\"subscribe\", \"callback\");\n    this.requireFunction(\"unsubscribe\", \"callback\");\n    this.requireFunction(\"onUpdate\", \"entry\", \"omitHistory\");\n    this.requireFunction(\"onSettingsUpdate\", \"settings\");\n    this.requireFunction(\"setIgnoreKeys\", \"ignoreKeys\");\n\n    this.requireFunction(\"addNewItem\");\n\n    this.requireFunction(\"undo\");\n    this.requireFunction(\"redo\");\n\n    this.requireFunction(\"sync\");\n  }\n}\n\nexport class EntriesTableModelImpl extends EntriesTableModel {\n  constructor(backendMap, authClient) {\n    console.assert(backendMap instanceof BackendMap);\n    super();\n    this._backendMap = backendMap;\n    this._authClient = authClient;\n    this._syncLoop();\n    window.addEventListener(\"keydown\", this._onKeyPress);\n  }\n\n  dispose() {\n    this._disposed = true;\n    window.removeEventListener(\"keydown\", this._onKeyPress);\n    this._subscriptions = new Set();\n  }\n\n  subscribe(callback) {\n    this._subscriptions.add(callback);\n    if (this._entries.size > 0)\n      callback(this._getFilteredEntriesArray(), this._settings);\n  }\n\n  unsubscribe(callback) {\n    this._subscriptions.delete(callback);\n  }\n\n  addNewItemThrottled = _.throttle(() => {\n    this.addNewItem();\n  }, 500);\n\n  addNewItem = async (omitHistory = false) => {\n    let release = await this._addNewItemMutex.acquire();\n\n    const entry = this._tryFindVacantEntry() || (await this._createNewEntry());\n\n    this.onUpdate(\n      entry\n        .clear()\n        .setFocused(true)\n        .setInitiallyCollapsed(true)\n        .setCreationTime(new Date(Date.now())),\n      omitHistory\n    );\n\n    release();\n  };\n\n  // If user deletes entries from top of the table than keys assigned to these\n  // entries can be reused.\n  // This function returns such entry if it exists.\n  _tryFindVacantEntry() {\n    let lastVacantEntry = null;\n    this._entries.forEach((entry) => {\n      if (entry.data === EntryStatus.DELETED) {\n        if (lastVacantEntry == null) lastVacantEntry = entry;\n      } else {\n        lastVacantEntry = null;\n      }\n    });\n\n    return lastVacantEntry;\n  }\n\n  // If there is no deleted entry to reuse the only option is creating a new one.\n  async _createNewEntry() {\n    if (this._entries.has(null)) {\n      return;\n    }\n    this._entries.set(null, new EntryModel(null).delete());\n\n    let newKey = await this._backendMap.createKey();\n\n    if (!this._entries.has(null)) {\n      throw new Error(\"A null key should persist until the new key is created\");\n    }\n\n    let newEntry = new EntryModel(newKey, this._entries.get(null).data, \"\");\n    this._entries.set(newKey, newEntry);\n    await this._sendEntryToBackend(newEntry);\n\n    this._entries.delete(null);\n\n    return newEntry;\n  }\n\n  undo = () => {\n    if (this._historyIndex === 0) return;\n\n    this._historyIndex--;\n\n    let entry = this._history[this._historyIndex].old;\n    if (entry.data !== EntryStatus.DELETED) {\n      entry = entry.setFocused(true);\n      if (this._history[this._historyIndex].new.data === EntryStatus.DELETED) {\n        entry = entry.setInitiallyCollapsed(true);\n      }\n    }\n\n    this._entries.set(entry.key, entry);\n    this._sendEntryToBackend(entry);\n    this._onEntriesChanged();\n  };\n\n  redo = () => {\n    if (this._historyIndex >= this._history.length) return;\n\n    let historyItem = this._history[this._historyIndex++];\n    let entry = historyItem.new;\n    if (entry.data !== EntryStatus.DELETED) {\n      entry = entry.setFocused(true);\n      if (historyItem.old.data === EntryStatus.DELETED) {\n        entry = entry.setInitiallyCollapsed(true);\n      }\n    }\n\n    this._entries.set(entry.key, entry);\n    this._sendEntryToBackend(entry);\n    this._onEntriesChanged();\n  };\n\n  sync = async () => {\n    if (this._disposed) return;\n\n    while (this._authClient.state !== GDriveStates.SIGNED_IN) {\n      await this._authClient.waitForStateChange();\n    }\n\n    let keys = await this._backendMap.getAllKeys();\n\n    let newEntries = new Map();\n\n    keys.forEach((x) => {\n      let entry;\n      if (this._entries.has(x.id)) {\n        entry = this._entries.get(x.id);\n      } else if (x.description === EntryStatus.DELETED) {\n        x.outdated = false;\n        entry = new EntryModel(x.id).delete();\n      } else {\n        x.outdated = true;\n        entry = new EntryModel(\n          x.id,\n          newEntries.size < keys.length - 30\n            ? EntryStatus.HIDDEN\n            : EntryStatus.LOADING,\n          x.description\n        );\n        this._descriptions.set(x.id, x.description);\n      }\n\n      if (x.description !== this._descriptions.get(x.id)) {\n        entry = entry.setDescription(x.description);\n        this._descriptions.set(x.id, x.description);\n      }\n      newEntries.set(x.id, entry);\n    });\n\n    let promises = [];\n    if (this._settings == null) promises.push(this._fetchSettings());\n\n    keys.reverse().forEach((x) => {\n      if (x.outdated && newEntries.get(x.id).data !== EntryStatus.HIDDEN) {\n        promises.push(this._fetch(x.id));\n      }\n    });\n\n    if (this._entries.has(null)) {\n      newEntries.set(null, this._entries.get(null));\n    }\n\n    this._entries = newEntries;\n\n    if (this._entries.size === 0) {\n      await this.addNewItem(true);\n      return;\n    }\n\n    this._onEntriesChanged();\n\n    await Promise.all(promises);\n  };\n\n  onSettingsUpdate = _.debounce((settings) => {\n    this._settings = settings;\n    this._onEntriesChanged();\n    this._backendMap.setSettings(settings.stringify());\n  }, 1000);\n\n  onUpdate = (entry, omitHistory = false) => {\n    if (!this._entries.has(entry.key)) return;\n\n    let prevEntry = this._entries.get(entry.key);\n\n    if (entry.data === EntryStatus.LOADING) {\n      if (prevEntry.data === EntryStatus.HIDDEN) {\n        this._fetch(entry.key);\n        this._entries.set(entry.key, entry);\n      }\n      return;\n    }\n\n    this._sendEntryToBackend(entry);\n    if (!omitHistory) this._addHistoryItem(entry);\n    this._entries.set(entry.key, entry);\n\n    this._onEntriesChanged();\n  };\n\n  setIgnoreKeys(ignoreKeys) {\n    this._ignoreKeys = ignoreKeys;\n  }\n\n  _disposed = false;\n  _historyIndex = 0;\n  _history = [];\n  _authClient = null;\n  _backendMap = null;\n  _addNewItemMutex = new Mutex();\n\n  // |_entries| is in reverse order.\n  // It is natural for |Map| to add new items to the end, but\n  // in |EntriesTable| new items belong to the top.\n  _entries = new Map();\n  _settings = null;\n  _descriptions = new Map();\n  _subscriptions = new Set();\n\n  _syncLoop = async () => {\n    await this.sync();\n    setTimeout(this._syncLoop, 15000);\n  };\n\n  _onKeyPress = (e) => {\n    if (this._ignoreKeys) return;\n    if (e.ctrlKey) {\n      if (e.keyCode === 90) {\n        // Z\n        this.undo();\n      } else if (e.keyCode === 89) {\n        // Y\n        this.redo();\n      } else if (e.keyCode === 13) {\n        // ENTER\n        this.addNewItemThrottled();\n      } else return;\n      e.preventDefault();\n    }\n  };\n\n  _addHistoryItem(newEntry) {\n    if (newEntry.key == null) {\n      throw new Error(\n        \"null key shouldn't have value. There is no point to restore it.\"\n      );\n    }\n\n    if (\n      !this._entries.has(newEntry.key) ||\n      !this._entries.get(newEntry.key).isDataLoaded()\n    ) {\n      return;\n    }\n\n    this._history = this._history.slice(0, this._historyIndex);\n    this._history.push({\n      old: this._entries.has(newEntry.key)\n        ? this._entries.get(newEntry.key)\n        : new EntryModel(newEntry.key).delete(),\n      new: newEntry,\n    });\n    this._historyIndex = this._history.length;\n  }\n\n  async _sendEntryToBackend(entry) {\n    let descriptionPromise = null;\n    if (entry.description !== this._descriptions.get(entry.key)) {\n      descriptionPromise = this._backendMap.setDescription(\n        entry.key,\n        entry.description\n      );\n      this._descriptions.set(entry.key, entry.description);\n    }\n\n    let dataPromise = null;\n    if (entry.isDataLoaded())\n      dataPromise = this._backendMap.set(entry.key, JSON.stringify(entry.data));\n\n    await Promise.all([descriptionPromise, dataPromise]);\n  }\n\n  async _fetchSettings() {\n    const serializedSettings = await this._backendMap.getSettings();\n    if (this._serializedSettings === serializedSettings) return;\n\n    this._serializedSettings = serializedSettings;\n\n    this._settings = new Settings(serializedSettings);\n\n    this._onEntriesChanged();\n  }\n\n  _fetch = async (key) => {\n    let content = await this._backendMap.get(key);\n\n    if (!this._entries.has(key)) {\n      console.error(\"Entry for fetch doesn't exist anymore. \" + key);\n      return;\n    }\n\n    if (content === undefined) {\n      console.error(\"Key \" + key + \" is missing\");\n      this._entries.delete(key);\n      this._onEntriesChanged();\n      return;\n    }\n\n    try {\n      if (content === \"\") {\n        let entry = new EntryModel(key).delete();\n        this._addHistoryItem(entry);\n        this._entries.set(key, entry);\n      } else {\n        const data = JSON.parse(content);\n\n        if (\n          data !== EntryStatus.DELETED &&\n          (data.left == null || data.right == null)\n        ) {\n          throw new Error(\"bad format \" + content);\n        }\n\n        if (\n          data === EntryStatus.DELETED &&\n          this._descriptions.get(key) !== EntryStatus.DELETED\n        ) {\n          this._backendMap.setDescription(key, EntryStatus.DELETED);\n        }\n\n        let entry = new EntryModel(key, data, this._descriptions.get(key));\n\n        this._addHistoryItem(entry);\n        this._entries.set(key, entry);\n      }\n    } catch (e) {\n      console.error(e.message + \" \" + key + \" \" + content);\n      if (!this._entries.get(key).isDataLoaded()) {\n        this._entries.delete(key);\n        this._descriptions.delete(key);\n        this._backendMap.delete(key);\n      }\n    }\n\n    this._onEntriesChanged();\n  };\n\n  _getFilteredEntriesArray() {\n    return Array.from(this._entries.values())\n      .reverse()\n      .filter((x) => x.data !== EntryStatus.DELETED && x.key !== null);\n  }\n\n  _onEntriesChanged() {\n    const entries = this._getFilteredEntriesArray();\n    this._subscriptions.forEach((callback) => {\n      callback(entries, this._settings, {\n        canRedo: this._history.length > this._historyIndex,\n        canUndo: this._history.length > 0 && this._historyIndex > 0,\n      });\n    });\n  }\n}\n","import { BackendMap } from \"./BackendMap\";\nimport _ from \"lodash\";\nimport md5 from \"md5\";\nimport { Mutex } from \"async-mutex\";\nimport Bottleneck from \"bottleneck\";\n\nconst chunkSize = 8;\n\nexport function applyQuotaSavers(backendMap) {\n  return new BackendMultiplexor(\n    new RequestThrottler(new ErrorHandler(backendMap))\n  );\n}\n\n// Asociates several pseudo keys with each Google Drive key.\n// Reduces amount of calls to _innerBackendMap methods without changing\n// its interface.\n//\n// Prevents users of this class from accessing md5 because server cannot\n// compute md5 for multiplexed sub-items.\n// It replaces |md5checksum| with |outdated|=true in getAllKeys result.\n// |outdated| means that the server has fresher data so the client\n// should call |get| for it.\nexport class BackendMultiplexor extends BackendMap {\n  constructor(innerMap) {\n    super();\n    if (!innerMap instanceof BackendMap)\n      throw new Error(\n        \"CachingBackendMap have to accepts instance of BackendMap\"\n      );\n    this._innerBackendMap = innerMap;\n  }\n\n  async createKey() {\n    let release = await this._changeKeysMutex.acquire();\n    try {\n      if (this._innerKeys === null) {\n        throw new Error(\"You should call getAllKeys first\");\n      }\n\n      let getLastInnerKey = () => {\n        if (this._innerKeys.length === 0) return undefined;\n        return this._innerKeys[this._innerKeys.length - 1];\n      };\n\n      if (\n        this._innerKeys.length === 0 ||\n        this._chunks.get(getLastInnerKey()).isFull()\n      ) {\n        let newInnerKey = await this._innerBackendMap.createKey();\n        this._innerKeys.push(newInnerKey);\n        this._chunks.set(\n          newInnerKey,\n          new this._Chunk({\n            connector: this._createChunkConnector(newInnerKey),\n          })\n        );\n      }\n\n      let innerKey = getLastInnerKey();\n      let keyPrefix = await this._chunks.get(innerKey).createSubKey();\n      return keyPrefix + \"-\" + innerKey;\n    } finally {\n      release();\n    }\n  }\n\n  async delete(key) {\n    let release = await this._changeKeysMutex.acquire();\n    try {\n      const { prefixKey, innerKey } = this._splitOuterKey(key);\n      if (!this._chunks.has(innerKey)) return;\n\n      await this._chunks.get(innerKey).delete(prefixKey);\n    } finally {\n      release();\n    }\n  }\n\n  async set(key, value) {\n    const { prefixKey, innerKey } = this._splitOuterKey(key);\n    if (!this._chunks.has(innerKey)) return;\n    this._chunks.get(innerKey).setValue(prefixKey, value);\n  }\n\n  async getMd5(key) {\n    throw new Error(\n      \"Don't call getMd5 on this class. \" +\n        \"Server cannot compute md5 for this item because it is multiplexed.\" +\n        \"In order to sync call |getAllKeys| and if some item has |outdated===true| call |get|.\"\n    );\n  }\n\n  async get(key) {\n    const { prefixKey, innerKey } = this._splitOuterKey(key);\n    if (!this._chunks.has(innerKey)) return undefined;\n    return this._chunks.get(innerKey).getValue(prefixKey);\n  }\n\n  async getAllKeys() {\n    let release = await this._changeKeysMutex.acquire();\n    try {\n      let newInnerKeys = await this._innerBackendMap.getAllKeys();\n      let outerKeys = [];\n      let newChunks = new Map();\n      let counter = 0;\n\n      newInnerKeys.forEach((innerKey) => {\n        let outdated = true;\n        let isFirstChunk = counter++ === 0;\n\n        if (this._chunks.has(innerKey.id)) {\n          let chunk = this._chunks.get(innerKey.id);\n          newChunks.set(innerKey.id, chunk);\n\n          outdated = chunk.onMetadataUpdate(\n            innerKey.description,\n            innerKey.md5Checksum\n          ).outdated;\n        } else {\n          newChunks.set(\n            innerKey.id,\n            new this._Chunk({\n              connector: this._createChunkConnector(innerKey.id),\n              serializedDescriptions: innerKey.description,\n              isFirstChunk,\n              md5Checksum: innerKey.md5Checksum,\n            })\n          );\n        }\n        let chunk = newChunks.get(innerKey.id);\n        chunk.listSubKeys().forEach((subkey) => {\n          outerKeys.push({\n            id: subkey + \"-\" + innerKey.id,\n            outdated,\n            description: chunk.getDescription(subkey),\n          });\n        });\n      });\n\n      this._chunks = newChunks;\n      this._innerKeys = newInnerKeys.map((x) => x.id);\n\n      return outerKeys;\n    } finally {\n      release();\n    }\n  }\n\n  async getSettings() {\n    return await this._innerBackendMap.getSettings();\n  }\n\n  async setSettings(settingsContent) {\n    let release = await this._changeKeysMutex.acquire();\n    await this._innerBackendMap.setSettings(settingsContent);\n    release();\n  }\n\n  async setDescription(key, description) {\n    const { prefixKey, innerKey } = this._splitOuterKey(key);\n    if (!this._chunks.has(innerKey)) return;\n    this._chunks.get(innerKey).setDescription(prefixKey, description);\n  }\n\n  // PRIVATE SECTION\n  _changeKeysMutex = new Mutex();\n\n  _innerKeys = null;\n  _innerBackendMap = null;\n\n  _createChunkConnector = (innerkey) => {\n    return {\n      setValue: (serializedValue) => {\n        this._innerBackendMap.set(innerkey, serializedValue);\n      },\n      setDescription: (serializedDescription) => {\n        this._innerBackendMap.setDescription(innerkey, serializedDescription);\n      },\n      getValue: async () => {\n        return await this._innerBackendMap.get(innerkey);\n      },\n      delete: async () => {\n        this._innerKeys.splice(this._innerKeys.indexOf(innerkey), 1);\n        this._chunks.delete(innerkey);\n        await this._innerBackendMap.delete(innerkey);\n      },\n    };\n  };\n\n  // Contains instances of |this._Chunk| for each key inside |this._innerKeys|.\n  _chunks = new Map();\n\n  // Each inner key contains a chunk of outer keys.\n  // If innerBackendMap creates key \"abcdefg\", BackendMultiplexor will\n  // use it to store chunk of sub-keys : \"0-abcdefg\", \"1-abcdefg\", ..., \"chunkSize-abcdefg\"\n  //\n  // To get \"4-abcdefg\" description you should make the next call:\n  // this._chunks[\"abcdefg\"].getDescription(4)\n  //\n  // md5Checksum is common for all subkeys.\n  _Chunk = class {\n    constructor({ connector, serializedDescriptions, md5Checksum }) {\n      this._connector = connector;\n      this._initialMd5Checksum = md5Checksum;\n      if (serializedDescriptions === undefined) {\n        this._values = Array(chunkSize).fill(\"\");\n        this._descriptions = [];\n        this._isDirty = true;\n      } else {\n        this._serializedDescriptions = serializedDescriptions;\n        this._isDirty = false;\n        this._descriptions = serializedDescriptions\n          .split(\",\")\n          .map((x) => (x === \"null\" ? null : x));\n      }\n    }\n\n    isFull() {\n      return this._descriptions.length >= chunkSize;\n    }\n\n    listSubKeys() {\n      let subkeys = [];\n      for (let i = 0; i < this._descriptions.length && i < chunkSize; i++)\n        if (this._descriptions[i] != null) subkeys.push(i);\n      return subkeys;\n    }\n\n    async createSubKey() {\n      this._shouldKeepOnFormatError = true;\n\n      try {\n        if (this._values == null) await this._fetchValuesSynchronised();\n        if (this._values == null) return null;\n\n        if (this.isFull())\n          throw new Error(\"Do not call createSubKey for full chunks\");\n\n        let subkey = this._descriptions.length;\n        this._descriptions.push(\"\");\n        // Just to set correct state;\n        this.setDescription(subkey, \"\");\n\n        return subkey;\n      } finally {\n        this._shouldKeepOnFormatError = false;\n      }\n    }\n\n    async delete(subkey) {\n      if (this._descriptions[subkey] == null)\n        throw new Error(\"item is already deleted\");\n      if (this._descriptions.filter((x) => x != null).length === 1)\n        await this._connector.delete();\n      else this.setDescription(subkey, null);\n    }\n\n    async setValue(subkey, value) {\n      if (this._values == null) await this._fetchValuesSynchronised();\n      if (this._values == null) return;\n\n      this._values[subkey] = value;\n      this._isDirty = true;\n      this._serializedValues = null;\n      this._onValueSet();\n    }\n\n    async getValue(subkey) {\n      if (this._descriptions[subkey] === null) return undefined;\n      if (this._values == null) await this._fetchValuesSynchronised();\n      if (this._values == null) return undefined;\n\n      return this._values[subkey];\n    }\n\n    setDescription(subkey, description) {\n      if (\n        subkey >= this._descriptions.length ||\n        this._descriptions[subkey] == null\n      ) {\n        throw new Error(\n          \"null description means subkey doesn't exist. Did you call createKey?\"\n        );\n      }\n\n      this._descriptions[subkey] = description;\n      this._serializedDescriptions = null;\n      this._isDirty = true;\n\n      this._onDescriptionSet();\n    }\n\n    getDescription(subkey) {\n      return this._descriptions[subkey];\n    }\n\n    onMetadataUpdate(serializedDescriptions, md5Checksum) {\n      if (this._isDirty) {\n        if (\n          this._serializedValues != null &&\n          this._serializedDescriptions != null &&\n          md5(this._serializedValues) === md5Checksum &&\n          this._serializedDescriptions === serializedDescriptions\n        ) {\n          this._isDirty = false;\n          this._initialMd5Checksum = md5Checksum;\n        }\n        return { outdated: false };\n      }\n\n      if (this._serializedDescriptions !== serializedDescriptions) {\n        this._serializedDescriptions = serializedDescriptions;\n\n        this._descriptions = serializedDescriptions\n          .split(\",\")\n          .map((x) => (x === \"null\" ? null : x));\n      }\n\n      if (this._initialMd5Checksum !== md5Checksum) {\n        this._serializedValues = null;\n        this._values = null;\n        return { outdated: true };\n      }\n\n      return { outdated: false };\n    }\n\n    // PRIVATE SECTION\n\n    // |values| and |descriptions| are arrays containing up-to chunkSize elements.\n    _values;\n    _descriptions;\n\n    // result of JSON.stringify(this.values);\n    _serializedValues;\n    _serializedDescriptions;\n\n    _connector;\n\n    // |isDirty| is set true when |set| for one of subkeys has been called.\n    // In that case BackendMultiplexor will think that it has the most fresh data\n    // and it will ignore updates in |getAllKeys| until it contains |md5Checksum|\n    // equal to md5(this.serializedValues).\n    _isDirty;\n\n    // This is md5 checksum for values acquired from server.\n    // It is used only when |isDirty| === false.\n    _initialMd5Checksum;\n\n    _onValueSet = _.debounce(() => {\n      this._serializedValues = JSON.stringify(this._values);\n      this._connector.setValue(this._serializedValues);\n    }, 1000);\n\n    _onDescriptionSet = _.debounce(() => {\n      this._serializedDescriptions = this._descriptions\n        .map((x) => (x === null ? \"null\" : x))\n        .join(\",\");\n\n      this._connector.setDescription(this._serializedDescriptions);\n    }, 1000);\n\n    _fetchValuesSynchronised = async () => {\n      if (this._fetchPromise == null) {\n        this._fetchPromise = this._fetchValues();\n      }\n      await this._fetchPromise;\n      this._fetchPromise = null;\n    };\n    _fetchPromise = null;\n    _fetchValues = async () => {\n      let serializedValues = await this._connector.getValue();\n      try {\n        let values = JSON.parse(serializedValues);\n        if (!Array.isArray(values)) {\n          throw new Error(\"Bad server data. Not valid array\");\n        }\n\n        while (values.length < this._descriptions.length) {\n          values.push(\"\");\n        }\n        this._values = values;\n        this._serializedValues = serializedValues;\n        this._initialMd5Checksum = md5(serializedValues);\n        this._isDirty = false;\n      } catch (error) {\n        // In theory, server may contain arbitrary data.\n        // BackendMultiplexor should be able recover in this case.\n        console.error(\n          \"Bad response from server:\" + error.message + \" \" + serializedValues\n        );\n        if (this._shouldKeepOnFormatError) {\n          this._values = Array(chunkSize).fill(\"\");\n          this._isDirty = true;\n          this._serializedValues = null;\n          this._onValueSet();\n        } else {\n          this._connector.delete();\n        }\n      }\n    };\n  };\n\n  _splitOuterKey = (outerKey) => {\n    let separator = outerKey.indexOf(\"-\");\n    let prefixKey = Number(outerKey.substring(0, separator));\n    let innerKey = outerKey.substring(separator + 1);\n    return { prefixKey, innerKey };\n  };\n}\n\nexport class ErrorHandler extends BackendMap {\n  constructor(innerMap) {\n    super();\n    if (!innerMap instanceof BackendMap)\n      throw new Error(\n        \"CachingBackendMap have to accepts instance of BackendMap\"\n      );\n    this._innerBackendMap = innerMap;\n  }\n\n  async _exponentialRetry(callback) {\n    let retriesCount = 1;\n    while (retriesCount < 10) {\n      try {\n        return await callback();\n      } catch (error) {\n        let secondsToNextRetry = 1 * 3 ** retriesCount++;\n        console.error(\n          `Failed running ${callback.name} : ${error.message}. Will try again after ${secondsToNextRetry} seconds.`\n        );\n        await this._sleep(secondsToNextRetry * 1000);\n      }\n    }\n\n    console.error(\"finish retry attempts\");\n  }\n\n  async createKey() {\n    return await this._exponentialRetry(\n      this._innerBackendMap.createKey.bind(this._innerBackendMap)\n    );\n  }\n\n  async delete(key) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.delete.bind(this._innerBackendMap, key)\n    );\n  }\n\n  async set(key, value) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.set.bind(this._innerBackendMap, key, value)\n    );\n  }\n\n  async get(key) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.get.bind(this._innerBackendMap, key)\n    );\n  }\n\n  async getMd5(key) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.getMd5.bind(this._innerBackendMap, key)\n    );\n  }\n\n  async getAllKeys() {\n    return await this._exponentialRetry(\n      this._innerBackendMap.getAllKeys.bind(this._innerBackendMap)\n    );\n  }\n\n  async getSettings() {\n    return await this._exponentialRetry(\n      this._innerBackendMap.getSettings.bind(this._innerBackendMap)\n    );\n  }\n\n  async setSettings(settingsContent) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.setSettings.bind(\n        this._innerBackendMap,\n        settingsContent\n      )\n    );\n  }\n\n  async setDescription(key, description) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.setDescription.bind(\n        this._innerBackendMap,\n        key,\n        description\n      )\n    );\n  }\n\n  _innerBackendMap = null;\n  _sleep(ms) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n  }\n}\n\nexport class RequestThrottler extends BackendMap {\n  _innerBackendMap = null;\n  constructor(innerMap) {\n    super();\n    if (!innerMap instanceof BackendMap)\n      throw new Error(\n        \"CachingBackendMap have to accepts instance of BackendMap\"\n      );\n    this._innerBackendMap = innerMap;\n    this._limiter = new Bottleneck({\n      maxConcurrent: 5,\n      minTime: 50,\n    });\n  }\n\n  async createKey() {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.createKey()\n    );\n  }\n\n  async delete(key) {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.delete(key)\n    );\n  }\n\n  async set(key, value) {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.set(key, value)\n    );\n  }\n\n  async get(key) {\n    return await this._limiter.schedule(() => this._innerBackendMap.get(key));\n  }\n\n  async getMd5(key) {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.getMd5(key)\n    );\n  }\n\n  async getAllKeys() {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.getAllKeys()\n    );\n  }\n\n  async getSettings() {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.getSettings()\n    );\n  }\n\n  async setSettings(settingsContent) {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.setSettings(settingsContent)\n    );\n  }\n\n  async setDescription(key, description) {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.setDescription(key, description)\n    );\n  }\n}\n","import React from \"react\";\nimport \"./App.css\";\nimport \"fontsource-roboto\";\nimport {\n  createMuiTheme,\n  CssBaseline,\n  ThemeProvider,\n  useMediaQuery,\n} from \"@material-ui/core\";\nimport { blue, blueGrey } from \"@material-ui/core/colors\";\n\nimport { AppMenu } from \"./AppMenu.js\";\nimport { AppContent } from \"./AppContent.js\";\nimport { gdriveMap } from \"./GDriveMap\";\nimport { gdriveAuthClient, GDriveStates } from \"./GDriveAuthClient\";\nimport { EntriesTableModelImpl } from \"./EntriesTableModel\";\nimport { applyQuotaSavers } from \"./BackendQuotaSavers\";\n\nfunction App() {\n  const prefersDarkMode = useMediaQuery(\"(prefers-color-scheme: dark)\");\n\n  const theme = React.useMemo(\n    () =>\n      createMuiTheme({\n        palette: {\n          type: prefersDarkMode ? \"dark\" : \"light\",\n          primary: { main: prefersDarkMode ? blueGrey[900] : blue[800] },\n          background: {\n            default: prefersDarkMode ? \"#303030\" : blueGrey[50],\n          },\n        },\n      }),\n    [prefersDarkMode]\n  );\n  const [appBarShown, setAppBarShown] = React.useState(true);\n  const onTableEntryFocus = React.useCallback((arg) => {\n    if (window.innerHeight < 700) {\n      setAppBarShown(false);\n    }\n  }, []);\n\n  const showAppBar = React.useCallback((arg) => {\n    setAppBarShown(true);\n  }, []);\n\n  const [model, setModel] = React.useState(null);\n\n  React.useEffect(() => {\n    gdriveAuthClient.addStateListener((newState) => {\n      if (newState === GDriveStates.SIGNED_IN) {\n        setModel(\n          new EntriesTableModelImpl(\n            applyQuotaSavers(gdriveMap),\n            gdriveAuthClient\n          )\n        );\n      } else {\n        setModel((oldModel) => {\n          if (!!oldModel) oldModel.dispose();\n          return null;\n        });\n      }\n    });\n  }, []);\n\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      <AppMenu shown={appBarShown} model={model}></AppMenu>\n      <AppContent\n        onFocus={onTableEntryFocus}\n        appBarShown={appBarShown}\n        onShowAppBar={showAppBar}\n        model={model}\n      />\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import React from \"react\";\r\nimport { Typography, makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles({\r\n  container: {\r\n    flex: 1,\r\n    display: \"flex\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n  },\r\n});\r\nexport function CenteredTypography(props) {\r\n  const classes = useStyles();\r\n  return (\r\n    <div className={classes.container}>\r\n      <Typography variant=\"h4\" {...props}>\r\n        {props.children}\r\n      </Typography>\r\n    </div>\r\n  );\r\n}\r\n","class Hint {\r\n  _isEnabled;\r\n  _text;\r\n\r\n  get isEnabled() {\r\n    return this._isEnabled;\r\n  }\r\n  get text() {\r\n    return this._text;\r\n  }\r\n\r\n  setIsEnabled(isEnabled) {\r\n    return new Hint({ isEnabled, text: this._text });\r\n  }\r\n\r\n  setText(text) {\r\n    return new Hint({ text, isEnabled: this._isEnabled });\r\n  }\r\n\r\n  constructor(data) {\r\n    if (typeof data === \"string\") data = JSON.parse(data);\r\n\r\n    if (typeof data.isEnabled !== \"boolean\" || typeof data.text !== \"string\")\r\n      throw new Error(\"Wrong hint data \" + JSON.stringify(data));\r\n    this._isEnabled = data.isEnabled;\r\n    this._text = data.text;\r\n  }\r\n\r\n  stringify() {\r\n    return JSON.stringify({ isEnabled: this._isEnabled, text: this._text });\r\n  }\r\n}\r\n\r\nexport class Settings {\r\n  get emojiList() {\r\n    return this._emojiList;\r\n  }\r\n  get leftHint() {\r\n    return this._leftHint;\r\n  }\r\n  get rightHint() {\r\n    return this._rightHint;\r\n  }\r\n\r\n  setEmojiList(emojiList) {\r\n    return new Settings({\r\n      emojiList,\r\n      leftHint: this._leftHint,\r\n      rightHint: this._rightHint,\r\n    });\r\n  }\r\n  setLeftHint(leftHint) {\r\n    return new Settings({\r\n      emojiList: this._emojiList,\r\n      leftHint,\r\n      rightHint: this._rightHint,\r\n    });\r\n  }\r\n\r\n  setRightHint(rightHint) {\r\n    return new Settings({\r\n      emojiList: this._emojiList,\r\n      leftHint: this._leftHint,\r\n      rightHint,\r\n    });\r\n  }\r\n\r\n  stringify() {\r\n    return JSON.stringify({\r\n      emojiList: this._emojiList,\r\n      leftHint: this._leftHint.stringify(),\r\n      rightHint: this._rightHint.stringify(),\r\n    });\r\n  }\r\n\r\n  constructor(json) {\r\n    try {\r\n      if (typeof json === \"string\") json = JSON.parse(json);\r\n\r\n      if (\r\n        !Array.isArray(json.emojiList) ||\r\n        !json.emojiList.every(\r\n          (x) => typeof String.fromCodePoint(x.codePoint) === \"string\"\r\n        )\r\n      ) {\r\n        throw new Error(\"Bad emoji list: \" + JSON.stringify(json));\r\n      }\r\n\r\n      this._emojiList = json.emojiList;\r\n      this._leftHint = new Hint(json.leftHint);\r\n      this._rightHint = new Hint(json.rightHint);\r\n    } catch (error) {\r\n      if (!!json) console.error(\"Settings format error:\" + error.message);\r\n      this._mutateToDefaults();\r\n    }\r\n  }\r\n\r\n  _mutateToDefaults() {\r\n    this._leftHint = new Hint({\r\n      isEnabled: true,\r\n      text: \"What happened?\\nWhat were your immediate thoughts?\",\r\n    });\r\n\r\n    this._rightHint = new Hint({\r\n      isEnabled: true,\r\n      text:\r\n        \"Why is it bad?\\n\" +\r\n        \"What would your therapist say?\\n\" +\r\n        \"Is your view of the problem biased?\",\r\n    });\r\n\r\n    this._emojiList = [\r\n      { codePoint: 0x1f44e, text: \"discontent\" },\r\n      { codePoint: 0x1f628, text: \"fear\" },\r\n      { codePoint: 0x1f622, text: \"sadness\" },\r\n      { codePoint: 0x1f62d, text: \"grief\" },\r\n      { codePoint: 0x1f631, text: \"horror\" },\r\n      { codePoint: 0x1f616, text: \"pain\" },\r\n      { codePoint: 0x1f621, text: \"anger\" },\r\n      { codePoint: 0x1f922, text: \"disgust\" },\r\n    ];\r\n  }\r\n\r\n  _emojiList;\r\n  _leftHint;\r\n  _rightHint;\r\n}\r\n"],"sourceRoot":""}