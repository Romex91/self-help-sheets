(this["webpackJsonpself-help-sheets"]=this["webpackJsonpself-help-sheets"]||[]).push([[0],{125:function(e,t,n){e.exports=n(163)},130:function(e,t,n){},131:function(e,t,n){},163:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(14),s=n.n(i),o=(n(130),n(15)),c=(n(131),n(132),n(215)),u=n(112),l=n(218),h=n(219),d=n(217),p=n(78),f=n(53),m=n(2),y=n.n(m),b=n(6),v=n(13),g=n(12),k=n(11),_=n(30),w={LOADING:"loading",SIGNED_IN:"signed_in",SIGNED_OUT:"signed_out",FAILED:"failed"};Object.freeze(w);var j=Object(_.a)("state"),x=Object(_.a)("stateListeners"),E=new(function(){function e(){var t=this;Object(v.a)(this,e),Object.defineProperty(this,j,{writable:!0,value:w.LOADING}),Object.defineProperty(this,x,{writable:!0,value:new Set}),function(e){console.assert("function"==typeof e),console.assert(0===e.length);var t=document.createElement("script");t.async=!0,t.src="https://apis.google.com/js/api.js",document.body.appendChild(t),t.onload=e,t.onerror=e}(Object(b.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,window.gapi){e.next=3;break}throw new Error("Failed loading GAPI");case 3:return e.next=5,new Promise((function(e){return window.gapi.load("client:auth2",e)}));case 5:return e.next=7,window.gapi.client.init({clientId:"479709565206-4ek8a502261s9sussiehpa5v146ns2ku.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:"https://www.googleapis.com/auth/drive.appfolder"});case 7:if(O()){e.next=9;break}throw new Error("Failed registering client_id.");case 9:t._updateSignInState(),window.gapi.auth2.getAuthInstance().isSignedIn.listen(t._updateSignInState.bind(t)),e.next=19;break;case 13:return e.prev=13,e.t0=e.catch(0),console.log(e.t0),Object(k.a)(t,j)[j]=w.FAILED,t._notifyStateChanged(),e.abrupt("return");case 19:case"end":return e.stop()}}),e,null,[[0,13]])}))))}return Object(g.a)(e,[{key:"addStateListener",value:function(e){console.assert("function"==typeof e),console.assert(1===e.length),console.assert(!Object(k.a)(this,x)[x].has(e)),Object(k.a)(this,x)[x].add(e)}},{key:"removeStateListener",value:function(e){console.assert("function"==typeof e),console.assert(1===e.length),console.assert(Object(k.a)(this,x)[x].has(e)),Object(k.a)(this,x)[x].delete(e)}},{key:"waitForStateChange",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){t.addStateListener((function n(r){t.removeStateListener(n),e(r)}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"state",get:function(){return Object(k.a)(this,j)[j]}}]),Object(g.a)(e,[{key:"signIn",value:function(){console.assert(O()),window.mocha?window.gapi.auth2.getAuthInstance().signIn():window.gapi.auth2.getAuthInstance().signIn({prompt:"select_account"})}},{key:"signOut",value:function(){console.assert(O()),window.gapi.auth2.getAuthInstance().signOut()}},{key:"_notifyStateChanged",value:function(){var e,t=Object(f.a)(Object(k.a)(this,x)[x]);try{for(t.s();!(e=t.n()).done;){(0,e.value)(Object(k.a)(this,j)[j])}}catch(n){t.e(n)}finally{t.f()}}},{key:"_updateSignInState",value:function(){console.assert(Object(k.a)(this,j)[j]!==w.FAILED);var e=(console.assert(O()),window.gapi.auth2.getAuthInstance().isSignedIn.get()?w.SIGNED_IN:w.SIGNED_OUT);Object(k.a)(this,j)[j]!==e&&(Object(k.a)(this,j)[j]=e,this._notifyStateChanged())}}]),e}());function O(){return window.gapi&&window.gapi.auth2&&window.gapi.client}Object.seal(E);var S=n(19),C=n(32),A=n(21),D=n(20),I=function(e){e.active;return a.a.createElement("div",{style:{display:"flex",padding:10}},a.a.createElement("svg",{width:"18",height:"18",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("g",{fill:"#000",fillRule:"evenodd"},a.a.createElement("path",{d:"M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z",fill:"#EA4335"}),a.a.createElement("path",{d:"M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z",fill:"#4285F4"}),a.a.createElement("path",{d:"M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z",fill:"#FBBC05"}),a.a.createElement("path",{d:"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z",fill:"#34A853"}),a.a.createElement("path",{fill:"none",d:"M0 0h18v18H0z"}))))},M=n(200),L=n(221),F=n(199),K=function(e){var t=e.children;return a.a.createElement("span",{style:{padding:10,paddingLeft:0,fontWeight:500}},t)},B={backgroundColor:"#fff",display:"inline-flex",alignItems:"center",color:"rgba(0, 0, 0, .54)",boxShadow:"0 2px 2px 0 rgba(0, 0, 0, .24), 0 0 1px 0 rgba(0, 0, 0, .24)",padding:0,borderRadius:2,border:"1px solid transparent",fontSize:14,fontWeight:"500",fontFamily:"Roboto, sans-serif",cursor:"pointer"},P={opacity:.6},N=Object(_.a)("setAuthState"),R=Object(_.a)("setButtonAnchor"),T=Object(_.a)("getButtonStyle"),z=Object(_.a)("onClick"),H=function(e){Object(A.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(v.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={authState:e.props.gdriveAuthClient.state,prevAuthState:e.props.gdriveAuthClient.LOADING,buttonAnchor:null},Object.defineProperty(Object(C.a)(e),N,{writable:!0,value:function(t){e.setState((function(e){return Object(S.a)(Object(S.a)({},e),{},{prevAuthState:e.authState,authState:t})}))}}),Object.defineProperty(Object(C.a)(e),R,{writable:!0,value:function(t){e.setState((function(e){return Object(S.a)(Object(S.a)({},e),{},{buttonAnchor:t})}))}}),Object.defineProperty(Object(C.a)(e),T,{writable:!0,value:function(){return e.state.authState===w.FAILED||e.state.authState===w.LOADING?Object.assign({},B,P):B}}),Object.defineProperty(Object(C.a)(e),z,{writable:!0,value:function(){var t=Object(b.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state.authState===w.SIGNED_IN?e.props.gdriveAuthClient.signOut():e.state.authState===w.SIGNED_OUT&&e.props.gdriveAuthClient.signIn();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}),e}return Object(g.a)(n,[{key:"componentDidMount",value:function(){this.state.authState!==this.props.gdriveAuthClient.state&&Object(k.a)(this,N)[N](this.props.gdriveAuthClient.state),this.props.gdriveAuthClient.addStateListener(Object(k.a)(this,N)[N])}},{key:"componentWillUnmount",value:function(){this.props.gdriveAuthClient.removeStateListener(Object(k.a)(this,N)[N])}},{key:"render",value:function(){var e=this,t=function(){if(e.state.authState===w.FAILED)return a.a.createElement(L.a,{severity:"error"},"Failed connecting to google. Check your connection and try reloading the page.");if(e.state.authState===w.SIGNED_OUT){if(e.state.prevAuthState===w.SIGNED_IN)return a.a.createElement(L.a,{severity:"warning"},a.a.createElement(F.a,null,"Privacy note!"),"If other people have access to this browser ",a.a.createElement("br",null),"AND you don't want them to read your sheets: ",a.a.createElement("br",null),a.a.createElement("ol",null,a.a.createElement("li",null,"sign out globally: ",a.a.createElement("br",null),a.a.createElement("a",{href:"https://accounts.google.com/Logout"},"https://accounts.google.com/Logout")),a.a.createElement("li",null,"delete Google account password from the browser")));if(e.state.prevAuthState===w.LOADING)return a.a.createElement(L.a,{severity:"info"},"This site stores data in a hidden Google Drive folder. ",a.a.createElement("br",null),"Sign in to proceed.",a.a.createElement("br",null))}}();return a.a.createElement("button",{ref:function(t){return Object(k.a)(e,R)[R](t)},onClick:Object(k.a)(this,z)[z],style:Object(k.a)(this,T)[T](),type:"button"},a.a.createElement(I,{key:0,active:this.state.active}),a.a.createElement(K,{key:2},this.state.authState===w.SIGNED_IN?"Sign Out":"Sign in with Google"),!!t&&!!this.state.buttonAnchor&&a.a.createElement(M.a,{key:1,style:{zIndex:1200},open:!0,anchorEl:this.state.buttonAnchor,placement:"bottom-end",disablePortal:!1,modifiers:{flip:{enabled:!1},preventOverflow:{enabled:!1},hide:{enabled:!1},offset:{offset:"0,5"}}},t))}}]),n}(a.a.PureComponent),V=n(201),U=Object(V.a)((function(e){return{root:{position:"absolute",top:"5%",left:"5%",width:"90%",height:"90%",backgroundColor:e.palette.background.paper,zIndex:1}}})),G=a.a.forwardRef((function(e,t){var n=U();return a.a.createElement("article",Object.assign({className:n.root},e,{ref:t}),a.a.createElement("h1",null,"User Guide"))})),q=n(44),W=n(54),J=n(204),Y=n(222),$=n(220),Q=n(205),X=n(226),Z=n(206),ee=n(115),te=n(165),ne=n(198),re=n(208),ae=n(207),ie=n(107),se=n.n(ie),oe=Object(V.a)({container:{flex:1,display:"flex",justifyContent:"center",alignItems:"center"}});function ce(e){var t=oe();return a.a.createElement("div",{className:t.container},a.a.createElement(ee.a,Object.assign({variant:"h4"},e),e.children))}var ue=function(){function e(t){if(Object(v.a)(this,e),"string"===typeof t&&(t=JSON.parse(t)),"boolean"!==typeof t.isEnabled||"string"!==typeof t.text)throw new Error("Wrong hint data "+JSON.stringify(t));this._isEnabled=t.isEnabled,this._text=t.text}return Object(g.a)(e,[{key:"setIsEnabled",value:function(t){return new e({isEnabled:t,text:this._text})}},{key:"setText",value:function(t){return new e({text:t,isEnabled:this._isEnabled})}},{key:"isEnabled",get:function(){return this._isEnabled}},{key:"text",get:function(){return this._text}}]),Object(g.a)(e,[{key:"stringify",value:function(){return JSON.stringify({isEnabled:this._isEnabled,text:this._text})}}]),e}(),le=function(){function e(t){Object(v.a)(this,e);try{if("string"===typeof t&&(t=JSON.parse(t)),!Array.isArray(t.emojiList)||!t.emojiList.every((function(e){return"string"===typeof String.fromCodePoint(e.codePoint)})))throw new Error("Bad emoji list: "+JSON.stringify(t));this._emojiList=t.emojiList,this._leftHint=new ue(t.leftHint),this._rightHint=new ue(t.rightHint)}catch(n){t&&console.error("Settings format error:"+n.message),this._mutateToDefaults()}}return Object(g.a)(e,[{key:"setEmojiList",value:function(t){return new e({emojiList:t,leftHint:this._leftHint,rightHint:this._rightHint})}},{key:"setLeftHint",value:function(t){return new e({emojiList:this._emojiList,leftHint:t,rightHint:this._rightHint})}},{key:"setRightHint",value:function(t){return new e({emojiList:this._emojiList,leftHint:this._leftHint,rightHint:t})}},{key:"stringify",value:function(){return JSON.stringify({emojiList:this._emojiList,leftHint:this._leftHint.stringify(),rightHint:this._rightHint.stringify()})}},{key:"emojiList",get:function(){return this._emojiList}},{key:"leftHint",get:function(){return this._leftHint}},{key:"rightHint",get:function(){return this._rightHint}}]),Object(g.a)(e,[{key:"_mutateToDefaults",value:function(){this._leftHint=new ue({isEnabled:!0,text:"What happened?\nWhat were your immediate thoughts?"}),this._rightHint=new ue({isEnabled:!0,text:"Why is it bad?\nWhat would your therapist say?\nIs your view of the problem biased?\nWhat would an adequate response be?"}),this._emojiList=[{codePoint:128078,text:"discontent"},{codePoint:128552,text:"fear"},{codePoint:128546,text:"sadness"},{codePoint:128557,text:"grief"},{codePoint:128561,text:"horror"},{codePoint:128534,text:"pain"},{codePoint:128545,text:"anger"},{codePoint:129314,text:"disgust"}]}}]),e}(),he=n(23),de=n(225),pe=n(203),fe=n(108),me=n.n(fe),ye=n(87),be=n.n(ye),ve=n(57),ge=n(202),ke=Object(V.a)((function(e){return{outer:{position:"relative"},popup:{position:"absolute",display:"flex",flexDirection:"column",justifyContent:"center",minWidth:140,zIndex:2,padding:10,background:e.palette.background.paper,border:"gray solid 2px",borderRadius:4}}})),_e=a.a.forwardRef((function(e,t){var n=ke();return e.in&&a.a.createElement("div",{className:n.outer},a.a.createElement(ge.a,{in:e.in},a.a.createElement("div",{ref:t,className:n.popup},e.children)))})),we=Object(V.a)((function(e){return{container:{alignSelf:"flex-start",margin:2,cursor:"pointer",borderColor:function(e){return e?"gray":"#0000"},border:"solid 2px",borderRadius:4,position:"relative"},setupItem:{border:"2px solid",borderColor:function(e){return e?"darkgray":"#0000"},borderRadius:4,fontSize:20,display:"flex",alignItems:"center",justifyContent:"center"},icon:{cursor:"pointer",width:15,margin:0,padding:"4px 1px",height:"30px",border:"1px solid #0000",borderColor:function(e){return e?"gray":"#0000"}},emoji:{userSelect:"none",fontWeight:function(e){return 3===e?"bold":"unset"},opacity:function(e){return 3===e?1:2===e?.7:.3}}}}));function je(e){var t=e.emoji,n=e.text,r=Object(he.a)(e,["emoji","text"]),i=we(r.value);return a.a.createElement("span",Object.assign({className:i.emoji,role:"img","aria-label":n},r),String.fromCodePoint(t))}function xe(e){var t=e.selectedValue,n=e.value,r=Object(he.a)(e,["selectedValue","value"]),i=we(t===n),s=5*(3-n)+1;return a.a.createElement(ve.a,Object.assign({className:i.icon,viewBox:"1 1 7 15"},r),a.a.createElement("rect",{y:s,width:"9",height:16-s,fill:n<=t?"red":"lightGray"}))}function Ee(e){var t=e.value,n=e.isActive,r=Object(he.a)(e,["value","isActive"]),i=we(n);return a.a.createElement("div",{className:i.setupItem},a.a.createElement(je,Object.assign({},r,{value:3,onClick:function(){return r.onChange((t+1)%4)}})),a.a.createElement(xe,{onClick:function(){return r.onChange(0)},selectedValue:t,value:0}),a.a.createElement(xe,{onClick:function(){return r.onChange(1)},selectedValue:t,value:1}),a.a.createElement(xe,{onClick:function(){return r.onChange(2)},selectedValue:t,value:2}),a.a.createElement(xe,{onClick:function(){return r.onChange(3)},selectedValue:t,value:3}))}function Oe(e){var t=a.a.useState(!1),n=Object(o.a)(t,2),r=n[0],i=n[1],s=a.a.useState(-1),c=Object(o.a)(s,2),u=c[0],l=c[1],h=a.a.useRef(),d=we(r);if(0===e.emojiArray.length)return null;var p=e.emojiArray.filter((function(e){return e.value>0})),f=0;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{tabIndex:0,onFocus:function(t){e.onFocus(t),i(!0)},onBlur:function(t){h.current.contains(document.activeElement)||(i(!1),e.onBlur(t))},className:d.container,onKeyDown:function(t){if("ArrowLeft"===t.key){if(u<0&&l(u=0),u<e.emojiArray.length){var n=Object(q.a)(e.emojiArray);n[u].value--,n[u].value<0&&(n[u].value=3),e.onEmojiArrayChange(n)}}else if("ArrowRight"===t.key){if(u<0&&l(u=0),u<e.emojiArray.length){var r=Object(q.a)(e.emojiArray);r[u].value++,r[u].value>3&&(r[u].value=0),e.onEmojiArrayChange(r)}}else if("ArrowDown"===t.key)++u>=e.emojiArray.length&&(u=0),l(u);else if("ArrowUp"===t.key)--u<0&&(u=e.emojiArray.length-1),l(u);else{if("Escape"!==t.key&&"Enter"!==t.key)return;e.inputRef.current.focus()}t.preventDefault()}},p.length>0?p.map((function(e){return a.a.createElement(je,{key:e.codePoint,emoji:e.codePoint,text:e.text,value:e.value})})):a.a.createElement(ee.a,{variant:"caption",color:"textSecondary"},"add mood"),a.a.createElement(_e,{in:r,ref:h},a.a.createElement(ee.a,{align:"center",variant:"body1"},e.text),e.emojiArray.map((function(t){return a.a.createElement(Ee,{key:t.codePoint,isActive:f++===u,emoji:t.codePoint,text:t.text,value:t.value,onChange:function(n){e.onEmojiArrayChange(e.emojiArray.map((function(e){return e.codePoint===t.codePoint?Object(S.a)(Object(S.a)({},e),{},{value:n}):e})))}})})),a.a.createElement(ee.a,{align:"center",variant:"caption"},"Use arrow keys."))," "))}var Se="loading",Ce="hidden",Ae="deleted",De=function(){function e(t,n,r,a){Object(v.a)(this,e),this._isFresh=!1,this._data=n,this._key=t,this._emojiArrays=null!=r?r:[[],[]],this.isDataLoaded()&&!this.isVacant()&&(this._creationTime=a)}return Object(g.a)(e,[{key:"isDataLoaded",value:function(){return this._data!==Se&&this._data!==Ce}},{key:"isVacant",value:function(){return this.isDataLoaded()&&(this.data===Ae||this._emojiArrays.every((function(e){return 0===e.length}))&&""===this.left&&""===this.right)}},{key:"resetIsFresh",value:function(){if(!this._isFresh)return this;var t=new e(this._key,this._data,this._emojiArrays,this._creationTime);return t._isFresh=!1,t}},{key:"setLeft",value:function(t){return this.isDataLoaded()?new e(this._key,Object(S.a)(Object(S.a)({},this._data),{},{left:t}),this._emojiArrays,this._creationTime):(console.error("bad status"),this)}},{key:"setRight",value:function(t){return this.isDataLoaded()?new e(this._key,Object(S.a)(Object(S.a)({},this._data),{},{right:t}),this._emojiArrays,this._creationTime):(console.error("bad status"),this)}},{key:"delete",value:function(){return new e(this._key,Ae)}},{key:"clear",value:function(){return new e(this._key,{left:"",right:"",description:""})}},{key:"show",value:function(){return new e(this._key,Se)}},{key:"setEmojiArrays",value:function(t,n){return this.setDescription(e._generateDescription(t,n,this._creationTime))}},{key:"setCreationTime",value:function(t){var n=this.setDescription(e._generateDescription(this._emojiArrays[0],this._emojiArrays[1],t));return n._isFresh=!0,n}},{key:"setDescription",value:function(t){if(!this.isDataLoaded())return this;var n,r=[[],[]];if("string"===typeof t){var a=t.split("-"),i=Object(o.a)(a,2),s=i[0],c=i[1],u=Array.from(s).map((function(e){return Number(e)})),l=Math.ceil(u.length/2);r=[u.slice(0,l),u.slice(l)],n=new Date(Number(c)),isNaN(n.getTime())&&(n=null)}return new e(this._key,Object(S.a)(Object(S.a)({},this._data),{},{description:t}),r,n)}},{key:"data",get:function(){return this._data instanceof Object?Object(S.a)({},this._data):this._data}},{key:"key",get:function(){return this._key}},{key:"description",get:function(){return this.isDataLoaded()?this._data.description:""}},{key:"left",get:function(){return this.isDataLoaded()?this._data.left:""}},{key:"right",get:function(){return this.isDataLoaded()?this._data.right:""}},{key:"emojiArrays",get:function(){return this._emojiArrays}},{key:"creationTime",get:function(){return this._creationTime}},{key:"isFresh",get:function(){return this._isFresh}}]),Object(g.a)(e,null,[{key:"_generateDescription",value:function(e,t,n){var r;return r=e.every((function(e){return 0===e}))&&t.every((function(e){return 0===e}))?"":e.join("")+t.join(""),null!=n&&(r=r+"-"+n.getTime()),r}}]),e}(),Ie=Object(V.a)((function(e){return{inner:{display:"flex",flex:1,flexDirection:"column",position:"relative"},input:{padding:0,minHeight:70,alignItems:"flex-start"},outer:{display:"flex",alignItems:"flex-start",flexDirection:"row",border:"solid",padding:function(e){return e?4:5},borderWidth:function(e){return!0===e?2:1},borderColor:function(t){return!0===t?e.palette.primary.light:"gray"},borderRadius:4},date:{border:"0px !important"},hint:{whiteSpace:"pre-line"}}}));function Me(e){var t=e.onFocus,n=e.emojiText,r=e.emojiArray,i=e.onDelete,s=e.isFirst,c=e.creationTime,u=e.onEmojiArrayChange,l=Object(he.a)(e,["onFocus","emojiText","emojiArray","onDelete","isFirst","creationTime","onEmojiArrayChange"]),h=a.a.useState(!1),d=Object(o.a)(h,2),p=d[0],f=d[1],m=a.a.useState(!1),y=Object(o.a)(m,2),b=y[0],v=y[1],g=Ie(p||b),k=a.a.useRef();return a.a.createElement("div",{className:g.outer},a.a.createElement("div",{className:g.inner},c&&a.a.createElement(ee.a,{variant:"caption",color:"textSecondary",align:"center"},be()(c).format("h:mm a")),a.a.createElement(de.a,Object.assign({className:g.input,fullWidth:!0,multiline:!0,variant:"outlined",inputRef:k,onFocus:function(e){f(!0),t(e)},onBlur:function(e){f(!1)}},l)),a.a.createElement(Oe,{text:n,onEmojiArrayChange:u,emojiArray:r,inputRef:k,onFocus:function(e){t(e),v(!0)},onBlur:function(e){v(!1)}}),null!=l.hint&&l.hint.isEnabled&&a.a.createElement(_e,{in:p},a.a.createElement(ee.a,{className:g.hint,color:"textSecondary",padding:10},l.hint.text))),!!i&&a.a.createElement(ne.a,{"aria-label":"delete",size:"small",onClick:i},a.a.createElement(me.a,{color:s?"disabled":"action",fontSize:"small"})))}var Le=a.a.forwardRef((function(e,t){var n=e.scrollableContainerRef,r=e.isFirst,i=e.onUpdate,s=(e.onRightChanged,e.entry),o=e.settings,c=Object(he.a)(e,["scrollableContainerRef","isFirst","onUpdate","onRightChanged","entry","settings"]),u=Ie();if(s instanceof Date){var l=be()(s).calendar({sameDay:"[Today], MMM Do, ddd",lastDay:"[Yesterday] , MMM Do, ddd",lastWeek:"MMM Do YYYY, ddd",sameElse:"MMM Do YYYY, ddd"});return a.a.createElement("tr",{ref:t,className:u.date},a.a.createElement("td",{colSpan:2},a.a.createElement(ee.a,{variant:"body2",align:"center",color:"textSecondary"},l)," "))}console.assert(s instanceof De),a.a.useEffect((function(){s.isFresh&&!r&&(n.current.scrollTop=t.current.offsetTop-60,i(s.resetIsFresh())),s.data===Ce&&i(s.show())}));var h=[],d=[];if(null!=o)for(var p=0;p<o.emojiList.length;p++)h.push(Object(S.a)({value:null==s.emojiArrays[0][p]?0:s.emojiArrays[0][p]},o.emojiList[p])),d.push(Object(S.a)({value:null==s.emojiArrays[1][p]?0:s.emojiArrays[1][p]},o.emojiList[p]));var f=function(e){r&&(e=e.setCreationTime(new Date(Date.now()))),i(e)};return a.a.createElement("tr",{ref:t},a.a.createElement("td",{key:"issueElement"},a.a.createElement("h5",null,"issue"),s.isDataLoaded()?a.a.createElement(Me,Object.assign({color:"secondary",creationTime:!r&&s.creationTime,placeholder:r?"Start typing to create a new item.":"What bothers you?",value:s.left,onChange:function(e){return f(s.setLeft(e.target.value))},hint:null==o?null:o.leftHint,emojiText:"How do you feel now?",emojiArray:h,onEmojiArrayChange:function(e){return f(s.setEmojiArrays(e.map((function(e){return e.value})),d.map((function(e){return e.value}))))}},c)):a.a.createElement(pe.a,{variant:"rect",height:56})),a.a.createElement("td",{key:"resolutionElement"},a.a.createElement("h5",null,"resolution"),s.isDataLoaded()?a.a.createElement(Me,Object.assign({color:"primary",placeholder:r?"Start typing to create a new item.":"What can you do to resolve the problem?",isFirst:r,variant:"outlined",value:s.right,onDelete:function(e){return i(s.delete())},onChange:function(e){return f(s.setRight(e.target.value))},hint:null==o?null:o.rightHint,emojiText:"How do you feel after writing resolution?",emojiArray:d,onEmojiArrayChange:function(e){return f(s.setEmojiArrays(h.map((function(e){return e.value})),e.map((function(e){return e.value}))))}},c)):a.a.createElement(pe.a,{variant:"rect",height:56})))}));function Fe(e,t,n){return Ke.apply(this,arguments)}function Ke(){return(Ke=Object(b.a)(y.a.mark((function e(t,n,r){var a,i,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){t.subscribe((function n(r){r.every((function(e){return e.isDataLoaded()}))&&(t.unsubscribe(n),e(r)),r.forEach((function(e){e.data===Ce&&t.onUpdate(e.show())}))}))}));case 2:return a=e.sent,i=!1,s=a.map((function(e){var t=e.emojiArrays.map((function(e){return Be(e,n,r)}));return t.some((function(e){return e.someValuesAreDeleted}))&&(i=!0),e.setEmojiArrays(t[0].newArray,t[1].newArray)})),e.abrupt("return",{someValuesAreDeleted:i,newEntries:s});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Be(e,t,n){for(var r=new Map,a=0;a<t.length;a++)r.set(t[a].codePoint,e[a]);for(var i=[],s=0;s<n.length;s++){var o=r.get(n[s].codePoint);i.push(null==o?0:o)}return{newArray:i,someValuesAreDeleted:t.some((function(e){return r.get(e.codePoint)>0&&null==n.find((function(t){return t.codePoint===e.codePoint}))}))}}var Pe=a.a.memo(se.a),Ne=Object(V.a)((function(e){return{root:Object(W.a)({position:"absolute",top:"5%",left:"5%",width:"90%",height:"90%",backgroundColor:e.palette.background.paper,zIndex:1e3,borderRadius:4,overflow:"auto",padding:10},e.breakpoints.up("sm"),{padding:30}),emojiIcon:{margin:"0px 5px 5px 0px ",fontSize:20,display:"flex",alignItems:"center",paddingLeft:10},hintContainer:{display:"flex",flexDirection:"column"},button:{paddingTop:20},backdrop:{zIndex:1002}}}));function Re(e){var t=Ne();return a.a.createElement("div",{className:t.hintContainer},a.a.createElement(J.a,{value:"end",label:e.label,control:a.a.createElement(Y.a,{checked:e.value.isEnabled,onChange:function(t){e.onChange(e.value.setIsEnabled(t.target.checked))}})}),a.a.createElement($.a,{value:e.value.text,onChange:function(t){return e.onChange(e.value.setText(t.target.value))},disabled:!e.value.isEnabled,variant:"outlined",multiline:!0}))}function Te(e){var t=Ne(),n=a.a.useState(E.state),r=Object(o.a)(n,2),i=r[0],s=r[1],c=a.a.useState(null),u=Object(o.a)(c,2),l=u[0],h=u[1],d=a.a.useState(!1),p=Object(o.a)(d,2),f=p[0],m=p[1];a.a.useEffect((function(){E.addStateListener(s)}),[]),a.a.useEffect((function(){var t=function(e,t){h((function(e){return null==e?t:e}))};return null!=e.model&&e.model.subscribe(t),function(){null!=e.model&&e.model.unsubscribe(t)}}),[e.model]);var v=a.a.useCallback((function(t,n){h((function(t){var r=n.emoji.codePointAt(0),a=n.names.length>0?n.names[n.names.length-1]:"";if(-1!==t.emojiList.findIndex((function(e){return e.codePoint===r})))return alert(a+" is already selected"),t;var i=Object(q.a)(t.emojiList);i.push({codePoint:r,text:a});var s=t.setEmojiList(i);e.model.onSettingsUpdate(s),h(s)}))}),[e.model]);if(i===w.SIGNED_OUT)return a.a.createElement(ce,null,"Sign in to proceed...");if(i===w.LOADING||null==l||null==e.model)return a.a.createElement(ce,null,"Loading...");var g=function(){var t=Object(b.a)(y.a.mark((function t(n){var r,a,i,s,o,c;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Object(q.a)(l.emojiList),-1!==(a=r.findIndex((function(e){return e.codePoint===n})))){t.next=4;break}return t.abrupt("return");case 4:return r.splice(a,1),m(!0),t.next=8,Fe(e.model,l.emojiList,r);case 8:if(i=t.sent,s=i.someValuesAreDeleted,o=i.newEntries,m(!1),!s||window.confirm("This will delete some moods from some of the entries. Are you sure?")){t.next=14;break}return t.abrupt("return");case 14:o.forEach((function(t){e.model.onUpdate(t)})),c=l.setEmojiList(r),e.model.onSettingsUpdate(c),h(c);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),k=function(){var t=Object(b.a)(y.a.mark((function t(){var n,r,a,i,s;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new le,m(!0),t.next=4,Fe(e.model,l.emojiList,n.emojiList);case 4:r=t.sent,a=r.someValuesAreDeleted,i=r.newEntries,m(!1),s=a?"This will delete some moods from some entries. Reset settings?":"Reset settings?",window.confirm(s)&&(i.forEach((function(t){e.model.onUpdate(t)})),e.model.onSettingsUpdate(n),h(n));case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return a.a.createElement(Q.a,{container:!0,spacing:4},a.a.createElement(X.a,{className:t.backdrop,open:f},a.a.createElement(Z.a,{color:"inherit"})),a.a.createElement(Q.a,{item:!0,xs:12},a.a.createElement(ee.a,{variant:"h4",align:"center"},"Settings")),a.a.createElement(Q.a,{item:!0,xs:12},a.a.createElement(ee.a,{variant:"h5"},"Hints:")),a.a.createElement(Q.a,{item:!0,xs:12,sm:6},a.a.createElement(Re,{label:"Left",value:l.leftHint,onChange:function(t){var n=l.setLeftHint(t);e.model.onSettingsUpdate(n),h(n)}})),a.a.createElement(Q.a,{item:!0,xs:12,sm:6},a.a.createElement(Re,{label:"Right",value:l.rightHint,onChange:function(t){var n=l.setRightHint(t);e.model.onSettingsUpdate(n),h(n)}})),a.a.createElement(Q.a,{container:!0,alignItems:"flex-start",justify:"flex-start",alignContent:"flex-start",item:!0,xs:12,sm:6},a.a.createElement(Q.a,{item:!0,xs:12},a.a.createElement(ee.a,{variant:"h5"},"Moods: ")),l.emojiList.map((function(e){return a.a.createElement(Q.a,{item:!0,key:e.codePoint},a.a.createElement(te.a,{className:t.emojiIcon},a.a.createElement(ee.a,null,String.fromCodePoint(e.codePoint)),a.a.createElement(ne.a,{onClick:function(){return g(e.codePoint)}},a.a.createElement(ae.a,null))))}))),a.a.createElement(Q.a,{item:!0,xs:12,sm:6},a.a.createElement(ee.a,{variant:"h5"},"Add new:"),a.a.createElement(Pe,{disableSkinTonePicker:!0,disableAutoFocus:!0,onEmojiClick:v})),a.a.createElement(Q.a,{item:!0,xs:12},a.a.createElement(re.a,{className:t.button,color:"secondary",onClick:k},"Reset defaults")))}var ze=a.a.forwardRef((function(e,t){var n=Ne();return a.a.createElement("div",Object.assign({className:n.root},e,{ref:t}),a.a.createElement(Te,e))})),He=n(211),Ve=n(214),Ue=n(216),Ge=n(223),qe=n(209),We=n(210),Je=n(212),Ye=n(213),$e=n(224),Qe=Object(V.a)({placeholder:{flex:1},showAppBarButton:{position:"fixed",top:0,left:"50%",transform:"translate(-50%, -30%)",zIndex:2e3}});function Xe(e){var t=a.a.useState(!1),n=Object(o.a)(t,2),r=n[0],i=n[1];a.a.useEffect((function(){e.model&&e.model.setIgnoreKeys(r)}),[r,e.model]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(ne.a,Object.assign({},e,{onClick:function(){i(!0)}}),e.children[0]),a.a.createElement(Ge.a,{open:r,onClose:function(){null!=e.model&&(e.model.sync(),e.model.setIgnoreKeys(!1)),i(!1)}},e.children[1]))}function Ze(e){var t=Qe();return a.a.createElement(a.a.Fragment,null,a.a.createElement(qe.a,{appear:!1,in:e.shown},a.a.createElement(We.a,null)),!e.shown&&a.a.createElement(ne.a,{className:t.showAppBarButton,onClick:e.onShow},a.a.createElement(He.a,{color:"primary",fontSize:"large"})),a.a.createElement(Je.a,{appear:!1,direction:"down",in:e.shown},a.a.createElement(Ye.a,null,a.a.createElement(We.a,null,a.a.createElement(Xe,{model:e.model,edge:"start"},a.a.createElement(Ve.a,null),a.a.createElement(ze,{model:e.model})),a.a.createElement($e.a,{xsDown:!0},a.a.createElement(ee.a,null,"Settings")),a.a.createElement(ee.a,{className:t.placeholder,variant:"body2",align:"center"},"Self-help sheets",a.a.createElement($e.a,{xsDown:!0},a.a.createElement("br",null),"Document your inner dialog")),a.a.createElement(Xe,null,a.a.createElement(Ue.a,null),a.a.createElement(G,null)),a.a.createElement(H,{gdriveAuthClient:E})))))}var et=n(109),tt=n.n(et),nt=n(50),rt=n.n(nt),at=n(7),it=Object(_.a)("onHeightChanged"),st=Object(_.a)("resizeObserver"),ot=function(e){Object(A.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(v.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).ref=a.a.createRef(),Object.defineProperty(Object(C.a)(e),it,{writable:!0,value:function(){e.ref.current&&e.props.onHeightChanged(e.props.entry,e.ref.current.offsetHeight)}}),Object.defineProperty(Object(C.a)(e),st,{writable:!0,value:null}),e}return Object(g.a)(n,[{key:"componentDidMount",value:function(){this.ref.current&&(Object(k.a)(this,st)[st]=new ResizeObserver(Object(k.a)(this,it)[it]),Object(k.a)(this,st)[st].observe(this.ref.current))}},{key:"componentWillUnmount",value:function(){this.ref.current.contains(document.activeElement)&&this.props.scrollableContainerRef.current&&this.props.scrollableContainerRef.current.focus(),Object(k.a)(this,st)[st]&&(Object(k.a)(this,st)[st].disconnect(),Object(k.a)(this,st)[st]=null)}},{key:"render",value:function(){var e=this.props,t=e.ItemComponent,n=(e.onHeightChanged,Object(he.a)(e,["ItemComponent","onHeightChanged"]));return a.a.createElement(t,Object.assign({ref:this.ref},n))}}]),n}(a.a.PureComponent);function ct(e){var t=e.entries,n=e.defaultHeight,r=void 0===n?150:n,i=e.scrollableContainerRef,s=e.ItemComponent,c=e.PlaceholderComponent,u=Object(he.a)(e,["entries","defaultHeight","scrollableContainerRef","ItemComponent","PlaceholderComponent"]),l=a.a.useState(0),h=Object(o.a)(l,2),d=h[0],p=h[1],m=a.a.useState(window.innerHeight),y=Object(o.a)(m,2),b=y[0],v=y[1],g=a.a.useState(new Map),k=Object(o.a)(g,2),_=k[0],w=k[1],j=a.a.useCallback((function(e,t){w((function(n){var r=new Map(n);return r.set(e.key,t),r}))}),[]),x=new Set(t.map((function(e){return e.key}))),E=[];_.forEach((function(e,t){x.has(t)||E.push(t)})),E.length>0&&w((function(e){var t=new Map(e);return E.forEach((function(n){e.has(n)&&t.delete(n)})),t}));var O=function(){i.current&&p(i.current.scrollTop),v(window.innerHeight)};a.a.useEffect((function(){return i.current&&(i.current.onscroll=O),window.addEventListener("resize",O),function(){window.removeEventListener("resize",O)}}));var S,C=[],A=0,D=0,I=0,M=!0,L=Object(f.a)(t);try{for(L.s();!(S=L.n()).done;){var F=S.value,K=r;_.has(F.key)&&(K=_.get(F.key)),A+K<d-window.innerHeight?D+=K:A<d+2*b?C.push(a.a.createElement(ot,Object.assign({key:F.key,isFirst:M,onHeightChanged:j,entry:F,ItemComponent:s,scrollableContainerRef:i},u))):I+=K,A+=K,M=!1}}catch(B){L.e(B)}finally{L.f()}return 0!==D&&C.unshift(a.a.createElement(c,{height:D,key:"placeholderTop"})),0!==I&&C.push(a.a.createElement(c,{height:I,key:"placeholderBottom"})),C}function ut(e){var t=e.height,n=Object(he.a)(e,["height"]);return a.a.createElement("tr",n,a.a.createElement("td",{colSpan:"2"},a.a.createElement("div",{style:{height:t}})))}var lt=function(e){Object(A.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(v.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={entries:[]},e._onEntriesChanged=function(t,n){if(t.length>1)for(var r=(t=Object(q.a)(t))[t.length-1].creationTime,a=t.length-2;a>=0;a--){var i=t[a].creationTime;null!=r?null!=i&&i.getYear()===r.getYear()&&i.getMonth()===r.getMonth()&&i.getDay()===r.getDay()||(r.key="time"+r.getTime(),t.splice(a+1,0,r),r=i):r=t[a].creationTime}e.setState({entries:t,settings:n})},e._tableRef=a.a.createRef(),e._scrollableContainerRef=a.a.createRef(),e._columnResizer=null,e._resizeObserver=null,e}return Object(g.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.model.subscribe(this._onEntriesChanged),this._columnResizer=new tt.a(this._tableRef.current,{liveDrag:!0,minWidth:100,gripInnerHtml:"<div class='".concat(this.props.classes.grip,"'></div>"),onResize:function(e){window.dispatchEvent(new Event("resize"))}}),window.removeEventListener("resize",this._columnResizer.onResize),this._resizeObserver=new ResizeObserver(rt.a.throttle((function(){e._columnResizer.onResize()}),200)),this._resizeObserver.observe(this._tableRef.current)}},{key:"componentDidUpdate",value:function(e){this.props.model!==e.model&&(e.model.unsubscribe(this._onEntriesChanged),this.props.model.subscribe(this._onEntriesChanged))}},{key:"componentWillUnmount",value:function(){this.props.model.unsubscribe(this._onEntriesChanged),this._columnResizer.destroy(),this._resizeObserver.unobserve(this._tableRef.current)}},{key:"render",value:function(){return a.a.createElement("div",{ref:this._scrollableContainerRef,className:this.props.classes.container,tabIndex:0},a.a.createElement("table",{cellPadding:0,cellSpacing:0,className:this.props.classes.entriesTable,ref:this._tableRef},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,a.a.createElement("div",null,"issue")),a.a.createElement("th",null,a.a.createElement("div",null,"resolution")))),a.a.createElement("tbody",null,a.a.createElement(ct,{entries:this.state.entries,ItemComponent:Le,PlaceholderComponent:ut,scrollableContainerRef:this._scrollableContainerRef,onUpdate:this.props.model.onUpdate,onFocus:this.props.onFocus,settings:this.state.settings}))))}}]),n}(a.a.PureComponent),ht=Object(at.a)((function(e){return{container:{overflow:"auto",flex:1,willChange:"transform"},grip:{width:10,marginLeft:5,position:"absolute",height:"100%",backgroundColor:"#0000",cursor:"col-resize"},entriesTable:Object(W.a)({width:"100%",borderSpacing:0,"& th":{backgroundColor:e.palette.background.paper,zIndex:3,top:0,position:"sticky",borderSpacing:0,borderBottom:"1px solid #000"},"& td":{padding:2,verticalAlign:"top",overflow:"inherit !important"},"& td:nth-child(even)":{borderLeft:"5px solid #0000"},"& td:nth-child(odd)":{borderRight:"5px solid #0000"},"& h5":{display:"none"}},e.breakpoints.down("xs"),{"& thead":{display:"none"},"& h5":{display:"block",margin:0},"& tbody tr":{display:"grid",padding:5,border:"1px solid #000"},"& td:nth-child(even)":{borderLeft:0},"& td:nth-child(odd)":{borderRight:0},"& tbody td":{display:"block"}})}}))(lt);function dt(e){var t=e.model,n=Object(he.a)(e,["model"]),r=a.a.useState(E.state),i=Object(o.a)(r,2),s=i[0],c=i[1];return a.a.useEffect((function(){E.addStateListener(c)}),[]),s===w.SIGNED_IN&&t?a.a.createElement(ht,Object.assign({},n,{model:t})):s===w.SIGNED_OUT?a.a.createElement(ce,null,"Sign in to proceed..."):a.a.createElement(ce,null," Loading...")}var pt=n(110),ft=function(){function e(){Object(v.a)(this,e)}return Object(g.a)(e,[{key:"requireFunction",value:function(e){var t=this;setTimeout((function(){if("function"!==typeof t[e])throw new Error(e+" is not implemented")}),0)}}]),e}(),mt=function(e){Object(A.a)(n,e);var t=Object(D.a)(n);function n(){var e;return Object(v.a)(this,n),(e=t.call(this)).requireFunction("createKey"),e.requireFunction("delete","key"),e.requireFunction("set","key","contentString"),e.requireFunction("get","key"),e.requireFunction("getMd5","key"),e.requireFunction("getAllKeys"),e.requireFunction("getSettings"),e.requireFunction("setSettings","settings"),e.requireFunction("setDescription","key","description"),e}return n}(ft),yt=Object(_.a)("settings_key"),bt=new(function(e){Object(A.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(v.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object.defineProperty(Object(C.a)(e),yt,{writable:!0,value:null}),e}return Object(g.a)(n,[{key:"_getSettingsKey",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t,n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===Object(k.a)(this,yt)[yt]){e.next=2;break}return e.abrupt("return",Object(k.a)(this,yt)[yt]);case 2:return e.next=4,Dt('name = "settings.json"');case 4:if(0!==(t=e.sent).length){e.next=9;break}return e.next=8,kt("settings.json");case 8:return e.abrupt("return",e.sent);case 9:if(1!==t.length){e.next=11;break}return e.abrupt("return",t[0].id);case 11:return console.error("Invalid state. Multiple settings.json. "),n=Object(pt.a)(t),r=n[0],n.slice(1).map((function(e){return Mt(e.id)})),e.abrupt("return",r.id);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createKey",value:function(){var e=Object(b.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vt(),e.next=3,kt("item.json");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vt(),e.next=3,Mt(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(){var e=Object(b.a)(y.a.mark((function e(t,n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vt(),e.next=3,xt(t,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vt(),e.next=3,Ct(t);case 3:return n=e.sent,console.log(n),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMd5",value:function(){var e=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vt(),e.next=3,Ot(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllKeys",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vt(),e.next=3,Dt('name = "item.json"');case 3:return(t=e.sent).forEach((function(e){e.description||(e.description="")})),console.log(t),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getSettings",value:function(){var e=Object(b.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vt(),e.t0=Ct,e.next=4,this._getSettingsKey();case 4:return e.t1=e.sent,e.next=7,(0,e.t0)(e.t1);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSettings",value:function(){var e=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vt(),e.t0=xt,e.next=4,this._getSettingsKey();case 4:return e.t1=e.sent,e.t2=t,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setDescription",value:function(){var e=Object(b.a)(y.a.mark((function e(t,n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vt(),e.abrupt("return",wt(t,n));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(mt));function vt(){if(E.state!==w.SIGNED_IN)throw new Error("Incorrect state. Sign in to continue.")}function gt(e,t){var n=(new Error).stack;return new Promise((function(r,a){e(t).then((function(e){e&&(e.status<200||e.status>299)?(console.log("GAPI call returned bad status",n,e),a(e)):r(e)}),(function(e){console.log("GAPI call failed ",n,e),a(e)}))}))}function kt(e,t){return _t.apply(this,arguments)}function _t(){return(_t=Object(b.a)(y.a.mark((function e(t,n){var r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gt(window.gapi.client.drive.files.create,{resource:{name:t,mimeType:n||"text/plain",parents:["appDataFolder"]},fields:"id"});case 2:return r=e.sent,e.abrupt("return",r.result.id);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wt(e,t){return jt.apply(this,arguments)}function jt(){return(jt=Object(b.a)(y.a.mark((function e(t,n){var r,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.assert("string"===typeof n),"\r\n--"+(r="-------314159265358979323846")+"\r\n","\r\n--"+r+"--",a="\r\n---------314159265358979323846\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify({description:n})+"\r\n---------314159265358979323846--",e.next=7,gt(window.gapi.client.request,{path:"/upload/drive/v3/files/".concat(t),method:"PATCH",params:{uploadType:"multipart"},body:a,headers:{"Content-Type":'multipart/mixed; boundary="'+r+'"'}});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xt(e,t){return Et.apply(this,arguments)}function Et(){return(Et=Object(b.a)(y.a.mark((function e(t,n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.assert("string"===typeof n),e.next=3,gt(window.gapi.client.request,{path:"/upload/drive/v3/files/".concat(t),method:"PATCH",params:{uploadType:"media"},fields:"md5Checksum",body:n});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ot(e){return St.apply(this,arguments)}function St(){return(St=Object(b.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gt(window.gapi.client.request,{path:"/drive/v3/files/".concat(t),method:"GET",params:{fields:"md5Checksum"}});case 2:return n=e.sent,e.abrupt("return",n.result.md5Checksum);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ct(e){return At.apply(this,arguments)}function At(){return(At=Object(b.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,gt(window.gapi.client.drive.files.get,{fileId:t,alt:"media"});case 3:return n=e.sent,e.abrupt("return",n.body);case 7:if(e.prev=7,e.t0=e.catch(0),404===e.t0.status){e.next=11;break}throw e.t0;case 11:return e.abrupt("return",void 0);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function Dt(e){return It.apply(this,arguments)}function It(){return(It=Object(b.a)(y.a.mark((function e(t){var n,r,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=[];case 2:return e.next=4,gt(window.gapi.client.drive.files.list,{spaces:"appDataFolder",fields:"files(*), nextPageToken",pageSize:1e3,pageToken:r,orderBy:"createdTime",q:t});case 4:a=e.sent,n=n.concat(a.result.files),r=a.result.nextPageToken;case 7:if(r){e.next=2;break}case 8:return e.abrupt("return",n);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function Mt(e){return Lt.apply(this,arguments)}function Lt(){return(Lt=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,gt(window.gapi.client.drive.files.delete,{fileId:t});case 3:return e.abrupt("return",!0);case 6:if(e.prev=6,e.t0=e.catch(0),404!==e.t0.status){e.next=10;break}return e.abrupt("return",!1);case 10:throw e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}Object.seal(bt);var Ft=function(e){Object(A.a)(n,e);var t=Object(D.a)(n);function n(e,r){var a;return Object(v.a)(this,n),console.assert(e instanceof mt),(a=t.call(this)).sync=Object(b.a)(y.a.mark((function e(){var t,n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a._disposed){e.next=2;break}return e.abrupt("return");case 2:if(a._authClient.state===w.SIGNED_IN){e.next=7;break}return e.next=5,a._authClient.waitForStateChange();case 5:e.next=2;break;case 7:return e.next=9,a._backendMap.getAllKeys();case 9:return t=e.sent,n=new Map,t.forEach((function(e){var r;a._entries.has(e.id)?r=a._entries.get(e.id):(e.outdated=!0,r=new De(e.id,n.size<t.length-30?Ce:Se)),r.isDataLoaded()&&r.data!==Ae&&e.description!==a._descriptions.get(e.id)&&(r=r.setDescription(e.description)),n.set(e.id,r),a._descriptions.set(e.id,e.description)})),(r=[]).push(a._fetchSettings()),t.reverse().forEach((function(e){e.outdated&&n.get(e.id).data!==Ce&&r.push(a._fetch(e.id))})),a._entries.has(null)&&n.set(null,a._entries.get(null)),a._entries=n,a._onEntriesChanged(),e.next=20,Promise.all(r);case 20:case"end":return e.stop()}}),e)}))),a.onSettingsUpdate=rt.a.debounce((function(e){a._backendMap.setSettings(e.stringify())}),1e3),a.onUpdate=function(e){if(a._entries.has(e.key)){var t=a._entries.get(e.key);e.data!==Se?(a._sendEntryToBackend(e),a._addHistoryItem(e),a._entries.set(e.key,e),a._onEntriesChanged()):t.data===Ce&&(a._fetch(e.key),a._entries.set(e.key,e))}},a._disposed=!1,a._historyIndex=0,a._history=[],a._authClient=null,a._backendMap=null,a._entries=new Map,a._settings=null,a._descriptions=new Map,a._subscriptions=new Set,a._syncLoop=Object(b.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.sync();case 2:setTimeout(a._syncLoop,15e3);case 3:case"end":return e.stop()}}),e)}))),a._onKeyPress=function(e){if(!a._ignoreKeys&&e.ctrlKey){if(90===e.keyCode)a.undo();else{if(89!==e.keyCode)return;a.redo()}e.preventDefault()}},a._fetch=function(){var e=Object(b.a)(y.a.mark((function e(t){var n,r,i,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a._backendMap.get(t);case 2:if(n=e.sent,a._entries.has(t)){e.next=6;break}return console.error("Entry for fetch doesn't exist anymore. "+t),e.abrupt("return");case 6:if(void 0!==n){e.next=11;break}return console.error("Key "+t+" is missing"),a._entries.delete(t),a._onEntriesChanged(),e.abrupt("return");case 11:if(e.prev=11,""!==n){e.next=18;break}r=new De(t,{}).delete(),a._addHistoryItem(r),a._entries.set(t,r),e.next=25;break;case 18:if((i=JSON.parse(n))===Ae||null!=i.left&&null!=i.right){e.next=21;break}throw new Error("bad format "+n);case 21:s=new De(t,i),i!==Ae&&(s=s.setDescription(a._descriptions.get(t))),a._addHistoryItem(s),a._entries.set(t,s);case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(11),console.error(e.t0.message+" "+t+" "+n),a._entries.get(t).isDataLoaded()||(a._entries.delete(t),a._descriptions.delete(t),a._backendMap.delete(t));case 31:a._onEntriesChanged();case 32:case"end":return e.stop()}}),e,null,[[11,27]])})));return function(t){return e.apply(this,arguments)}}(),a._onEntriesChanged=Object(b.a)(y.a.mark((function e(){var t,n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=a._getFilteredEntriesArray()).length>0&&a._notifySubscribers(t),0!==t.length&&(!t[0].isDataLoaded()||t[0].isVacant())){e.next=19;break}if(!a._entries.has(null)){e.next=5;break}return e.abrupt("return");case 5:return a._entries.set(null,new De(null,{}).delete()),e.next=8,a._backendMap.createKey();case 8:if(n=e.sent,a._entries.has(null)){e.next=11;break}throw new Error("A null key should persist until the new key is created");case 11:return r=new De(n,a._entries.get(null).data),a._entries.set(n,r),e.next=15,a._sendEntryToBackend(r);case 15:return a._entries.delete(null),e.next=18,a._onEntriesChanged();case 18:return e.abrupt("return");case 19:case"end":return e.stop()}}),e)}))),a._backendMap=e,a._authClient=r,a._syncLoop(),window.addEventListener("keydown",a._onKeyPress),a}return Object(g.a)(n,[{key:"dispose",value:function(){this._disposed=!0,window.removeEventListener("keydown",this._onKeyPress),this._subscriptions=new Set}},{key:"subscribe",value:function(e){this._subscriptions.add(e),this._entries.size>0&&e(this._getFilteredEntriesArray(),this._settings)}},{key:"unsubscribe",value:function(e){this._subscriptions.delete(e)}},{key:"undo",value:function(){if(0!==this._historyIndex){this._historyIndex--;var e=this._history[this._historyIndex].old;this._entries.set(e.key,e),this._sendEntryToBackend(e),this._onEntriesChanged()}}},{key:"redo",value:function(){if(!(this._historyIndex>=this._history.length)){var e=this._history[this._historyIndex++].new;this._entries.set(e.key,e),this._sendEntryToBackend(e),this._onEntriesChanged()}}},{key:"setIgnoreKeys",value:function(e){this._ignoreKeys=e}},{key:"_addHistoryItem",value:function(e){if(null==e.key)throw new Error("null key shouldn't have value. There is no point to restore it.");this._entries.has(e.key)&&this._entries.get(e.key).isDataLoaded()&&(this._history=this._history.slice(0,this._historyIndex),this._history.push({old:this._entries.has(e.key)?this._entries.get(e.key):new De(e.key,{}).delete(),new:e}),this._historyIndex=this._history.length)}},{key:"_sendEntryToBackend",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n,r,a,i;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,r=n.description,a=Object(he.a)(n,["description"]),t.data===Ae&&(a=Ae,r=""),i=null,r!==this._descriptions.get(t.key)&&(i=this._backendMap.setDescription(t.key,r),this._descriptions.set(t.key,r)),e.next=6,Promise.all([i,this._backendMap.set(t.key,JSON.stringify(a))]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchSettings",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._backendMap.getSettings();case 2:if(t=e.sent,this._serializedSettings!==t){e.next=5;break}return e.abrupt("return");case 5:this._serializedSettings=t,this._settings=new le(t),this._onEntriesChanged();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getFilteredEntriesArray",value:function(){var e,t=Array.from(this._entries.values()).reverse(),n=-1,r=Object(f.a)(t);try{for(r.s();!(e=r.n()).done;){if(!e.value.isVacant())break;n++}}catch(i){r.e(i)}finally{r.f()}var a=t.slice(n>0?n:0);return 0===a.length?a:(a[0].data===Ae&&(null!=this._cachedFirstEmptyItem&&this._cachedFirstEmptyItem.key===a[0].key||(this._cachedFirstEmptyItem=a[0].clear()),a[0]=this._cachedFirstEmptyItem),a=a.filter((function(e){return e.data!==Ae&&null!==e.key})))}},{key:"_notifySubscribers",value:function(e){var t=this;this._subscriptions.forEach((function(n){n(e,t._settings)}))}}]),n}(function(e){Object(A.a)(n,e);var t=Object(D.a)(n);function n(){var e;return Object(v.a)(this,n),(e=t.call(this)).requireFunction("subscribe","callback"),e.requireFunction("unsubscribe","callback"),e.requireFunction("onUpdate","entry"),e.requireFunction("onSettingsUpdate","settings"),e.requireFunction("setIgnoreKeys","ignoreKeys"),e.requireFunction("undo"),e.requireFunction("redo"),e.requireFunction("sync"),e}return n}(ft)),Kt=n(88),Bt=n.n(Kt),Pt=n(113),Nt=n(111),Rt=n.n(Nt);var Tt=function(e){Object(A.a)(n,e);var t=Object(D.a)(n);function n(e){var r;if(Object(v.a)(this,n),(r=t.call(this))._changeKeysMutex=new Pt.a,r._innerKeys=null,r._innerBackendMap=null,r._createChunkConnector=function(e){return{setValue:function(t){r._innerBackendMap.set(e,t)},setDescription:function(t){r._innerBackendMap.setDescription(e,t)},getValue:function(){var t=Object(b.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r._innerBackendMap.get(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),delete:function(){var t=Object(b.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r._innerKeys.splice(r._innerKeys.indexOf(e),1),r._chunks.delete(e),t.next=4,r._innerBackendMap.delete(e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},r._chunks=new Map,r._Chunk=function(){function e(t){var n=this,r=t.connector,a=t.serializedDescriptions;Object(v.a)(this,e),this._onValueSet=rt.a.debounce((function(){n._serializedValues=JSON.stringify(n._values),n._connector.setValue(n._serializedValues)}),1e3),this._onDescriptionSet=rt.a.debounce((function(){n._serializedDescriptions=n._descriptions.map((function(e){return null===e?"null":e})).join(","),n._connector.setDescription(n._serializedDescriptions)}),1e3),this._fetchValuesSynchronised=Object(b.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==n._fetchPromise&&(n._fetchPromise=n._fetchValues()),e.next=3,n._fetchPromise;case 3:n._fetchPromise=null;case 4:case"end":return e.stop()}}),e)}))),this._fetchPromise=null,this._fetchValues=Object(b.a)(y.a.mark((function e(){var t,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._connector.getValue();case 2:if(t=e.sent,e.prev=3,r=JSON.parse(t),Array.isArray(r)){e.next=7;break}throw new Error("Bad server data. Not valid array");case 7:for(;r.length<n._descriptions.length;)r.push("");n._values=r,n._serializedValues=t,n._initialMd5Checksum=Bt()(t),n._isDirty=!1,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),console.error("Bad response from server:"+e.t0.message+" "+t),n._shouldKeepOnFormatError?(n._values=Array(8).fill(""),n._isDirty=!0,n._serializedValues=null,n._onValueSet()):n._connector.delete();case 18:case"end":return e.stop()}}),e,null,[[3,14]])}))),this._connector=r,void 0===a?(this._values=Array(8).fill(""),this._descriptions=[],this._isDirty=!0):(this._serializedDescriptions=a,this._isDirty=!1,this._descriptions=a.split(",").map((function(e){return"null"===e?null:e})))}return Object(g.a)(e,[{key:"isFull",value:function(){return this._descriptions.length>=8}},{key:"listSubKeys",value:function(){for(var e=[],t=0;t<this._descriptions.length&&t<8;t++)null!=this._descriptions[t]&&e.push(t);return e}},{key:"createSubKey",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._shouldKeepOnFormatError=!0,e.prev=1,null!=this._values){e.next=5;break}return e.next=5,this._fetchValuesSynchronised();case 5:if(null!=this._values){e.next=7;break}return e.abrupt("return",null);case 7:if(!this.isFull()){e.next=9;break}throw new Error("Do not call createSubKey for full chunks");case 9:return t=this._descriptions.length,this._descriptions.push(""),this.setDescription(t,""),e.abrupt("return",t);case 13:return e.prev=13,this._shouldKeepOnFormatError=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[1,,13,16]])})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this._descriptions[t]){e.next=2;break}throw new Error("item is already deleted");case 2:if(1!==this._descriptions.filter((function(e){return null!=e})).length){e.next=7;break}return e.next=5,this._connector.delete();case 5:e.next=8;break;case 7:this.setDescription(t,null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setValue",value:function(){var e=Object(b.a)(y.a.mark((function e(t,n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this._values){e.next=3;break}return e.next=3,this._fetchValuesSynchronised();case 3:if(null!=this._values){e.next=5;break}return e.abrupt("return");case 5:this._values[t]=n,this._isDirty=!0,this._serializedValues=null,this._onValueSet();case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getValue",value:function(){var e=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._descriptions[t]){e.next=2;break}return e.abrupt("return",void 0);case 2:if(null!=this._values){e.next=5;break}return e.next=5,this._fetchValuesSynchronised();case 5:if(null!=this._values){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.abrupt("return",this._values[t]);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setDescription",value:function(e,t){if(e>=this._descriptions.length||null==this._descriptions[e])throw new Error("null description means subkey doesn't exist. Did you call createKey?");this._descriptions[e]=t,this._serializedDescriptions=null,this._isDirty=!0,this._onDescriptionSet()}},{key:"getDescription",value:function(e){return this._descriptions[e]}},{key:"onMetadataUpdate",value:function(e,t){return this._isDirty?(null!=this._serializedValues&&null!=this._serializedDescriptions&&Bt()(this._serializedValues)===t&&this._serializedDescriptions===e&&(this._isDirty=!1,this._initialMd5Checksum=t),{outdated:!1}):(this._serializedDescriptions!==e&&(this._serializedDescriptions=e,this._descriptions=e.split(",").map((function(e){return"null"===e?null:e}))),this._initialMd5Checksum!==t?(this._serializedValues=null,this._values=null,{outdated:!0}):{outdated:!1})}}]),e}(),r._splitOuterKey=function(e){var t=e.indexOf("-");return{prefixKey:Number(e.substring(0,t)),innerKey:e.substring(t+1)}},!e instanceof mt)throw new Error("CachingBackendMap have to accepts instance of BackendMap");return r._innerBackendMap=e,r}return Object(g.a)(n,[{key:"createKey",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t,n,r,a,i,s=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._changeKeysMutex.acquire();case 2:if(t=e.sent,e.prev=3,null!==this._innerKeys){e.next=6;break}throw new Error("You should call getAllKeys first");case 6:if(n=function(){if(0!==s._innerKeys.length)return s._innerKeys[s._innerKeys.length-1]},0!==this._innerKeys.length&&!this._chunks.get(n()).isFull()){e.next=13;break}return e.next=10,this._innerBackendMap.createKey();case 10:r=e.sent,this._innerKeys.push(r),this._chunks.set(r,new this._Chunk({connector:this._createChunkConnector(r)}));case 13:return a=n(),e.next=16,this._chunks.get(a).createSubKey();case 16:return i=e.sent,e.abrupt("return",i+"-"+a);case 18:return e.prev=18,t(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[3,,18,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n,r,a,i;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._changeKeysMutex.acquire();case 2:if(n=e.sent,e.prev=3,r=this._splitOuterKey(t),a=r.prefixKey,i=r.innerKey,this._chunks.has(i)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this._chunks.get(i).delete(a);case 9:return e.prev=9,n(),e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[3,,9,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(){var e=Object(b.a)(y.a.mark((function e(t,n){var r,a,i;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._splitOuterKey(t),a=r.prefixKey,i=r.innerKey,this._chunks.has(i)){e.next=3;break}return e.abrupt("return");case 3:this._chunks.get(i).setValue(a,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getMd5",value:function(){var e=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Don't call getMd5 on this class. Server cannot compute md5 for this item because it is multiplexed.In order to sync call |getAllKeys| and if some item has |outdated===true| call |get|.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n,r,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._splitOuterKey(t),r=n.prefixKey,a=n.innerKey,this._chunks.has(a)){e.next=3;break}return e.abrupt("return",void 0);case 3:return e.abrupt("return",this._chunks.get(a).getValue(r));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllKeys",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t,n,r,a,i,s=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._changeKeysMutex.acquire();case 2:return t=e.sent,e.prev=3,e.next=6,this._innerBackendMap.getAllKeys();case 6:return n=e.sent,r=[],a=new Map,i=0,n.forEach((function(e){var t=!0,n=0===i++;if(s._chunks.has(e.id)){var o=s._chunks.get(e.id);a.set(e.id,o),t=o.onMetadataUpdate(e.description,e.md5Checksum).outdated}else a.set(e.id,new s._Chunk({connector:s._createChunkConnector(e.id),serializedDescriptions:e.description,isFirstChunk:n}));var c=a.get(e.id);c.listSubKeys().forEach((function(n){r.push({id:n+"-"+e.id,outdated:t,description:c.getDescription(n)})}))})),this._chunks=a,this._innerKeys=n.map((function(e){return e.id})),e.abrupt("return",r);case 14:return e.prev=14,t(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[3,,14,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"getSettings",value:function(){var e=Object(b.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._innerBackendMap.getSettings();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSettings",value:function(){var e=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._innerBackendMap.setSettings(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setDescription",value:function(){var e=Object(b.a)(y.a.mark((function e(t,n){var r,a,i;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._splitOuterKey(t),a=r.prefixKey,i=r.innerKey,this._chunks.has(i)){e.next=3;break}return e.abrupt("return");case 3:this._chunks.get(i).setDescription(a,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(mt),zt=function(e){Object(A.a)(n,e);var t=Object(D.a)(n);function n(e){var r;if(Object(v.a)(this,n),(r=t.call(this))._innerBackendMap=null,!e instanceof mt)throw new Error("CachingBackendMap have to accepts instance of BackendMap");return r._innerBackendMap=e,r}return Object(g.a)(n,[{key:"_exponentialRetry",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=1;case 1:if(!(n<10)){e.next=16;break}return e.prev=2,e.next=5,t();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),r=1*Math.pow(3,n++),console.error("Failed running ".concat(t.name," : ").concat(e.t0.message,". Will try again after ").concat(r," seconds.")),e.next=14,this._sleep(1e3*r);case 14:e.next=1;break;case 16:console.error("finish retry attempts");case 17:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createKey",value:function(){var e=Object(b.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.createKey.bind(this._innerBackendMap));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.delete.bind(this._innerBackendMap,t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(){var e=Object(b.a)(y.a.mark((function e(t,n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.set.bind(this._innerBackendMap,t,n));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.get.bind(this._innerBackendMap,t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMd5",value:function(){var e=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.getMd5.bind(this._innerBackendMap,t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllKeys",value:function(){var e=Object(b.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.getAllKeys.bind(this._innerBackendMap));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSettings",value:function(){var e=Object(b.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.getSettings.bind(this._innerBackendMap));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSettings",value:function(){var e=Object(b.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.setSettings.bind(this._innerBackendMap,t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setDescription",value:function(){var e=Object(b.a)(y.a.mark((function e(t,n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.setDescription.bind(this._innerBackendMap,t,n));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_sleep",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}]),n}(mt),Ht=function(e){Object(A.a)(n,e);var t=Object(D.a)(n);function n(e){var r;if(Object(v.a)(this,n),(r=t.call(this))._innerBackendMap=null,!e instanceof mt)throw new Error("CachingBackendMap have to accepts instance of BackendMap");return r._innerBackendMap=e,r._limiter=new Rt.a({maxConcurrent:5,minTime:50}),r}return Object(g.a)(n,[{key:"createKey",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return t._innerBackendMap.createKey()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return n._innerBackendMap.delete(t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(){var e=Object(b.a)(y.a.mark((function e(t,n){var r=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return r._innerBackendMap.set(t,n)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return n._innerBackendMap.get(t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMd5",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return n._innerBackendMap.getMd5(t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllKeys",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return t._innerBackendMap.getAllKeys()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSettings",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return t._innerBackendMap.getSettings()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSettings",value:function(){var e=Object(b.a)(y.a.mark((function e(t){var n=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return n._innerBackendMap.setSettings(t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setDescription",value:function(){var e=Object(b.a)(y.a.mark((function e(t,n){var r=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return r._innerBackendMap.setDescription(t,n)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(mt);var Vt=function(){var e=Object(c.a)("(prefers-color-scheme: dark)"),t=a.a.useMemo((function(){return Object(u.a)({palette:{type:e?"dark":"light",primary:{main:e?d.a[900]:p.a[800]}}})}),[e]),n=a.a.useState(!0),r=Object(o.a)(n,2),i=r[0],s=r[1],f=a.a.useCallback((function(e){window.innerHeight<700&&s(!1)}),[]),m=a.a.useCallback((function(e){s(!0)}),[]),y=a.a.useState(null),b=Object(o.a)(y,2),v=b[0],g=b[1];return a.a.useEffect((function(){E.addStateListener((function(e){g(e===w.SIGNED_IN?new Ft(new Tt(new Ht(new zt(bt))),E):function(e){return e&&e.dispose(),null})}))}),[]),a.a.createElement(l.a,{theme:t},a.a.createElement(h.a,null),a.a.createElement(Ze,{shown:i,onShow:m,model:v}),a.a.createElement(dt,{onFocus:f,model:v}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Vt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[125,1,2]]]);
//# sourceMappingURL=main.d4086ef3.chunk.js.map