{"version":3,"sources":["GDriveAuthClient.js","googleIcon.js","GoogleSignInButton.js","Popup.js","EmojiPicker.js","Entry.js","VirtualizedList.js","EntriesTable.js","Interface.js","BackendMap.js","EntriesTableModel.js","HelpWindow.js","AppMenu.js","AppContent.js","GDriveMap.js","BackendQuotaSavers.js","App.js","serviceWorker.js","index.js","CenteredTypography.js","Settings.js"],"names":["GDriveStates","LOADING","SIGNED_IN","SIGNED_OUT","FAILED","Object","freeze","gdriveAuthClient","Set","ondone","console","assert","length","script","document","createElement","async","src","body","appendChild","onload","onerror","loadGapi","a","window","gapi","Error","Promise","resolve","load","client","init","clientId","discoveryDocs","scope","isGapiLoaded","_updateSignInState","auth2","getAuthInstance","isSignedIn","listen","bind","log","_notifyStateChanged","listener","this","has","add","delete","addStateListener","state","removeStateListener","mocha","signIn","prompt","signOut","current_state","get","seal","active","style","display","padding","width","height","xmlns","fill","fillRule","d","ButtonContent","children","paddingLeft","fontWeight","buttonStyle","backgroundColor","alignItems","color","boxShadow","borderRadius","border","fontSize","fontFamily","cursor","disabledStyle","opacity","GoogleSignInButton","authState","props","prevAuthState","buttonAnchor","setState","prevState","assign","alertElement","Alert","severity","AlertTitle","href","ref","onClick","type","key","Popper","zIndex","open","anchorEl","placement","disablePortal","modifiers","flip","enabled","preventOverflow","hide","offset","React","PureComponent","useStyles","makeStyles","theme","outer","position","popup","flexDirection","justifyContent","minWidth","background","palette","paper","Popup","forwardRef","classes","in","className","Zoom","container","alignSelf","margin","borderColor","focused","setupItem","isActive","icon","isSelected","emoji","userSelect","value","EmojiItem","text","role","aria-label","String","fromCodePoint","RadioIcon","selectedValue","SvgIcon","viewBox","y","EmojiSetupItem","onChange","EmojiPicker","useState","setFocus","selectedRow","setSelectedRow","popupRef","useRef","emojiArray","activeEmojiArray","filter","x","rowCounter","Fragment","tabIndex","event","stopPropagation","onFocus","onBlur","current","contains","activeElement","onKeyDown","clone","onEmojiArrayChange","inputRef","focus","preventDefault","map","codePoint","Typography","variant","align","EntryStatus","LastChange","EntryModel","data","description","_data","_key","_initiallyCollapsed","_focused","lastChange","_setDescriptionImpl","cloneModel","left","isDataLoaded","error","right","result","setDescription","_generateDescription","_emojiArrays","_creationTime","creationTime","collapsed","_description","split","serializedEmoji","serializedCreationTime","Array","from","Number","push","Date","isNaN","getTime","descrciption","every","join","paperStyle","borderWidth","primary","light","inner","flex","breakpoints","up","input","marginTop","hasCreationTime","minHeight","hasEmoji","down","date","marginBottom","paddingBottom","hint","whiteSpace","SubItem","onFocusOuter","emojiText","onDelete","onCollapseExited","example","deleteXsDown","deleteSmUp","setFocused","emojiFocused","setEmojiFocused","useEffect","autoFocus","Collapse","onExited","onEntered","getSelection","toString","moment","format","InputBase","fullWidth","multiline","placeholder","isEnabled","Hidden","xsDown","smUp","IconButton","disabled","size","Entry","onUpdate","entry","onRightChanged","settings","otherProps","initiallyCollapsed","setCollapsed","colSpan","setInitiallyCollapsed","show","emojiLeft","emojiRight","i","emojiList","emojiArrays","onEntryChanged","updatedEntry","alreadyFocused","setLeft","target","leftHint","newLeftEmojiArray","setEmojiLeft","Skeleton","setRight","rightHint","newRightEmojiArray","setEmojiRight","VirtualizedItem","createRef","onHeightChanged","offsetHeight","ResizeObserver","observe","disconnect","ItemComponent","scrollableContainerRef","VirtualizedList","entries","defaultHeight","PlaceholderComponent","scrollY","setScrollY","innerHeight","windowHeight","setWindowHeight","Map","realHeightsMap","setRealHeightsMap","useCallback","oldMap","newMap","set","keys","keysToDelete","forEach","_value","onResizeOrScroll","scrollTop","onscroll","addEventListener","removeEventListener","visibleEntries","currentHeight","placeholderTop","placeholderBottom","entryHeight","unshift","Placeholder","rest","EntriesTableRaw","_onEntriesChanged","canRedo","canUndo","DateEntry","calendar","sameDay","lastDay","lastWeek","sameElse","dateToInsert","currentCreationTime","getYear","getMonth","getDay","splice","_scrollBy","top","requestAnimationFrame","_scrollableContainerRef","timeSinceLastScroll","now","_lastScrollTime","scrollBy","behavior","_onKeyPress","e","model","undo","redo","addNewItemThrottled","_tableRef","_columnResizer","_resizeObserver","subscribe","ColumnResizer","liveDrag","gripInnerHtml","grip","onResize","dispatchEvent","Event","_","throttle","prevProps","unsubscribe","destroy","unobserve","handleFocusableElements","handleKeys","onKeyEvent","Grid","buttonsContainer","justify","spacing","item","xs","sm","appBarShown","onShowAppBar","buttons","Button","scrollableContainer","cellPadding","cellSpacing","entriesTable","EntriesTable","withStyles","overflow","willChange","transitionDuration","transitionProperty","borderSpacing","verticalAlign","borderLeft","borderRight","secondary","borderBottom","Interface","name","setTimeout","BackendMap","requireFunction","EntriesTableModel","EntriesTableModelImpl","backendMap","authClient","addNewItem","omitHistory","_addNewItemMutex","acquire","release","_tryFindVacantEntry","_createNewEntry","clear","setCreationTime","_historyIndex","_history","old","new","_entries","_sendEntryToBackend","historyItem","sync","_disposed","_authClient","waitForStateChange","_backendMap","getAllKeys","newEntries","id","outdated","_descriptions","promises","_settings","_fetchSettings","reverse","_fetch","all","onSettingsUpdate","debounce","setSettings","stringify","prevEntry","_addHistoryItem","Mutex","_subscriptions","_syncLoop","content","undefined","JSON","parse","message","callback","_getFilteredEntriesArray","lastVacantEntry","createKey","newKey","newEntry","slice","descriptionPromise","dataPromise","getSettings","serializedSettings","_serializedSettings","Settings","values","ExampleModel","HelpWindow","onOpenSettings","SettingsWindow","lazy","titleContainer","modal","default","ModalWindowButton","setOpen","styles","onWindowClose","Modal","onClose","fallback","CenteredTypography","isExclusive","Backdrop","invisible","CircularProgress","cloneElement","isFirstRender","urlParams","URLSearchParams","location","search","AppMenu","settingsOpen","setSettingsOpen","helpOpen","setHelpOpen","appear","shown","Toolbar","Slide","direction","AppBar","Help","edge","AppContent","signInState","setSignInState","gdriveMap","find","createEmptyFile","firstKey","deleteFile","throwIfNotSignedIn","upload","download","getMd5","element","_getSettingsKey","settingsContent","patchDescription","prom","gapiCall","argObj","stack","reject","then","resp","status","err","mimeType","drive","files","create","resource","parents","fields","fileId","boundary","multipartRequestBody","delimiter","request","path","method","params","uploadType","headers","md5Checksum","alt","query","ret","list","spaces","pageSize","pageToken","token","orderBy","q","concat","nextPageToken","BackendMultiplexor","innerMap","_changeKeysMutex","_innerKeys","_innerBackendMap","_createChunkConnector","innerkey","setValue","serializedValue","serializedDescription","getValue","indexOf","_chunks","_Chunk","connector","serializedDescriptions","_onValueSet","_serializedValues","_values","_connector","_onDescriptionSet","_serializedDescriptions","_fetchValuesSynchronised","_fetchPromise","_fetchValues","serializedValues","isArray","_initialMd5Checksum","md5","_isDirty","_shouldKeepOnFormatError","subkeys","isFull","subkey","_splitOuterKey","outerKey","separator","prefixKey","substring","innerKey","getLastInnerKey","newInnerKey","createSubKey","keyPrefix","newInnerKeys","outerKeys","newChunks","counter","isFirstChunk","chunk","onMetadataUpdate","listSubKeys","getDescription","ErrorHandler","retriesCount","secondsToNextRetry","_sleep","_exponentialRetry","ms","RequestThrottler","_limiter","Bottleneck","maxConcurrent","minTime","schedule","App","prefersDarkMode","useMediaQuery","useMemo","createMuiTheme","main","blueGrey","blue","setAppBarShown","onTableEntryFocus","arg","showAppBar","setModel","newState","oldModel","dispose","ThemeProvider","CssBaseline","Boolean","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","Hint","_isEnabled","_text","json","_emojiList","_leftHint","_rightHint","_mutateToDefaults"],"mappings":"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","file":"static/js/main.c5458720.chunk.js","sourcesContent":["// PUBLIC SECTION\nexport const GDriveStates = {\n  LOADING: \"loading\",\n  SIGNED_IN: \"signed_in\",\n  SIGNED_OUT: \"signed_out\",\n  FAILED: \"failed\",\n};\nObject.freeze(GDriveStates);\n\nclass GDriveAuthClient {\n  #state = GDriveStates.LOADING;\n  #stateListeners = new Set();\n\n  get state() {\n    return this.#state;\n  }\n\n  addStateListener(listener) {\n    console.assert(typeof listener == \"function\");\n    console.assert(listener.length === 1);\n    console.assert(!this.#stateListeners.has(listener));\n\n    this.#stateListeners.add(listener);\n  }\n\n  removeStateListener(listener) {\n    console.assert(typeof listener == \"function\");\n    console.assert(listener.length === 1);\n    console.assert(this.#stateListeners.has(listener));\n    this.#stateListeners.delete(listener);\n  }\n\n  async waitForStateChange() {\n    return await new Promise((resolve) => {\n      let listener = (state) => {\n        this.removeStateListener(listener);\n        resolve(state);\n      };\n      this.addStateListener(listener);\n    });\n  }\n\n  constructor() {\n    loadGapi(async () => {\n      try {\n        if (!window.gapi) {\n          throw new Error(\"Failed loading GAPI\");\n        }\n\n        await new Promise((resolve) =>\n          window.gapi.load(\"client:auth2\", resolve)\n        );\n\n        await window.gapi.client.init({\n          clientId:\n            \"479709565206-4ek8a502261s9sussiehpa5v146ns2ku.apps.googleusercontent.com\",\n          discoveryDocs: [\n            \"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\",\n          ],\n          scope: \"https://www.googleapis.com/auth/drive.appfolder\",\n        });\n\n        if (!isGapiLoaded()) {\n          throw new Error(\"Failed registering client_id.\");\n        }\n\n        this._updateSignInState();\n\n        window.gapi.auth2\n          .getAuthInstance()\n          .isSignedIn.listen(this._updateSignInState.bind(this));\n      } catch (error) {\n        console.log(error);\n        this.#state = GDriveStates.FAILED;\n        this._notifyStateChanged();\n        return;\n      }\n    });\n  }\n\n  signIn() {\n    console.assert(isGapiLoaded());\n    if (!!window.mocha) {\n      window.gapi.auth2.getAuthInstance().signIn();\n    } else {\n      window.gapi.auth2.getAuthInstance().signIn({\n        prompt: \"select_account\",\n      });\n    }\n  }\n\n  signOut() {\n    console.assert(isGapiLoaded());\n    let auth_instance = window.gapi.auth2.getAuthInstance();\n    auth_instance.signOut();\n  }\n\n  _notifyStateChanged() {\n    for (let listener of this.#stateListeners) {\n      listener(this.#state);\n    }\n  }\n\n  _updateSignInState() {\n    console.assert(this.#state !== GDriveStates.FAILED);\n    let current_state = isSignedIn()\n      ? GDriveStates.SIGNED_IN\n      : GDriveStates.SIGNED_OUT;\n    if (this.#state !== current_state) {\n      this.#state = current_state;\n      this._notifyStateChanged();\n    }\n  }\n}\n\nexport const gdriveAuthClient = new GDriveAuthClient();\nObject.seal(gdriveAuthClient);\n\n// PRIVATE SECTION\nfunction loadGapi(ondone) {\n  console.assert(typeof ondone == \"function\");\n  console.assert(ondone.length === 0);\n  var script = document.createElement(\"script\");\n  script.async = true;\n  script.src = \"https://apis.google.com/js/api.js\";\n  document.body.appendChild(script);\n  script.onload = ondone;\n  script.onerror = ondone;\n}\n\nfunction isGapiLoaded() {\n  return window.gapi && window.gapi.auth2 && window.gapi.client;\n}\n\nfunction isSignedIn() {\n  console.assert(isGapiLoaded());\n  return window.gapi.auth2.getAuthInstance().isSignedIn.get();\n}\n","import React from \"react\";\n\nexport default ({ active }) => (\n  <div\n    style={{\n      display: \"flex\",\n      padding: 10,\n    }}\n  >\n    <svg width=\"18\" height=\"18\" xmlns=\"http://www.w3.org/2000/svg\">\n      <g fill=\"#000\" fillRule=\"evenodd\">\n        <path\n          d=\"M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z\"\n          fill=\"#EA4335\"\n        />\n        <path\n          d=\"M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z\"\n          fill=\"#4285F4\"\n        />\n        <path\n          d=\"M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z\"\n          fill=\"#FBBC05\"\n        />\n        <path\n          d=\"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z\"\n          fill=\"#34A853\"\n        />\n        <path fill=\"none\" d=\"M0 0h18v18H0z\" />\n      </g>\n    </svg>\n  </div>\n);\n","import React from \"react\";\nimport Icon from \"./googleIcon\";\nimport { GDriveStates } from \"./GDriveAuthClient.js\";\nimport Popper from \"@material-ui/core/Popper\";\nimport { Alert, AlertTitle } from \"@material-ui/lab\";\n\nconst ButtonContent = ({ children }) => (\n  <span\n    style={{\n      padding: 10,\n      paddingLeft: 0,\n      fontWeight: 500,\n    }}\n  >\n    {children}\n  </span>\n);\n\nlet buttonStyle = {\n  backgroundColor: \"#fff\",\n  display: \"inline-flex\",\n  alignItems: \"center\",\n  color: \"rgba(0, 0, 0, .54)\",\n  boxShadow: \"0 2px 2px 0 rgba(0, 0, 0, .24), 0 0 1px 0 rgba(0, 0, 0, .24)\",\n  padding: 0,\n  borderRadius: 2,\n  border: \"1px solid transparent\",\n  fontSize: 14,\n  fontWeight: \"500\",\n  fontFamily: \"Roboto, sans-serif\",\n  cursor: \"pointer\",\n};\n\nlet disabledStyle = {\n  opacity: 0.6,\n};\n\nexport class GoogleSignInButton extends React.PureComponent {\n  state = {\n    authState: this.props.gdriveAuthClient.state,\n    prevAuthState: this.props.gdriveAuthClient.LOADING,\n    buttonAnchor: null,\n  };\n\n  componentDidMount() {\n    if (this.state.authState !== this.props.gdriveAuthClient.state) {\n      this.#setAuthState(this.props.gdriveAuthClient.state);\n    }\n    this.props.gdriveAuthClient.addStateListener(this.#setAuthState);\n  }\n  componentWillUnmount() {\n    this.props.gdriveAuthClient.removeStateListener(this.#setAuthState);\n  }\n\n  #setAuthState = (authState) => {\n    this.setState((prevState) => {\n      return { ...prevState, prevAuthState: prevState.authState, authState };\n    });\n  };\n\n  #setButtonAnchor = (buttonAnchor) => {\n    this.setState((prevState) => {\n      return { ...prevState, buttonAnchor };\n    });\n  };\n\n  #getButtonStyle = () => {\n    if (\n      this.state.authState === GDriveStates.FAILED ||\n      this.state.authState === GDriveStates.LOADING\n    ) {\n      return Object.assign({}, buttonStyle, disabledStyle);\n    }\n\n    return buttonStyle;\n  };\n\n  #onClick = async () => {\n    if (this.state.authState === GDriveStates.SIGNED_IN) {\n      this.props.gdriveAuthClient.signOut();\n    } else if (this.state.authState === GDriveStates.SIGNED_OUT) {\n      this.props.gdriveAuthClient.signIn();\n    }\n  };\n\n  render() {\n    let alertElement = (() => {\n      if (this.state.authState === GDriveStates.FAILED) {\n        return (\n          <Alert severity=\"error\">\n            Failed connecting to google. Check your connection and try reloading\n            the page.\n          </Alert>\n        );\n      }\n\n      if (this.state.authState === GDriveStates.SIGNED_OUT) {\n        if (this.state.prevAuthState === GDriveStates.SIGNED_IN) {\n          return (\n            <Alert severity=\"warning\">\n              <AlertTitle>Privacy note!</AlertTitle>\n              If other people have access to this browser <br />\n              AND you don't want them to read your sheets: <br />\n              <ol>\n                <li>\n                  sign out globally: <br />\n                  <a href=\"https://accounts.google.com/Logout\">\n                    https://accounts.google.com/Logout\n                  </a>\n                </li>\n                <li>delete Google account password from the browser</li>\n              </ol>\n            </Alert>\n          );\n        } else if (this.state.prevAuthState === GDriveStates.LOADING) {\n          return (\n            <Alert severity=\"info\">\n              This site stores data in a hidden Google Drive folder. <br />\n              Sign in to proceed.\n              <br />\n            </Alert>\n          );\n        }\n      }\n    })();\n\n    return (\n      <button\n        ref={(ref) => this.#setButtonAnchor(ref)}\n        onClick={this.#onClick}\n        style={this.#getButtonStyle()}\n        type=\"button\"\n      >\n        <Icon key={0} active={this.state.active} />\n        <ButtonContent key={2}>\n          {this.state.authState === GDriveStates.SIGNED_IN\n            ? \"Sign Out\"\n            : \"Sign In \"}\n        </ButtonContent>\n\n        {!!alertElement && !!this.state.buttonAnchor && (\n          <Popper\n            key={1}\n            style={{ zIndex: 1200 }}\n            open={true}\n            anchorEl={this.state.buttonAnchor}\n            placement=\"bottom-end\"\n            disablePortal={false}\n            modifiers={{\n              flip: {\n                enabled: false,\n              },\n              preventOverflow: {\n                enabled: false,\n              },\n              hide: {\n                enabled: false,\n              },\n              offset: {\n                offset: \"0,5\",\n              },\n            }}\n          >\n            {alertElement}\n          </Popper>\n        )}\n      </button>\n    );\n  }\n}\n","// Material ui popper is too slow buggy and overcomplicated.\r\n// Do not expect much from this popup. It doesn't respect screen boundaries etc.\r\n\r\nimport React from \"react\";\r\nimport { Zoom, makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  outer: {\r\n    position: \"relative\",\r\n  },\r\n  popup: {\r\n    position: \"absolute\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"center\",\r\n    minWidth: 140,\r\n    zIndex: 2,\r\n    padding: 10,\r\n    background: theme.palette.background.paper,\r\n    border: \"gray solid 2px\",\r\n    borderRadius: 4,\r\n  },\r\n}));\r\n\r\nexport const Popup = React.forwardRef((props, ref) => {\r\n  const classes = useStyles();\r\n  return (\r\n    props.in && (\r\n      <div className={classes.outer}>\r\n        <Zoom in={props.in}>\r\n          <div ref={ref} className={classes.popup}>\r\n            {props.children}\r\n          </div>\r\n        </Zoom>\r\n      </div>\r\n    )\r\n  );\r\n});\r\n","import React from \"react\";\nimport { Typography, makeStyles, SvgIcon } from \"@material-ui/core\";\nimport { Popup } from \"./Popup\";\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    alignSelf: \"flex-start\",\n    margin: 2,\n    cursor: \"pointer\",\n    borderColor: (focused) => (focused ? \"gray\" : \"#0000\"),\n    border: \"solid 2px\",\n    borderRadius: 4,\n    position: \"relative\",\n    backgroundColor: theme.palette.background.paper,\n  },\n  setupItem: {\n    border: \"2px solid\",\n    borderColor: (isActive) => (isActive ? \"darkgray\" : \"#0000\"),\n    borderRadius: 4,\n    fontSize: 20,\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n\n  icon: {\n    cursor: \"pointer\",\n    width: 15,\n    margin: 0,\n    padding: \"4px 1px\",\n    height: \"30px\",\n    border: \"1px solid #0000\",\n\n    borderColor: (isSelected) => (isSelected ? \"gray\" : \"#0000\"),\n  },\n\n  emoji: {\n    userSelect: \"none\",\n    fontWeight: (value) => (value === 3 ? \"bold\" : \"unset\"),\n    opacity: (value) => (value === 3 ? 1 : value === 2 ? 0.7 : 0.3),\n  },\n}));\n\nfunction EmojiItem({ emoji, text, ...props }) {\n  const classes = useStyles(props.value);\n  return (\n    <span className={classes.emoji} role=\"img\" aria-label={text} {...props}>\n      {String.fromCodePoint(emoji)}\n    </span>\n  );\n}\n\nfunction RadioIcon({ selectedValue, value, ...props }) {\n  const classes = useStyles(selectedValue === value);\n\n  let height = 5 * (3 - value) + 1;\n  return (\n    <SvgIcon className={classes.icon} viewBox=\"1 1 7 15\" {...props}>\n      <rect\n        y={height}\n        width=\"9\"\n        height={16 - height}\n        fill={value <= selectedValue ? \"red\" : \"lightGray\"}\n      />\n    </SvgIcon>\n  );\n}\n\nfunction EmojiSetupItem({ value, isActive, ...props }) {\n  const classes = useStyles(isActive);\n  return (\n    <div className={classes.setupItem}>\n      <EmojiItem\n        {...props}\n        value={3}\n        onClick={() => props.onChange((value + 1) % 4)}\n      />\n      <RadioIcon\n        onClick={() => props.onChange(0)}\n        selectedValue={value}\n        value={0}\n      />\n      <RadioIcon\n        onClick={() => props.onChange(1)}\n        selectedValue={value}\n        value={1}\n      />\n      <RadioIcon\n        onClick={() => props.onChange(2)}\n        selectedValue={value}\n        value={2}\n      />\n      <RadioIcon\n        onClick={() => props.onChange(3)}\n        selectedValue={value}\n        value={3}\n      />\n    </div>\n  );\n}\n\nexport function EmojiPicker(props) {\n  const [focused, setFocus] = React.useState(false);\n  let [selectedRow, setSelectedRow] = React.useState(-1);\n\n  const popupRef = React.useRef();\n  const classes = useStyles(focused);\n\n  let onClick = (event) => {\n    event.stopPropagation();\n  };\n\n  let onFocus = (event) => {\n    props.onFocus(event);\n    setFocus(true);\n  };\n\n  let onBlur = (event) => {\n    if (!popupRef.current.contains(document.activeElement)) {\n      setFocus(false);\n      props.onBlur(event);\n    }\n  };\n\n  let onKeyDown = (event) => {\n    if (event.key === \"ArrowLeft\") {\n      if (selectedRow < 0) setSelectedRow((selectedRow = 0));\n      if (selectedRow < props.emojiArray.length) {\n        let clone = [...props.emojiArray];\n        clone[selectedRow].value--;\n        if (clone[selectedRow].value < 0) {\n          clone[selectedRow].value = 3;\n        }\n        props.onEmojiArrayChange(clone);\n      }\n    } else if (event.key === \"ArrowRight\") {\n      if (selectedRow < 0) setSelectedRow((selectedRow = 0));\n      if (selectedRow < props.emojiArray.length) {\n        let clone = [...props.emojiArray];\n        clone[selectedRow].value++;\n        if (clone[selectedRow].value > 3) {\n          clone[selectedRow].value = 0;\n        }\n        props.onEmojiArrayChange(clone);\n      }\n    } else if (event.key === \"ArrowDown\") {\n      selectedRow++;\n      if (selectedRow >= props.emojiArray.length) {\n        selectedRow = 0;\n      }\n      setSelectedRow(selectedRow);\n    } else if (event.key === \"ArrowUp\") {\n      selectedRow--;\n      if (selectedRow < 0) {\n        selectedRow = props.emojiArray.length - 1;\n      }\n      setSelectedRow(selectedRow);\n    } else if (event.key === \"Escape\" || event.key === \"Enter\") {\n      props.inputRef.current.focus();\n    } else {\n      return;\n    }\n\n    event.preventDefault();\n  };\n\n  if (props.emojiArray.length === 0) return null;\n\n  let activeEmojiArray = props.emojiArray.filter((x) => x.value > 0);\n\n  let rowCounter = 0;\n\n  return (\n    <React.Fragment>\n      <div\n        tabIndex={0}\n        onClick={onClick}\n        onFocus={onFocus}\n        onBlur={onBlur}\n        className={classes.container}\n        onKeyDown={onKeyDown}\n      >\n        {activeEmojiArray.length > 0 ? (\n          activeEmojiArray.map((x) => (\n            <EmojiItem\n              key={x.codePoint}\n              emoji={x.codePoint}\n              text={x.text}\n              value={x.value}\n            />\n          ))\n        ) : (\n          <Typography variant=\"caption\" color=\"textSecondary\">\n            add mood\n          </Typography>\n        )}\n        <Popup in={focused} ref={popupRef}>\n          <Typography align=\"center\" variant=\"body1\">\n            {props.text}\n          </Typography>\n          {props.emojiArray.map((x) => (\n            <EmojiSetupItem\n              key={x.codePoint}\n              isActive={rowCounter++ === selectedRow}\n              emoji={x.codePoint}\n              text={x.text}\n              value={x.value}\n              onChange={(value) => {\n                props.onEmojiArrayChange(\n                  props.emojiArray.map((y) =>\n                    y.codePoint === x.codePoint ? { ...y, value } : y\n                  )\n                );\n              }}\n            />\n          ))}\n\n          <Typography align=\"center\" variant=\"caption\">\n            Use arrow keys.\n          </Typography>\n        </Popup>{\" \"}\n      </div>\n    </React.Fragment>\n  );\n}\n","import React from \"react\";\nimport {\n  IconButton,\n  InputBase,\n  makeStyles,\n  Typography,\n  Collapse,\n  Hidden,\n} from \"@material-ui/core\";\nimport { Skeleton } from \"@material-ui/lab\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport moment from \"moment\";\nimport { EmojiPicker } from \"./EmojiPicker\";\nimport { Popup } from \"./Popup\";\n\nexport const EntryStatus = {\n  // The http request for the text of the entry has been sent.\n  LOADING: \"loading\",\n  // This entry has never been rendered because user never\n  // scrolled to its position.\n  HIDDEN: \"hidden\",\n  // User pressed DELETE button.\n  DELETED: \"deleted\",\n};\n\nconst LastChange = {\n  EDIT_LEFT: \"editLeft\",\n  EDIT_RIGHT: \"editRight\",\n  NONE: \"none\",\n};\n\n// EntryModel is immutable. setLeft setRight delete and clear return a new copy.\nexport class EntryModel {\n  isDataLoaded() {\n    return (\n      this._data !== EntryStatus.LOADING && this._data !== EntryStatus.HIDDEN\n    );\n  }\n\n  get data() {\n    if (this._data instanceof Object) return { ...this._data };\n    return this._data;\n  }\n\n  get key() {\n    return this._key;\n  }\n\n  get description() {\n    if (!this.isDataLoaded()) return \"\";\n    return this._description;\n  }\n  setDescription(description) {\n    const cloneModel = this.clone();\n    cloneModel._setDescriptionImpl(description);\n    return cloneModel;\n  }\n\n  get left() {\n    if (!this.isDataLoaded()) return \"\";\n    return this._data.left;\n  }\n  setLeft(left) {\n    if (!this.isDataLoaded()) {\n      console.error(\"bad status\");\n      return this;\n    }\n\n    const cloneModel = this.clone();\n    cloneModel._data = { ...this._data, left };\n    cloneModel.lastChange = LastChange.EDIT_LEFT;\n    return cloneModel;\n  }\n\n  get right() {\n    if (!this.isDataLoaded()) return \"\";\n    return this._data.right;\n  }\n  setRight(right) {\n    if (!this.isDataLoaded()) {\n      console.error(\"bad status\");\n      return this;\n    }\n\n    const cloneModel = this.clone();\n    cloneModel._data = { ...this._data, right };\n    cloneModel.lastChange = LastChange.EDIT_RIGHT;\n    return cloneModel;\n  }\n\n  get emojiArrays() {\n    return this._emojiArrays;\n  }\n\n  setEmojiLeft(left) {\n    let result = this.setDescription(\n      EntryModel._generateDescription(\n        left,\n        this._emojiArrays[1],\n        this._creationTime\n      )\n    );\n    result.lastChange = LastChange.EDIT_LEFT;\n    return result;\n  }\n\n  setEmojiRight(right) {\n    let result = this.setDescription(\n      EntryModel._generateDescription(\n        this._emojiArrays[0],\n        right,\n        this._creationTime\n      )\n    );\n    result.lastChange = LastChange.EDIT_RIGHT;\n    return result;\n  }\n\n  get creationTime() {\n    return this._creationTime;\n  }\n  setCreationTime(creationTime) {\n    return this.setDescription(\n      EntryModel._generateDescription(\n        this._emojiArrays[0],\n        this._emojiArrays[1],\n        creationTime\n      )\n    );\n  }\n\n  get initiallyCollapsed() {\n    return this._initiallyCollapsed;\n  }\n  setInitiallyCollapsed(collapsed) {\n    const cloneModel = this.clone();\n    cloneModel._initiallyCollapsed = collapsed;\n    return cloneModel;\n  }\n\n  get focused() {\n    return this._focused;\n  }\n  setFocused(focused) {\n    const cloneModel = this.clone();\n    cloneModel._focused = focused;\n    return cloneModel;\n  }\n\n  delete() {\n    return new EntryModel(this._key, EntryStatus.DELETED, EntryStatus.DELETED);\n  }\n\n  clear() {\n    return new EntryModel(this._key, { left: \"\", right: \"\" }, \"\");\n  }\n\n  show() {\n    if (this._data !== EntryStatus.HIDDEN)\n      throw new Error(\"show() has been called for entry that is not hidden\");\n    return new EntryModel(this._key, EntryStatus.LOADING, this._description);\n  }\n\n  clone() {\n    // this.data creates shallow copy of this._data\n    const cloneModel = new EntryModel(this._key, this.data);\n    cloneModel._emojiArrays = this._emojiArrays;\n    cloneModel._creationTime = this._creationTime;\n    cloneModel._description = this._description;\n    cloneModel._initiallyCollapsed = this._initiallyCollapsed;\n    cloneModel._focused = this._focused;\n    cloneModel.lastChange = this.lastChange;\n\n    return cloneModel;\n  }\n\n  constructor(key, data, description) {\n    this._data = data;\n    this._key = key;\n    this._initiallyCollapsed = false;\n    this._focused = false;\n    this.lastChange = LastChange.NONE;\n    this._setDescriptionImpl(description);\n  }\n\n  _data;\n  _description;\n  _key;\n\n  _initiallyCollapsed;\n  _focused;\n\n  // Cached values for performance. Got recomputed only when setDescription is called.\n  _emojiArrays;\n  _creationTime;\n\n  _setDescriptionImpl(description) {\n    this._emojiArrays = [[], []];\n    this._creationTime = null;\n    this._description = description;\n    if (\n      typeof description === \"string\" &&\n      description.length > 0 &&\n      description !== EntryStatus.DELETED\n    ) {\n      const [serializedEmoji, serializedCreationTime] = description.split(\"-\");\n\n      this._emojiArrays = serializedEmoji\n        .split(\":\")\n        .map((x) => Array.from(x).map((y) => Number(y)));\n      if (this._emojiArrays.length !== 2) this._emojiArrays.push([]);\n\n      this._creationTime = new Date(Number(serializedCreationTime));\n      if (isNaN(this._creationTime.getTime())) {\n        this._creationTime = null;\n      }\n    }\n  }\n\n  static _generateDescription(left, right, creationTime) {\n    let descrciption;\n    if (left.every((x) => x === 0) && right.every((x) => x === 0)) {\n      descrciption = \"\";\n    } else {\n      descrciption = left.join(\"\") + \":\" + right.join(\"\");\n    }\n\n    if (creationTime != null)\n      descrciption = descrciption + \"-\" + creationTime.getTime();\n    return descrciption;\n  }\n}\n\nconst paperStyle = (theme) => ({\n  border: \"solid\",\n  borderRadius: 4,\n  backgroundColor: theme.palette.background.paper,\n  padding: ({ focused }) => (focused ? 4 : 5),\n  borderWidth: ({ focused }) => {\n    return focused === true ? 2 : 1;\n  },\n  borderColor: ({ focused }) => {\n    return focused === true ? theme.palette.primary.light : \"gray\";\n  },\n});\n\nconst useStyles = makeStyles((theme) => ({\n  inner: {\n    display: \"flex\",\n    flex: 1,\n\n    flexDirection: \"column\",\n    position: \"relative\",\n    [theme.breakpoints.up(\"sm\")]: paperStyle(theme),\n  },\n  input: {\n    padding: 0,\n    marginTop: ({ hasCreationTime }) => (hasCreationTime ? 0 : 19),\n    minHeight: ({ hasEmoji }) => (hasEmoji ? 76 : 76 + 28),\n    alignItems: \"flex-start\",\n  },\n  outer: {\n    display: \"flex\",\n    alignItems: \"flex-start\",\n    flexDirection: \"row\",\n    [theme.breakpoints.down(\"xs\")]: paperStyle(theme),\n  },\n  date: {\n    border: \"0px !important\",\n    marginBottom: \"0px !important\",\n    paddingBottom: \"0px !important\",\n  },\n  hint: {\n    backgroundColor: theme.palette.background.paper,\n    whiteSpace: \"pre-line\",\n  },\n}));\n\nfunction SubItem({\n  onFocus: onFocusOuter,\n  emojiText,\n  emojiArray,\n  onDelete,\n  creationTime,\n  onEmojiArrayChange,\n  onCollapseExited,\n  collapsed,\n  example,\n  deleteXsDown,\n  deleteSmUp,\n  ...props\n}) {\n  const [focused, setFocused] = React.useState(false);\n  const [emojiFocused, setEmojiFocused] = React.useState(false);\n\n  React.useEffect(() => {\n    if (focused) {\n      onFocusOuter(null, true);\n    }\n  }, [focused, onFocusOuter]);\n\n  const classes = useStyles({\n    hasCreationTime: !!creationTime,\n    hasEmoji: emojiArray.length > 0,\n    focused: focused || emojiFocused,\n  });\n  const inputRef = React.useRef();\n\n  const onFocus = (event) => {\n    setFocused(true);\n    onFocusOuter(event);\n  };\n\n  const onBlur = (event) => {\n    setFocused(false);\n  };\n\n  const onEmojiFocused = (event) => {\n    onFocusOuter(event);\n    setEmojiFocused(true);\n  };\n  const onEmojiBlur = (event) => {\n    setEmojiFocused(false);\n  };\n\n  React.useEffect(() => {\n    if (!collapsed && props.autoFocus) {\n      inputRef.current.focus();\n    }\n  }, [collapsed, props.autoFocus]);\n\n  return (\n    <Collapse\n      in={!collapsed}\n      onExited={onCollapseExited}\n      onEntered={() => {\n        if (props.autoFocus) {\n          inputRef.current.focus();\n        }\n      }}\n    >\n      <div className={classes.outer}>\n        <div\n          className={classes.inner}\n          onClick={(event) => {\n            if (window.getSelection().toString().length === 0) {\n              inputRef.current.focus();\n            }\n          }}\n        >\n          {creationTime && (\n            <Typography variant=\"caption\" color=\"textSecondary\" align=\"center\">\n              {moment(creationTime).format(\"h:mm a\")}\n            </Typography>\n          )}\n\n          <InputBase\n            className={classes.input}\n            fullWidth\n            multiline\n            placeholder={!!props.hint ? props.hint.text : \"\"}\n            variant=\"outlined\"\n            inputRef={inputRef}\n            onFocus={onFocus}\n            onBlur={onBlur}\n            {...props}\n          />\n          <EmojiPicker\n            text={emojiText}\n            onEmojiArrayChange={onEmojiArrayChange}\n            emojiArray={emojiArray}\n            inputRef={inputRef}\n            onFocus={onEmojiFocused}\n            onBlur={onEmojiBlur}\n          ></EmojiPicker>\n          {props.hint != null &&\n            props.hint.isEnabled &&\n            props.value.length > 0 && (\n              <Popup in={focused}>\n                <Typography\n                  className={classes.hint}\n                  color=\"textSecondary\"\n                  padding={10}\n                >\n                  {props.hint.text}\n                </Typography>\n              </Popup>\n            )}\n        </div>\n\n        <Hidden xsDown={!deleteXsDown} smUp={!deleteSmUp}>\n          <IconButton\n            disabled={!!example}\n            aria-label=\"delete\"\n            size=\"small\"\n            onClick={onDelete}\n          >\n            <DeleteIcon\n              color={!!example ? \"disabled\" : \"action\"}\n              fontSize=\"small\"\n            ></DeleteIcon>\n          </IconButton>\n        </Hidden>\n      </div>\n    </Collapse>\n  );\n}\n\nexport const Entry = React.forwardRef(\n  (\n    {\n      onFocus: onFocusOuter,\n      onUpdate,\n      onRightChanged,\n      entry,\n      settings,\n      ...otherProps\n    },\n    ref\n  ) => {\n    const classes = useStyles();\n\n    const initiallyCollapsed = !!entry.text || entry.initiallyCollapsed;\n    const [collapsed, setCollapsed] = React.useState(initiallyCollapsed);\n    React.useEffect(() => {\n      if (initiallyCollapsed) {\n        setCollapsed(false);\n      }\n    }, [initiallyCollapsed]);\n\n    if (!!entry.text) {\n      return (\n        <tr ref={ref} className={classes.date}>\n          <td colSpan={2}>\n            <Collapse in={!collapsed}>\n              <Typography variant=\"body2\" align=\"center\" color=\"textSecondary\">\n                {entry.text}\n              </Typography>\n            </Collapse>\n          </td>\n        </tr>\n      );\n    }\n\n    console.assert(entry instanceof EntryModel);\n\n    React.useEffect(() => {\n      if (entry.initiallyCollapsed) {\n        onUpdate(entry.setInitiallyCollapsed(false), true);\n      }\n    }, [entry, onUpdate]);\n\n    React.useEffect(() => {\n      if (entry.data === EntryStatus.HIDDEN) onUpdate(entry.show(), true);\n    });\n\n    let emojiLeft = [];\n    let emojiRight = [];\n\n    if (settings != null) {\n      for (let i = 0; i < settings.emojiList.length; i++) {\n        emojiLeft.push({\n          value: entry.emojiArrays[0][i] == null ? 0 : entry.emojiArrays[0][i],\n          ...settings.emojiList[i],\n        });\n        emojiRight.push({\n          value: entry.emojiArrays[1][i] == null ? 0 : entry.emojiArrays[1][i],\n          ...settings.emojiList[i],\n        });\n      }\n    }\n\n    const onEntryChanged = (updatedEntry) => {\n      onUpdate(updatedEntry);\n    };\n\n    const onFocus = (event, alreadyFocused) => {\n      if (entry.focused) onUpdate(entry.setFocused(false), true);\n      if (!alreadyFocused && !!onFocusOuter) onFocusOuter(event);\n    };\n\n    return (\n      <tr ref={ref}>\n        <td key=\"issueElement\">\n          {entry.isDataLoaded() ? (\n            <SubItem\n              autoFocus={\n                entry.focused && entry.lastChange !== LastChange.EDIT_RIGHT\n              }\n              color=\"secondary\"\n              creationTime={entry.creationTime}\n              value={entry.left}\n              onChange={(event) =>\n                onEntryChanged(entry.setLeft(event.target.value))\n              }\n              onFocus={onFocus}\n              onDelete={() => {\n                setCollapsed(true);\n              }}\n              deleteXsDown\n              collapsed={collapsed}\n              hint={settings == null ? null : settings.leftHint}\n              emojiText=\"How do you feel now?\"\n              emojiArray={emojiLeft}\n              onEmojiArrayChange={(newLeftEmojiArray) =>\n                onEntryChanged(\n                  entry.setEmojiLeft(newLeftEmojiArray.map((x) => x.value))\n                )\n              }\n              {...otherProps}\n            ></SubItem>\n          ) : (\n            <Skeleton variant=\"rect\" height={135}></Skeleton>\n          )}\n        </td>\n\n        <td key=\"resolutionElement\">\n          {entry.isDataLoaded() ? (\n            <SubItem\n              autoFocus={\n                entry.focused && entry.lastChange === LastChange.EDIT_RIGHT\n              }\n              color=\"primary\"\n              variant=\"outlined\"\n              value={entry.right}\n              onChange={(event) =>\n                onEntryChanged(entry.setRight(event.target.value))\n              }\n              onFocus={onFocus}\n              deleteSmUp\n              onDelete={() => {\n                setCollapsed(true);\n              }}\n              collapsed={collapsed}\n              onCollapseExited={(event) => onUpdate(entry.delete())}\n              hint={settings == null ? null : settings.rightHint}\n              emojiText=\"How do you feel after writing resolution?\"\n              emojiArray={emojiRight}\n              onEmojiArrayChange={(newRightEmojiArray) =>\n                onEntryChanged(\n                  entry.setEmojiRight(newRightEmojiArray.map((x) => x.value))\n                )\n              }\n              {...otherProps}\n            />\n          ) : (\n            <Skeleton variant=\"rect\" height={135}></Skeleton>\n          )}\n        </td>\n      </tr>\n    );\n  }\n);\n","import React from \"react\";\n\nclass VirtualizedItem extends React.PureComponent {\n  ref = React.createRef();\n\n  #onHeightChanged = () => {\n    if (!!this.ref.current) {\n      this.props.onHeightChanged(\n        this.props.entry,\n        this.ref.current.offsetHeight\n      );\n    }\n  };\n\n  #resizeObserver = null;\n\n  componentDidMount() {\n    if (!!this.ref.current) {\n      this.#resizeObserver = new ResizeObserver(this.#onHeightChanged);\n      this.#resizeObserver.observe(this.ref.current);\n    }\n  }\n\n  componentWillUnmount() {\n    if (!!this.#resizeObserver) {\n      this.#resizeObserver.disconnect();\n      this.#resizeObserver = null;\n    }\n  }\n\n  render() {\n    const {\n      scrollableContainerRef,\n      ItemComponent,\n      onHeightChanged,\n      ...otherProps\n    } = this.props;\n\n    return <ItemComponent ref={this.ref} {...otherProps} />;\n  }\n}\n\nexport function VirtualizedList({\n  entries,\n  defaultHeight = 150,\n  scrollableContainerRef,\n  ItemComponent,\n  PlaceholderComponent,\n  ...props\n}) {\n  const [scrollY, setScrollY] = React.useState(0);\n  const [windowHeight, setWindowHeight] = React.useState(window.innerHeight);\n\n  const [realHeightsMap, setRealHeightsMap] = React.useState(new Map());\n  // Beware of maintainig VirtualizedItem pureness during refactoring.\n  // If one entry has changed it shouldn't lead to render() calls for other\n  // entries.\n  const onHeightChanged = React.useCallback((entry, height) => {\n    setRealHeightsMap((oldMap) => {\n      let newMap = new Map(oldMap);\n\n      newMap.set(entry.key, height);\n      return newMap;\n    });\n  }, []);\n\n  const keys = new Set(entries.map((x) => x.key));\n  const keysToDelete = [];\n  realHeightsMap.forEach((_value, key) => {\n    if (!keys.has(key)) {\n      keysToDelete.push(key);\n    }\n  });\n  if (keysToDelete.length > 0) {\n    setRealHeightsMap((oldMap) => {\n      let newMap = new Map(oldMap);\n      keysToDelete.forEach((key) => {\n        if (oldMap.has(key)) newMap.delete(key);\n      });\n      return newMap;\n    });\n  }\n\n  const onResizeOrScroll = () => {\n    if (!!scrollableContainerRef.current)\n      setScrollY(scrollableContainerRef.current.scrollTop);\n    setWindowHeight(window.innerHeight);\n  };\n\n  React.useEffect(() => {\n    if (!!scrollableContainerRef.current)\n      scrollableContainerRef.current.onscroll = onResizeOrScroll;\n    window.addEventListener(\"resize\", onResizeOrScroll);\n    return () => {\n      window.removeEventListener(\"resize\", onResizeOrScroll);\n    };\n  });\n\n  let visibleEntries = [];\n  let currentHeight = 0;\n  let placeholderTop = 0;\n  let placeholderBottom = 0;\n\n  for (let entry of entries) {\n    let entryHeight = defaultHeight;\n    if (realHeightsMap.has(entry.key)) {\n      entryHeight = realHeightsMap.get(entry.key);\n    }\n\n    if (\n      !props.example &&\n      currentHeight + entryHeight < scrollY - window.innerHeight\n    ) {\n      if (entry.focused && !!scrollableContainerRef.current) {\n        scrollableContainerRef.current.scrollTop = currentHeight;\n      }\n\n      placeholderTop += entryHeight;\n    } else if (!!props.example || currentHeight < scrollY + 2 * windowHeight) {\n      visibleEntries.push(\n        <VirtualizedItem\n          key={entry.key}\n          onHeightChanged={onHeightChanged}\n          entry={entry}\n          ItemComponent={ItemComponent}\n          scrollableContainerRef={scrollableContainerRef}\n          {...props}\n        />\n      );\n    } else {\n      if (entry.focused && !!scrollableContainerRef.current) {\n        scrollableContainerRef.current.scrollTop = currentHeight;\n      }\n\n      placeholderBottom += entryHeight;\n    }\n    currentHeight += entryHeight;\n  }\n  if (placeholderTop !== 0) {\n    visibleEntries.unshift(\n      <PlaceholderComponent height={placeholderTop} key=\"placeholderTop\" />\n    );\n  }\n\n  if (placeholderBottom !== 0) {\n    visibleEntries.push(\n      <PlaceholderComponent\n        height={placeholderBottom}\n        key=\"placeholderBottom\"\n      />\n    );\n  }\n\n  return visibleEntries;\n}\n","import React from \"react\";\nimport { Entry } from \"./Entry.js\";\nimport ColumnResizer from \"column-resizer\";\nimport _ from \"lodash\";\nimport moment from \"moment\";\n\nimport { withStyles, Button, IconButton, Grid } from \"@material-ui/core\";\n\nimport { VirtualizedList } from \"./VirtualizedList\";\n\nimport KeyboardEventHandler from \"react-keyboard-event-handler\";\nimport { ArrowDropDown as ArrowIcon } from \"@material-ui/icons\";\n\nconst styles = (theme) => ({\n  scrollableContainer: {\n    overflow: (props) => (props.example ? \"hide\" : \"auto\"),\n    flex: 1,\n    willChange: \"transform\",\n  },\n  grip: {\n    \"&:hover\": {\n      backgroundColor: \"#00F8\",\n      transitionDuration: \"0s\",\n    },\n    width: 8,\n    zIndex: 10,\n    position: \"absolute\",\n    height: \"100%\",\n    backgroundColor: \"#0000\",\n    cursor: \"col-resize\",\n    transitionProperty: \"background-color\",\n    transitionDuration: \"1s\",\n  },\n  entriesTable: {\n    width: \"100%\",\n    borderSpacing: 0,\n    \"& td\": {\n      padding: 2,\n      verticalAlign: \"top\",\n      borderLeft: \"5px solid #0000\",\n      // ColumnResizer sets it to \"hidden\". This cuts emoji popups.\n      overflow: \"inherit !important\",\n    },\n    \"& td:nth-child(odd)\": {\n      borderRight: \"5px solid #0000\",\n      borderLeft: \"20px solid #0000\",\n    },\n\n    [theme.breakpoints.down(\"xs\")]: {\n      \"& thead\": {\n        display: \"none\",\n      },\n\n      \"& tbody tr\": {\n        display: \"grid\",\n        padding: 5,\n        marginBottom: 5,\n        borderRadius: 4,\n        border: \"1px solid\",\n        borderColor: theme.palette.text.secondary,\n      },\n\n      \"& td:nth-child(odd)\": {\n        borderRight: 0,\n        borderLeft: 0,\n      },\n\n      \"& tbody td\": {\n        display: \"block\",\n        borderLeft: 0,\n      },\n    },\n  },\n\n  buttonsContainer: {\n    backgroundColor: theme.palette.background.paper,\n    borderBottom: \"1px solid lightGray\",\n  },\n\n  buttons: {\n    display: \"flex\",\n    justifyContent: \"center\",\n  },\n});\n\nfunction Placeholder({ height, ...rest }) {\n  return (\n    <tr {...rest}>\n      <td colSpan=\"2\">\n        <div style={{ height }} />\n      </td>\n    </tr>\n  );\n}\n\nclass EntriesTableRaw extends React.PureComponent {\n  state = {\n    entries: [],\n  };\n\n  _onEntriesChanged = (entries, settings, { canRedo, canUndo }) => {\n    if (entries.length > 0) {\n      function DateEntry(date) {\n        this.key = this.text = moment(date).calendar({\n          sameDay: \"[Today], MMM Do, ddd\",\n          lastDay: \"[Yesterday] , MMM Do, ddd\",\n          lastWeek: \"MMM Do YYYY, ddd\",\n          sameElse: \"MMM Do YYYY, ddd\",\n        });\n      }\n      entries = [...entries];\n      let dateToInsert = entries[entries.length - 1].creationTime;\n      for (let i = entries.length - 2; i >= 0; i--) {\n        let currentCreationTime = entries[i].creationTime;\n\n        if (dateToInsert == null) {\n          dateToInsert = currentCreationTime;\n          continue;\n        }\n\n        if (\n          !this.props.example &&\n          (currentCreationTime == null ||\n            currentCreationTime.getTime() < dateToInsert.getTime())\n        ) {\n          continue;\n        }\n\n        if (\n          currentCreationTime != null &&\n          currentCreationTime.getYear() === dateToInsert.getYear() &&\n          currentCreationTime.getMonth() === dateToInsert.getMonth() &&\n          currentCreationTime.getDay() === dateToInsert.getDay()\n        ) {\n          continue;\n        }\n\n        entries.splice(i + 1, 0, new DateEntry(dateToInsert));\n        dateToInsert = currentCreationTime;\n      }\n\n      if (dateToInsert != null) {\n        entries.splice(0, 0, new DateEntry(dateToInsert));\n      }\n    }\n\n    this.setState({ entries, settings, canRedo, canUndo });\n  };\n\n  _scrollBy = (top) => {\n    requestAnimationFrame(() => {\n      if (this._scrollableContainerRef.current == null) return;\n      const timeSinceLastScroll = Date.now() - this._lastScrollTime;\n      this._lastScrollTime = Date.now();\n\n      this._scrollableContainerRef.current.scrollBy({\n        top,\n        behavior: timeSinceLastScroll > 300 ? \"smooth\" : \"auto\",\n      });\n    });\n  };\n\n  _onKeyPress = (key, e) => {\n    if (key === \"ctrl+z\") {\n      this.props.model.undo();\n      e.preventDefault();\n    } else if (key === \"ctrl+y\") {\n      this.props.model.redo();\n      e.preventDefault();\n    } else if (key === \"ctrl+enter\") {\n      this.props.model.addNewItemThrottled();\n      e.preventDefault();\n    } else {\n      // When focused item goes out of |VirtualizedList| browsers reset active element to\n      // |docuent.body| and keypresses \"pageup/pagedown/up/down\" stop scrolling\n      // |scrollableContainer|.\n      // The code below is a workaround for that.\n      if (e.target.tabIndex === 0) return;\n      if (key === \"pageup\") {\n        this._scrollBy(-window.innerHeight * 0.8);\n        e.preventDefault();\n      } else if (key === \"pagedown\") {\n        this._scrollBy(window.innerHeight * 0.8);\n        e.preventDefault();\n      } else if (key === \"down\") {\n        this._scrollBy(100);\n        e.preventDefault();\n      } else if (key === \"up\") {\n        this._scrollBy(-100);\n        e.preventDefault();\n      }\n    }\n  };\n\n  _tableRef = React.createRef();\n  _scrollableContainerRef = React.createRef();\n  _columnResizer = null;\n  _resizeObserver = null;\n  _lastScrollTime = Date.now();\n\n  componentDidMount() {\n    this.props.model.subscribe(this._onEntriesChanged);\n\n    if (!!this.props.example) return;\n\n    this._columnResizer = new ColumnResizer(this._tableRef.current, {\n      liveDrag: true,\n      minWidth: 100,\n      gripInnerHtml: `<div class='${this.props.classes.grip}'></div>`,\n      onResize: (e) => {\n        // TextArea adjusts its height only when the browser window\n        // resizes. It ignores resize of its parent.\n        // This logic is encapsulated badly, you cannot change\n        // it without modifying library sources.\n        //\n        // So, the esiest way of forcing TextArea height adjustment is\n        // to dispatch a window resize event hoping that it\n        // won't break anything.\n        window.dispatchEvent(new Event(\"resize\"));\n      },\n    });\n\n    // this._columnResizer doesn't observe resizes of the table.\n    // It listens for browser window \"resize\" events instead.\n    // This doesn't play well when table content asynchronously adjusts\n    // its height listening for the same \"resize\" event.\n    window.removeEventListener(\"resize\", this._columnResizer.onResize);\n    this._resizeObserver = new ResizeObserver(\n      _.throttle(() => {\n        this._columnResizer.onResize();\n      }, 200)\n    );\n    this._resizeObserver.observe(this._tableRef.current);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.model !== prevProps.model) {\n      prevProps.model.unsubscribe(this._onEntriesChanged);\n      this.props.model.subscribe(this._onEntriesChanged);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.model.unsubscribe(this._onEntriesChanged);\n\n    if (!!this.props.example) return;\n\n    this._columnResizer.destroy();\n    this._resizeObserver.unobserve(this._tableRef.current);\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        <KeyboardEventHandler\n          handleFocusableElements\n          handleKeys={[\n            \"ctrl+z\",\n            \"ctrl+y\",\n            \"ctrl+enter\",\n            \"up\",\n            \"down\",\n            \"pagedown\",\n            \"pageup\",\n          ]}\n          onKeyEvent={this._onKeyPress}\n        />\n        {!this.props.example && (\n          <Grid\n            className={this.props.classes.buttonsContainer}\n            container\n            justify=\"space-between\"\n            spacing={0}\n          >\n            <Grid item xs={1} sm={2}>\n              {!this.props.appBarShown && (\n                <IconButton size=\"small\" onClick={this.props.onShowAppBar}>\n                  <ArrowIcon color=\"primary\" />\n                </IconButton>\n              )}\n            </Grid>\n            <Grid className={this.props.classes.buttons} item xs={6} sm={3}>\n              <Button\n                size=\"small\"\n                onClick={() => {\n                  this.props.model.addNewItemThrottled();\n                }}\n              >\n                Add new item\n              </Button>\n            </Grid>\n            <Grid className={this.props.classes.buttons} item xs={5} sm={2}>\n              <Button\n                fullWidth\n                size=\"small\"\n                fontSize=\"small\"\n                onClick={this.props.model.undo}\n                disabled={!this.state.canUndo}\n              >\n                Undo\n              </Button>\n              <Button\n                fullWidth\n                size=\"small\"\n                fontSize=\"small\"\n                disabled={!this.state.canRedo}\n                onClick={this.props.model.redo}\n              >\n                Redo\n              </Button>\n            </Grid>\n          </Grid>\n        )}\n\n        <div\n          ref={this._scrollableContainerRef}\n          className={this.props.classes.scrollableContainer}\n        >\n          <table\n            cellPadding={0}\n            cellSpacing={0}\n            className={this.props.classes.entriesTable}\n            ref={this._tableRef}\n          >\n            {/* ColumnResizer doesn't work without thead */}\n            <thead>\n              <tr>\n                <th></th>\n                <th></th>\n              </tr>\n            </thead>\n\n            <tbody>\n              <VirtualizedList\n                entries={this.state.entries}\n                ItemComponent={Entry}\n                PlaceholderComponent={Placeholder}\n                scrollableContainerRef={this._scrollableContainerRef}\n                // Additional props for Entry\n                onUpdate={this.props.model.onUpdate}\n                onFocus={this.props.onFocus}\n                settings={this.state.settings}\n                example={this.props.example}\n              />\n            </tbody>\n          </table>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\nexport const EntriesTable = withStyles(styles)(EntriesTableRaw);\n","export class Interface {\n  requireFunction(name, ...args) {\n    setTimeout(() => {\n      if (typeof this[name] !== \"function\")\n        throw new Error(name + \" is not implemented\");\n    }, 0);\n  }\n}\n","import { Interface } from \"./Interface.js\";\n\nexport class BackendMap extends Interface {\n  constructor() {\n    super();\n    this.requireFunction(\"createKey\");\n    this.requireFunction(\"delete\", \"key\");\n    this.requireFunction(\"set\", \"key\", \"contentString\");\n    this.requireFunction(\"get\", \"key\");\n    this.requireFunction(\"getMd5\", \"key\");\n    this.requireFunction(\"getAllKeys\");\n    this.requireFunction(\"getSettings\");\n    this.requireFunction(\"setSettings\", \"settings\");\n    this.requireFunction(\"setDescription\", \"key\", \"description\");\n  }\n}\n","import { Interface } from \"./Interface.js\";\nimport { BackendMap } from \"./BackendMap\";\nimport { GDriveStates } from \"./GDriveAuthClient\";\nimport { Settings } from \"./Settings\";\nimport { EntryStatus, EntryModel } from \"./Entry\";\nimport _ from \"lodash\";\nimport { Mutex } from \"async-mutex\";\n\nexport class EntriesTableModel extends Interface {\n  constructor() {\n    super();\n    this.requireFunction(\"subscribe\", \"callback\");\n    this.requireFunction(\"unsubscribe\", \"callback\");\n    this.requireFunction(\"onUpdate\", \"entry\", \"omitHistory\");\n    this.requireFunction(\"onSettingsUpdate\", \"settings\");\n\n    this.requireFunction(\"addNewItem\");\n    this.requireFunction(\"addNewItemThrottled\");\n\n    this.requireFunction(\"undo\");\n    this.requireFunction(\"redo\");\n\n    this.requireFunction(\"sync\");\n  }\n}\n\nexport class EntriesTableModelImpl extends EntriesTableModel {\n  constructor(backendMap, authClient) {\n    console.assert(backendMap instanceof BackendMap);\n    super();\n    this._backendMap = backendMap;\n    this._authClient = authClient;\n    this._syncLoop();\n  }\n\n  dispose() {\n    this._disposed = true;\n    this._subscriptions = new Set();\n  }\n\n  subscribe(callback) {\n    this._subscriptions.add(callback);\n    if (this._entries.size > 0)\n      callback(this._getFilteredEntriesArray(), this._settings);\n  }\n\n  unsubscribe(callback) {\n    this._subscriptions.delete(callback);\n  }\n\n  addNewItemThrottled = _.throttle(() => {\n    this.addNewItem();\n  }, 500);\n\n  addNewItem = async (omitHistory = false) => {\n    let release = await this._addNewItemMutex.acquire();\n\n    const entry = this._tryFindVacantEntry() || (await this._createNewEntry());\n\n    this.onUpdate(\n      entry\n        .clear()\n        .setFocused(true)\n        .setInitiallyCollapsed(true)\n        .setCreationTime(new Date(Date.now())),\n      omitHistory\n    );\n\n    release();\n  };\n\n  // If user deletes entries from top of the table than keys assigned to these\n  // entries can be reused.\n  // This function returns such entry if it exists.\n  _tryFindVacantEntry() {\n    let lastVacantEntry = null;\n    this._entries.forEach((entry) => {\n      if (entry.data === EntryStatus.DELETED) {\n        if (lastVacantEntry == null) lastVacantEntry = entry;\n      } else {\n        lastVacantEntry = null;\n      }\n    });\n\n    return lastVacantEntry;\n  }\n\n  // If there is no deleted entry to reuse the only option is creating a new one.\n  async _createNewEntry() {\n    if (this._entries.has(null)) {\n      return;\n    }\n    this._entries.set(null, new EntryModel(null).delete());\n\n    let newKey = await this._backendMap.createKey();\n\n    if (!this._entries.has(null)) {\n      throw new Error(\"A null key should persist until the new key is created\");\n    }\n\n    let newEntry = new EntryModel(newKey, this._entries.get(null).data, \"\");\n    this._entries.set(newKey, newEntry);\n    await this._sendEntryToBackend(newEntry);\n\n    this._entries.delete(null);\n\n    return newEntry;\n  }\n\n  undo = () => {\n    if (this._historyIndex === 0) return;\n\n    this._historyIndex--;\n\n    let entry = this._history[this._historyIndex].old;\n    if (entry.data !== EntryStatus.DELETED) {\n      entry = entry.setFocused(true);\n      if (this._history[this._historyIndex].new.data === EntryStatus.DELETED) {\n        entry = entry.setInitiallyCollapsed(true);\n      }\n    }\n\n    this._entries.set(entry.key, entry);\n    this._sendEntryToBackend(entry);\n    this._onEntriesChanged();\n  };\n\n  redo = () => {\n    if (this._historyIndex >= this._history.length) return;\n\n    let historyItem = this._history[this._historyIndex++];\n    let entry = historyItem.new;\n    if (entry.data !== EntryStatus.DELETED) {\n      entry = entry.setFocused(true);\n      if (historyItem.old.data === EntryStatus.DELETED) {\n        entry = entry.setInitiallyCollapsed(true);\n      }\n    }\n\n    this._entries.set(entry.key, entry);\n    this._sendEntryToBackend(entry);\n    this._onEntriesChanged();\n  };\n\n  sync = async () => {\n    if (this._disposed) return;\n\n    while (this._authClient.state !== GDriveStates.SIGNED_IN) {\n      await this._authClient.waitForStateChange();\n    }\n\n    let keys = await this._backendMap.getAllKeys();\n\n    let newEntries = new Map();\n\n    keys.forEach((x) => {\n      let entry;\n      if (this._entries.has(x.id)) {\n        entry = this._entries.get(x.id);\n      } else if (x.description === EntryStatus.DELETED) {\n        x.outdated = false;\n        entry = new EntryModel(x.id).delete();\n      } else {\n        x.outdated = true;\n        entry = new EntryModel(\n          x.id,\n          newEntries.size < keys.length - 30\n            ? EntryStatus.HIDDEN\n            : EntryStatus.LOADING,\n          x.description\n        );\n        this._descriptions.set(x.id, x.description);\n      }\n\n      if (x.description !== this._descriptions.get(x.id)) {\n        entry = entry.setDescription(x.description);\n        this._descriptions.set(x.id, x.description);\n      }\n      newEntries.set(x.id, entry);\n    });\n\n    let promises = [];\n    if (this._settings == null) promises.push(this._fetchSettings());\n\n    keys.reverse().forEach((x) => {\n      if (x.outdated && newEntries.get(x.id).data !== EntryStatus.HIDDEN) {\n        promises.push(this._fetch(x.id));\n      }\n    });\n\n    if (this._entries.has(null)) {\n      newEntries.set(null, this._entries.get(null));\n    }\n\n    this._entries = newEntries;\n\n    if (this._entries.size === 0) {\n      await this.addNewItem(true);\n      return;\n    }\n\n    this._onEntriesChanged();\n\n    await Promise.all(promises);\n  };\n\n  onSettingsUpdate = _.debounce((settings) => {\n    this._settings = settings;\n    this._onEntriesChanged();\n    this._backendMap.setSettings(settings.stringify());\n  }, 1000);\n\n  onUpdate = (entry, omitHistory = false) => {\n    if (!this._entries.has(entry.key)) return;\n\n    let prevEntry = this._entries.get(entry.key);\n\n    if (entry.data === EntryStatus.LOADING) {\n      if (prevEntry.data === EntryStatus.HIDDEN) {\n        this._fetch(entry.key);\n        this._entries.set(entry.key, entry);\n      }\n      return;\n    }\n\n    this._sendEntryToBackend(entry);\n    if (!omitHistory) this._addHistoryItem(entry);\n    this._entries.set(entry.key, entry);\n\n    this._onEntriesChanged();\n  };\n\n  _disposed = false;\n  _historyIndex = 0;\n  _history = [];\n  _authClient = null;\n  _backendMap = null;\n  _addNewItemMutex = new Mutex();\n\n  // |_entries| is in reverse order.\n  // It is natural for |Map| to add new items to the end, but\n  // in |EntriesTable| new items belong to the top.\n  _entries = new Map();\n  _settings = null;\n  _descriptions = new Map();\n  _subscriptions = new Set();\n\n  _syncLoop = async () => {\n    await this.sync();\n    setTimeout(this._syncLoop, 15000);\n  };\n\n  _addHistoryItem(newEntry) {\n    if (newEntry.key == null) {\n      throw new Error(\n        \"null key shouldn't have value. There is no point to restore it.\"\n      );\n    }\n\n    if (\n      !this._entries.has(newEntry.key) ||\n      !this._entries.get(newEntry.key).isDataLoaded()\n    ) {\n      return;\n    }\n\n    this._history = this._history.slice(0, this._historyIndex);\n    this._history.push({\n      old: this._entries.has(newEntry.key)\n        ? this._entries.get(newEntry.key)\n        : new EntryModel(newEntry.key).delete(),\n      new: newEntry,\n    });\n    this._historyIndex = this._history.length;\n  }\n\n  async _sendEntryToBackend(entry) {\n    let descriptionPromise = null;\n    if (entry.description !== this._descriptions.get(entry.key)) {\n      descriptionPromise = this._backendMap.setDescription(\n        entry.key,\n        entry.description\n      );\n      this._descriptions.set(entry.key, entry.description);\n    }\n\n    let dataPromise = null;\n    if (entry.isDataLoaded())\n      dataPromise = this._backendMap.set(entry.key, JSON.stringify(entry.data));\n\n    await Promise.all([descriptionPromise, dataPromise]);\n  }\n\n  async _fetchSettings() {\n    const serializedSettings = await this._backendMap.getSettings();\n    if (this._serializedSettings === serializedSettings) return;\n\n    this._serializedSettings = serializedSettings;\n\n    this._settings = new Settings(serializedSettings);\n\n    this._onEntriesChanged();\n  }\n\n  _fetch = async (key) => {\n    let content = await this._backendMap.get(key);\n\n    if (!this._entries.has(key)) {\n      console.error(\"Entry for fetch doesn't exist anymore. \" + key);\n      return;\n    }\n\n    if (content === undefined) {\n      console.error(\"Key \" + key + \" is missing\");\n      this._entries.delete(key);\n      this._onEntriesChanged();\n      return;\n    }\n\n    try {\n      if (content === \"\") {\n        let entry = new EntryModel(key).delete();\n        this._addHistoryItem(entry);\n        this._entries.set(key, entry);\n      } else {\n        const data = JSON.parse(content);\n\n        if (\n          data !== EntryStatus.DELETED &&\n          (data.left == null || data.right == null)\n        ) {\n          throw new Error(\"bad format \" + content);\n        }\n\n        if (\n          data === EntryStatus.DELETED &&\n          this._descriptions.get(key) !== EntryStatus.DELETED\n        ) {\n          this._backendMap.setDescription(key, EntryStatus.DELETED);\n        }\n\n        let entry = new EntryModel(key, data, this._descriptions.get(key));\n\n        this._addHistoryItem(entry);\n        this._entries.set(key, entry);\n      }\n    } catch (e) {\n      console.error(e.message + \" \" + key + \" \" + content);\n      if (!this._entries.get(key).isDataLoaded()) {\n        this._entries.delete(key);\n        this._descriptions.delete(key);\n        this._backendMap.delete(key);\n      }\n    }\n\n    this._onEntriesChanged();\n  };\n\n  _getFilteredEntriesArray() {\n    return Array.from(this._entries.values())\n      .reverse()\n      .filter((x) => x.data !== EntryStatus.DELETED && x.key !== null);\n  }\n\n  _onEntriesChanged() {\n    const entries = this._getFilteredEntriesArray();\n    this._subscriptions.forEach((callback) => {\n      callback(entries, this._settings, {\n        canRedo: this._history.length > this._historyIndex,\n        canUndo: this._history.length > 0 && this._historyIndex > 0,\n      });\n    });\n  }\n}\n","import React from \"react\";\nimport { Button } from \"@material-ui/core\";\nimport { EntriesTable } from \"./EntriesTable\";\nimport { EntriesTableModel } from \"./EntriesTableModel\";\nimport { EntryModel } from \"./Entry\";\nimport { Settings } from \"./Settings\";\n\nexport class ExampleModel extends EntriesTableModel {\n  subscribe(callback) {\n    callback(\n      [\n        new EntryModel(0)\n          .setLeft(\"\")\n          .setRight(\"\")\n          .setCreationTime(new Date(Date.now() - 900000000))\n          .setEmojiLeft([])\n          .setEmojiRight([]),\n        new EntryModel(1)\n          .setLeft(\"\")\n          .setRight(\"\")\n          .setCreationTime(new Date(Date.now() - 804000000))\n          .setEmojiLeft([])\n          .setEmojiRight([]),\n        new EntryModel(2)\n          .setLeft(\"\")\n          .setRight(\"\")\n          .setCreationTime(new Date(Date.now() - 800000000))\n          .setEmojiLeft([])\n          .setEmojiRight([]),\n        new EntryModel(3)\n          .setLeft(\"\")\n          .setRight(\"\")\n          .setCreationTime(new Date(Date.now() - 700000000))\n          .setEmojiLeft([])\n          .setEmojiRight([]),\n        new EntryModel(4)\n          .setLeft(\"\")\n          .setRight(\"\")\n          .setCreationTime(new Date(Date.now() - 600000000))\n          .setEmojiLeft([])\n          .setEmojiRight([]),\n        new EntryModel(5)\n          .setLeft(\"\")\n          .setRight(\"\")\n          .setCreationTime(new Date(Date.now() - 100000000))\n          .setEmojiLeft([])\n          .setEmojiRight([]),\n      ],\n      new Settings(),\n      { canRedo: false, canUndo: false }\n    );\n  }\n  unsubscribe() {}\n  onUpdate() {}\n  onSettingsUpdate() {}\n  setIgnoreKeys() {}\n  addNewItem() {}\n  undo() {}\n  redo() {}\n  addNewItemThrottled() {}\n  sync() {}\n}\n\n// let useStyles = makeStyles((theme) => ({}));\n\nexport const HelpWindow = React.forwardRef((props, ref) => {\n  // let styles = useStyles();\n\n  return (\n    <article ref={ref}>\n      <h1>User Guide</h1>\n      <section>\n        <h4>Privacy note</h4>\n        <p>\n          All user data is stored in a hidden folder in user's Google Drive\n          account. The developers of this site will never have access to your\n          data.\n        </p>\n      </section>\n\n      <section>\n        <h4>What is this site for? </h4>\n        <p>\n          This is a tool for altering your reaction to negative emotions. The\n          main goal is to create a habit of questioning thoughts.\n        </p>\n        <aside>\n          <p>\n            This site is only a supplementary tool for cognitive behavioral\n            therapy. It is no way a replacement for consulting with a therapist.\n            Please, get help!\n          </p>\n          <p>\n            To learn about cognitive behavioral therapy see{\" \"}\n            <a href=\"https://feelinggood.com/\">Feeling Good</a> by David Burns.\n          </p>\n        </aside>\n      </section>\n\n      <section>\n        <h4> Why questioning thoughts helps? </h4>\n        <p>\n          A suffering mind tends to speak to itself coloring and distorting its\n          view of the problem. Because the view is distorted such thoughts don't\n          help feeling good, instead they fuel bad moods and become a problem\n          themselves. The reaction to negative emotions become a source of\n          negative emotions.\n        </p>\n        <p>\n          There are several ways to break this vicious circle. Writing is one of\n          them. Negative thoughts have power because they are subconscious. In\n          other words they are crude and contain a lot of logical mistakes. In\n          order to notice these mistakes you need a habit of questioning your\n          thoughts. When you realize that a thought is wrong it looses its\n          power.\n        </p>\n        <aside>\n          <p>\n            We learn a habit of non-constructive subconscious thinking very\n            early in life. Changing old habits is a gradual process. This is why\n            the first two ingredients of success are <b>persistence</b> and{\" \"}\n            <b>optimism</b>.\n          </p>\n        </aside>\n      </section>\n\n      <section>\n        <h4>How to use it?</h4>\n        <p>\n          When something bothers you open the site and click <b>ADD NEW ITEM</b>{\" \"}\n          (<b>Ctrl+E</b>) and just start answering questions.\n        </p>\n        <p>\n          If some of the questions doesn't fit you open{\" \"}\n          <Button\n            onClick={props.onOpenSettings}\n            size=\"small\"\n            variant=\"contained\"\n            color=\"primary\"\n          >\n            Settings\n          </Button>{\" \"}\n          and change them.\n        </p>\n        <aside>\n          <h5>Tips</h5>\n          <ul>\n            <li>No hurry! It is best to take time thinking before writing.</li>\n            <li>\n              Don't force yourself to write \"correct\" and \"proper\" answers. Just\n              write what you think.\n            </li>\n          </ul>\n        </aside>\n\n        <p>\n          Below is a ficitonal example of a boy struggling with his fear of\n          cats:\n        </p>\n\n        <div></div>\n        <EntriesTable example model={new ExampleModel()}></EntriesTable>\n      </section>\n\n      <section>\n        <h4> </h4>\n        <p></p>\n        <aside></aside>\n      </section>\n    </article>\n  );\n});\n","import React, { Suspense } from \"react\";\n\nimport { ErrorBoundary } from \"react-error-boundary\";\nimport { Settings as SettingsIcon, Help as HelpIcon } from \"@material-ui/icons\";\nimport {\n  AppBar,\n  Backdrop,\n  CircularProgress,\n  Collapse,\n  Grid,\n  Hidden,\n  IconButton,\n  makeStyles,\n  Modal,\n  Slide,\n  Toolbar,\n  Typography,\n} from \"@material-ui/core\";\n\nimport { gdriveAuthClient } from \"./GDriveAuthClient.js\";\nimport { GoogleSignInButton } from \"./GoogleSignInButton.js\";\nimport { HelpWindow } from \"./HelpWindow.js\";\nimport { CenteredTypography } from \"./CenteredTypography\";\nimport KeyboardEventHandler from \"react-keyboard-event-handler\";\nconst SettingsWindow = React.lazy(() => import(\"./SettingsWindow\"));\n\nconst useStyles = makeStyles((theme) => ({\n  buttonsContainer: {\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    alignItems: \"center\",\n  },\n\n  titleContainer: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n\n  modal: {\n    position: \"absolute\",\n    top: \"5%\",\n    left: \"5%\",\n    width: \"90%\",\n    height: \"90%\",\n    backgroundColor: theme.palette.background.default,\n    zIndex: 1000,\n    borderRadius: 4,\n    overflow: \"auto\",\n    display: \"flex\",\n    padding: 10,\n    [theme.breakpoints.up(\"sm\")]: {\n      padding: 30,\n    },\n  },\n}));\n\nfunction ModalWindowButton({ setOpen, open, ...props }) {\n  const styles = useStyles();\n  const onButtonClick = () => {\n    setOpen(true);\n  };\n\n  const onWindowClose = () => {\n    setOpen(false);\n  };\n\n  return (\n    <React.Fragment>\n      <IconButton {...props} onClick={onButtonClick}>\n        {props.children[0]}\n      </IconButton>\n      <Modal open={open} onClose={onWindowClose}>\n        <div className={styles.modal}>\n          <ErrorBoundary\n            fallback={\n              <CenteredTypography>\n                Something went wrong. <br />\n                Reload the page. <br />\n                _\n              </CenteredTypography>\n            }\n          >\n            <KeyboardEventHandler isExclusive />\n            <Suspense\n              fallback={\n                <React.Fragment>\n                  <Backdrop invisible open={true}>\n                    <CircularProgress color=\"inherit\" />\n                  </Backdrop>\n                  <CenteredTypography>Loading...</CenteredTypography>\n                </React.Fragment>\n              }\n            >\n              {React.cloneElement(props.children[1], {\n                onClose: onWindowClose,\n              })}\n            </Suspense>\n          </ErrorBoundary>\n        </div>\n      </Modal>\n    </React.Fragment>\n  );\n}\n\nlet isFirstRender = true;\nconst urlParams = new URLSearchParams(window.location.search);\n\nexport function AppMenu(props) {\n  const [settingsOpen, setSettingsOpen] = React.useState(false);\n  const [helpOpen, setHelpOpen] = React.useState(\n    isFirstRender && !!urlParams.get(\"help\")\n  );\n\n  const classes = useStyles();\n  React.useEffect(() => {\n    isFirstRender = false;\n  }, []);\n  return (\n    <React.Fragment>\n      <Collapse appear={false} in={props.shown}>\n        <Toolbar />\n      </Collapse>\n      <Slide appear={false} direction=\"down\" in={props.shown}>\n        <AppBar>\n          <Toolbar>\n            <Grid container justify=\"space-between\">\n              <Hidden xsDown>\n                <Grid item xs={4}></Grid>\n              </Hidden>\n              <Grid item xs={4} className={classes.titleContainer}>\n                <Hidden xsDown>\n                  <Typography variant=\"h6\" align=\"center\">\n                    Self-help sheets\n                  </Typography>\n                  <Typography variant=\"caption\" align=\"center\">\n                    Document your inner dialog\n                  </Typography>\n                </Hidden>\n                <Hidden smUp>\n                  <Typography align=\"center\">Self-help sheets</Typography>\n                </Hidden>\n              </Grid>\n              <Grid item className={classes.buttonsContainer} xs={8} sm={4}>\n                <ModalWindowButton open={helpOpen} setOpen={setHelpOpen}>\n                  <HelpIcon />\n                  <HelpWindow\n                    onOpenSettings={() => {\n                      setHelpOpen(false);\n                      setSettingsOpen(true);\n                    }}\n                  ></HelpWindow>\n                </ModalWindowButton>\n\n                <ModalWindowButton\n                  open={settingsOpen}\n                  setOpen={setSettingsOpen}\n                  edge=\"start\"\n                >\n                  <SettingsIcon />\n\n                  <SettingsWindow model={props.model} />\n                </ModalWindowButton>\n\n                <GoogleSignInButton\n                  gdriveAuthClient={gdriveAuthClient}\n                ></GoogleSignInButton>\n              </Grid>\n            </Grid>\n          </Toolbar>\n        </AppBar>\n      </Slide>\n    </React.Fragment>\n  );\n}\n","import React from \"react\";\r\nimport { EntriesTable } from \"./EntriesTable.js\";\r\nimport { gdriveAuthClient, GDriveStates } from \"./GDriveAuthClient\";\r\nimport { CenteredTypography } from \"./CenteredTypography\";\r\nimport { Backdrop, CircularProgress } from \"@material-ui/core\";\r\n\r\nexport function AppContent({ model, ...props }) {\r\n  const [signInState, setSignInState] = React.useState(gdriveAuthClient.state);\r\n  React.useEffect(() => {\r\n    gdriveAuthClient.addStateListener(setSignInState);\r\n  }, []);\r\n\r\n  if (signInState === GDriveStates.SIGNED_IN && !!model) {\r\n    return <EntriesTable {...props} model={model} />;\r\n  } else if (signInState === GDriveStates.SIGNED_OUT) {\r\n    return <CenteredTypography>Sign in to proceed...</CenteredTypography>;\r\n  } else {\r\n    return (\r\n      <React.Fragment>\r\n        <Backdrop invisible open={true}>\r\n          <CircularProgress color=\"inherit\" />\r\n        </Backdrop>\r\n        ;<CenteredTypography> Loading...</CenteredTypography>{\" \"}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n","import { gdriveAuthClient, GDriveStates } from \"./GDriveAuthClient.js\";\nimport { BackendMap } from \"./BackendMap.js\";\n\nclass GDriveMap extends BackendMap {\n  #settings_key = null;\n  async _getSettingsKey() {\n    if (this.#settings_key !== null) {\n      return this.#settings_key;\n    }\n\n    let keys = await find('name = \"settings.json\"');\n    if (keys.length === 0) {\n      return await createEmptyFile(\"settings.json\");\n    }\n    if (keys.length === 1) {\n      return keys[0].id;\n    }\n\n    console.error(\"Invalid state. Multiple settings.json. \");\n    let [firstKey, ...restKeys] = keys;\n\n    restKeys.map((x) => deleteFile(x.id));\n\n    return firstKey.id;\n  }\n\n  async createKey() {\n    throwIfNotSignedIn();\n    return await createEmptyFile(\"item.json\");\n  }\n\n  async delete(key) {\n    throwIfNotSignedIn();\n    return await deleteFile(key);\n  }\n\n  async set(key, value) {\n    throwIfNotSignedIn();\n    return await upload(key, value);\n  }\n\n  async get(key) {\n    throwIfNotSignedIn();\n    let result = await download(key);\n    return result;\n  }\n\n  async getMd5(key) {\n    throwIfNotSignedIn();\n    return await getMd5(key);\n  }\n\n  async getAllKeys() {\n    throwIfNotSignedIn();\n    let result = await find('name = \"item.json\"');\n    result.forEach((element) => {\n      if (!element.description) element.description = \"\";\n    });\n    return result;\n  }\n\n  async getSettings() {\n    throwIfNotSignedIn();\n    return await download(await this._getSettingsKey());\n  }\n\n  async setSettings(settingsContent) {\n    throwIfNotSignedIn();\n    await upload(await this._getSettingsKey(), settingsContent);\n  }\n\n  async setDescription(key, description) {\n    throwIfNotSignedIn();\n    return patchDescription(key, description);\n  }\n}\n\nexport const gdriveMap = new GDriveMap();\nObject.seal(gdriveMap);\n\n// PRIVATE SECTION\n// Borrowed from here: https://habr.com/ru/post/440844/\n\nfunction throwIfNotSignedIn() {\n  if (gdriveAuthClient.state !== GDriveStates.SIGNED_IN)\n    throw new Error(\"Incorrect state. Sign in to continue.\");\n}\n\nfunction prom(gapiCall, argObj) {\n  let stack = new Error().stack;\n  return new Promise((resolve, reject) => {\n    gapiCall(argObj).then(\n      (resp) => {\n        if (resp && (resp.status < 200 || resp.status > 299)) {\n          console.log(\"GAPI call returned bad status\", stack, resp);\n          reject(resp);\n        } else {\n          resolve(resp);\n        }\n      },\n      (err) => {\n        console.log(\"GAPI call failed \", stack, err);\n        reject(err);\n      }\n    );\n  });\n}\n\n// returns fileId\nasync function createEmptyFile(name, mimeType) {\n  const resp = await prom(window.gapi.client.drive.files.create, {\n    resource: {\n      name: name,\n      mimeType: mimeType || \"text/plain\",\n      parents: [\"appDataFolder\"],\n    },\n    fields: \"id\",\n  });\n  return resp.result.id;\n}\n\nasync function patchDescription(fileId, description) {\n  console.assert(typeof description === \"string\");\n\n  const boundary = \"-------314159265358979323846\";\n  const delimiter = \"\\r\\n--\" + boundary + \"\\r\\n\";\n  const close_delim = \"\\r\\n--\" + boundary + \"--\";\n\n  let multipartRequestBody =\n    delimiter +\n    \"Content-Type: application/json\\r\\n\\r\\n\" +\n    JSON.stringify({ description }) +\n    close_delim;\n\n  await prom(window.gapi.client.request, {\n    path: `/upload/drive/v3/files/${fileId}`,\n    method: \"PATCH\",\n    params: { uploadType: \"multipart\" },\n    body: multipartRequestBody,\n    headers: {\n      \"Content-Type\": 'multipart/mixed; boundary=\"' + boundary + '\"',\n    },\n  });\n}\n\nasync function upload(fileId, content) {\n  console.assert(typeof content === \"string\");\n  await prom(window.gapi.client.request, {\n    path: `/upload/drive/v3/files/${fileId}`,\n    method: \"PATCH\",\n    params: { uploadType: \"media\" },\n    fields: \"md5Checksum\",\n    body: content,\n  });\n}\n\nasync function getMd5(fileId) {\n  let result = await prom(window.gapi.client.request, {\n    path: `/drive/v3/files/${fileId}`,\n    method: \"GET\",\n    params: { fields: \"md5Checksum\" },\n  });\n\n  return result.result.md5Checksum;\n}\n\nasync function download(fileId) {\n  try {\n    const resp = await prom(window.gapi.client.drive.files.get, {\n      fileId: fileId,\n      alt: \"media\",\n    });\n\n    return resp.body;\n  } catch (e) {\n    if (e.status !== 404) throw e;\n    return undefined;\n  }\n}\n\n// returns file ids sorted by creation time\nasync function find(query) {\n  try {\n    let ret = [];\n    let token;\n    do {\n      const resp = await prom(window.gapi.client.drive.files.list, {\n        spaces: \"appDataFolder\",\n        fields: \"files(id, description, md5Checksum), nextPageToken\",\n        pageSize: 1000,\n        pageToken: token,\n        orderBy: \"createdTime\",\n        q: query,\n      });\n      ret = ret.concat(resp.result.files);\n      token = resp.result.nextPageToken;\n    } while (token);\n    return ret;\n  } catch {\n    return [];\n  }\n}\n\nasync function deleteFile(fileId) {\n  try {\n    await prom(window.gapi.client.drive.files.delete, {\n      fileId: fileId,\n    });\n    return true;\n  } catch (err) {\n    if (err.status === 404) {\n      return false;\n    }\n    throw err;\n  }\n}\n","import { BackendMap } from \"./BackendMap\";\nimport _ from \"lodash\";\nimport md5 from \"md5\";\nimport { Mutex } from \"async-mutex\";\nimport Bottleneck from \"bottleneck\";\n\nconst chunkSize = 8;\n\nexport function applyQuotaSavers(backendMap) {\n  return new BackendMultiplexor(\n    new RequestThrottler(new ErrorHandler(backendMap))\n  );\n}\n\n// Asociates several pseudo keys with each Google Drive key.\n// Reduces amount of calls to _innerBackendMap methods without changing\n// its interface.\n//\n// Prevents users of this class from accessing md5 because server cannot\n// compute md5 for multiplexed sub-items.\n// It replaces |md5checksum| with |outdated|=true in getAllKeys result.\n// |outdated| means that the server has fresher data so the client\n// should call |get| for it.\nexport class BackendMultiplexor extends BackendMap {\n  constructor(innerMap) {\n    super();\n    if (!innerMap instanceof BackendMap)\n      throw new Error(\n        \"CachingBackendMap have to accepts instance of BackendMap\"\n      );\n    this._innerBackendMap = innerMap;\n  }\n\n  async createKey() {\n    let release = await this._changeKeysMutex.acquire();\n    try {\n      if (this._innerKeys === null) {\n        throw new Error(\"You should call getAllKeys first\");\n      }\n\n      let getLastInnerKey = () => {\n        if (this._innerKeys.length === 0) return undefined;\n        return this._innerKeys[this._innerKeys.length - 1];\n      };\n\n      if (\n        this._innerKeys.length === 0 ||\n        this._chunks.get(getLastInnerKey()).isFull()\n      ) {\n        let newInnerKey = await this._innerBackendMap.createKey();\n        this._innerKeys.push(newInnerKey);\n        this._chunks.set(\n          newInnerKey,\n          new this._Chunk({\n            connector: this._createChunkConnector(newInnerKey),\n          })\n        );\n      }\n\n      let innerKey = getLastInnerKey();\n      let keyPrefix = await this._chunks.get(innerKey).createSubKey();\n      return keyPrefix + \"-\" + innerKey;\n    } finally {\n      release();\n    }\n  }\n\n  async delete(key) {\n    let release = await this._changeKeysMutex.acquire();\n    try {\n      const { prefixKey, innerKey } = this._splitOuterKey(key);\n      if (!this._chunks.has(innerKey)) return;\n\n      await this._chunks.get(innerKey).delete(prefixKey);\n    } finally {\n      release();\n    }\n  }\n\n  async set(key, value) {\n    const { prefixKey, innerKey } = this._splitOuterKey(key);\n    if (!this._chunks.has(innerKey)) return;\n    this._chunks.get(innerKey).setValue(prefixKey, value);\n  }\n\n  async getMd5(key) {\n    throw new Error(\n      \"Don't call getMd5 on this class. \" +\n        \"Server cannot compute md5 for this item because it is multiplexed.\" +\n        \"In order to sync call |getAllKeys| and if some item has |outdated===true| call |get|.\"\n    );\n  }\n\n  async get(key) {\n    const { prefixKey, innerKey } = this._splitOuterKey(key);\n    if (!this._chunks.has(innerKey)) return undefined;\n    return this._chunks.get(innerKey).getValue(prefixKey);\n  }\n\n  async getAllKeys() {\n    let release = await this._changeKeysMutex.acquire();\n    try {\n      let newInnerKeys = await this._innerBackendMap.getAllKeys();\n      let outerKeys = [];\n      let newChunks = new Map();\n      let counter = 0;\n\n      newInnerKeys.forEach((innerKey) => {\n        let outdated = true;\n        let isFirstChunk = counter++ === 0;\n\n        if (this._chunks.has(innerKey.id)) {\n          let chunk = this._chunks.get(innerKey.id);\n          newChunks.set(innerKey.id, chunk);\n\n          outdated = chunk.onMetadataUpdate(\n            innerKey.description,\n            innerKey.md5Checksum\n          ).outdated;\n        } else {\n          newChunks.set(\n            innerKey.id,\n            new this._Chunk({\n              connector: this._createChunkConnector(innerKey.id),\n              serializedDescriptions: innerKey.description,\n              isFirstChunk,\n              md5Checksum: innerKey.md5Checksum,\n            })\n          );\n        }\n        let chunk = newChunks.get(innerKey.id);\n        chunk.listSubKeys().forEach((subkey) => {\n          outerKeys.push({\n            id: subkey + \"-\" + innerKey.id,\n            outdated,\n            description: chunk.getDescription(subkey),\n          });\n        });\n      });\n\n      this._chunks = newChunks;\n      this._innerKeys = newInnerKeys.map((x) => x.id);\n\n      return outerKeys;\n    } finally {\n      release();\n    }\n  }\n\n  async getSettings() {\n    return await this._innerBackendMap.getSettings();\n  }\n\n  async setSettings(settingsContent) {\n    let release = await this._changeKeysMutex.acquire();\n    await this._innerBackendMap.setSettings(settingsContent);\n    release();\n  }\n\n  async setDescription(key, description) {\n    const { prefixKey, innerKey } = this._splitOuterKey(key);\n    if (!this._chunks.has(innerKey)) return;\n    this._chunks.get(innerKey).setDescription(prefixKey, description);\n  }\n\n  // PRIVATE SECTION\n  _changeKeysMutex = new Mutex();\n\n  _innerKeys = null;\n  _innerBackendMap = null;\n\n  _createChunkConnector = (innerkey) => {\n    return {\n      setValue: (serializedValue) => {\n        this._innerBackendMap.set(innerkey, serializedValue);\n      },\n      setDescription: (serializedDescription) => {\n        this._innerBackendMap.setDescription(innerkey, serializedDescription);\n      },\n      getValue: async () => {\n        return await this._innerBackendMap.get(innerkey);\n      },\n      delete: async () => {\n        this._innerKeys.splice(this._innerKeys.indexOf(innerkey), 1);\n        this._chunks.delete(innerkey);\n        await this._innerBackendMap.delete(innerkey);\n      },\n    };\n  };\n\n  // Contains instances of |this._Chunk| for each key inside |this._innerKeys|.\n  _chunks = new Map();\n\n  // Each inner key contains a chunk of outer keys.\n  // If innerBackendMap creates key \"abcdefg\", BackendMultiplexor will\n  // use it to store chunk of sub-keys : \"0-abcdefg\", \"1-abcdefg\", ..., \"chunkSize-abcdefg\"\n  //\n  // To get \"4-abcdefg\" description you should make the next call:\n  // this._chunks[\"abcdefg\"].getDescription(4)\n  //\n  // md5Checksum is common for all subkeys.\n  _Chunk = class {\n    constructor({ connector, serializedDescriptions, md5Checksum }) {\n      this._connector = connector;\n      this._initialMd5Checksum = md5Checksum;\n      if (serializedDescriptions === undefined) {\n        this._values = Array(chunkSize).fill(\"\");\n        this._descriptions = [];\n        this._isDirty = true;\n      } else {\n        this._serializedDescriptions = serializedDescriptions;\n        this._isDirty = false;\n        this._descriptions = serializedDescriptions\n          .split(\",\")\n          .map((x) => (x === \"null\" ? null : x));\n      }\n    }\n\n    isFull() {\n      return this._descriptions.length >= chunkSize;\n    }\n\n    listSubKeys() {\n      let subkeys = [];\n      for (let i = 0; i < this._descriptions.length && i < chunkSize; i++)\n        if (this._descriptions[i] != null) subkeys.push(i);\n      return subkeys;\n    }\n\n    async createSubKey() {\n      this._shouldKeepOnFormatError = true;\n\n      try {\n        if (this._values == null) await this._fetchValuesSynchronised();\n        if (this._values == null) return null;\n\n        if (this.isFull())\n          throw new Error(\"Do not call createSubKey for full chunks\");\n\n        let subkey = this._descriptions.length;\n        this._descriptions.push(\"\");\n        // Just to set correct state;\n        this.setDescription(subkey, \"\");\n\n        return subkey;\n      } finally {\n        this._shouldKeepOnFormatError = false;\n      }\n    }\n\n    async delete(subkey) {\n      if (this._descriptions[subkey] == null)\n        throw new Error(\"item is already deleted\");\n      if (this._descriptions.filter((x) => x != null).length === 1)\n        await this._connector.delete();\n      else this.setDescription(subkey, null);\n    }\n\n    async setValue(subkey, value) {\n      if (this._values == null) await this._fetchValuesSynchronised();\n      if (this._values == null) return;\n\n      this._values[subkey] = value;\n      this._isDirty = true;\n      this._serializedValues = null;\n      this._onValueSet();\n    }\n\n    async getValue(subkey) {\n      if (this._descriptions[subkey] === null) return undefined;\n      if (this._values == null) await this._fetchValuesSynchronised();\n      if (this._values == null) return undefined;\n\n      return this._values[subkey];\n    }\n\n    setDescription(subkey, description) {\n      if (\n        subkey >= this._descriptions.length ||\n        this._descriptions[subkey] == null\n      ) {\n        throw new Error(\n          \"null description means subkey doesn't exist. Did you call createKey?\"\n        );\n      }\n\n      this._descriptions[subkey] = description;\n      this._serializedDescriptions = null;\n      this._isDirty = true;\n\n      this._onDescriptionSet();\n    }\n\n    getDescription(subkey) {\n      return this._descriptions[subkey];\n    }\n\n    onMetadataUpdate(serializedDescriptions, md5Checksum) {\n      if (this._isDirty) {\n        if (\n          this._serializedValues != null &&\n          this._serializedDescriptions != null &&\n          md5(this._serializedValues) === md5Checksum &&\n          this._serializedDescriptions === serializedDescriptions\n        ) {\n          this._isDirty = false;\n          this._initialMd5Checksum = md5Checksum;\n        }\n        return { outdated: false };\n      }\n\n      if (this._serializedDescriptions !== serializedDescriptions) {\n        this._serializedDescriptions = serializedDescriptions;\n\n        this._descriptions = serializedDescriptions\n          .split(\",\")\n          .map((x) => (x === \"null\" ? null : x));\n      }\n\n      if (this._initialMd5Checksum !== md5Checksum) {\n        this._serializedValues = null;\n        this._values = null;\n        return { outdated: true };\n      }\n\n      return { outdated: false };\n    }\n\n    // PRIVATE SECTION\n\n    // |values| and |descriptions| are arrays containing up-to chunkSize elements.\n    _values;\n    _descriptions;\n\n    // result of JSON.stringify(this.values);\n    _serializedValues;\n    _serializedDescriptions;\n\n    _connector;\n\n    // |isDirty| is set true when |set| for one of subkeys has been called.\n    // In that case BackendMultiplexor will think that it has the most fresh data\n    // and it will ignore updates in |getAllKeys| until it contains |md5Checksum|\n    // equal to md5(this.serializedValues).\n    _isDirty;\n\n    // This is md5 checksum for values acquired from server.\n    // It is used only when |isDirty| === false.\n    _initialMd5Checksum;\n\n    _onValueSet = _.debounce(() => {\n      this._serializedValues = JSON.stringify(this._values);\n      this._connector.setValue(this._serializedValues);\n    }, 1000);\n\n    _onDescriptionSet = _.debounce(() => {\n      this._serializedDescriptions = this._descriptions\n        .map((x) => (x === null ? \"null\" : x))\n        .join(\",\");\n\n      this._connector.setDescription(this._serializedDescriptions);\n    }, 1000);\n\n    _fetchValuesSynchronised = async () => {\n      if (this._fetchPromise == null) {\n        this._fetchPromise = this._fetchValues();\n      }\n      await this._fetchPromise;\n      this._fetchPromise = null;\n    };\n    _fetchPromise = null;\n    _fetchValues = async () => {\n      let serializedValues = await this._connector.getValue();\n      try {\n        let values = JSON.parse(serializedValues);\n        if (!Array.isArray(values)) {\n          throw new Error(\"Bad server data. Not valid array\");\n        }\n\n        while (values.length < this._descriptions.length) {\n          values.push(\"\");\n        }\n        this._values = values;\n        this._serializedValues = serializedValues;\n        this._initialMd5Checksum = md5(serializedValues);\n        this._isDirty = false;\n      } catch (error) {\n        // In theory, server may contain arbitrary data.\n        // BackendMultiplexor should be able recover in this case.\n        console.error(\n          \"Bad response from server:\" + error.message + \" \" + serializedValues\n        );\n        if (this._shouldKeepOnFormatError) {\n          this._values = Array(chunkSize).fill(\"\");\n          this._isDirty = true;\n          this._serializedValues = null;\n          this._onValueSet();\n        } else {\n          this._connector.delete();\n        }\n      }\n    };\n  };\n\n  _splitOuterKey = (outerKey) => {\n    let separator = outerKey.indexOf(\"-\");\n    let prefixKey = Number(outerKey.substring(0, separator));\n    let innerKey = outerKey.substring(separator + 1);\n    return { prefixKey, innerKey };\n  };\n}\n\nexport class ErrorHandler extends BackendMap {\n  constructor(innerMap) {\n    super();\n    if (!innerMap instanceof BackendMap)\n      throw new Error(\n        \"CachingBackendMap have to accepts instance of BackendMap\"\n      );\n    this._innerBackendMap = innerMap;\n  }\n\n  async _exponentialRetry(callback) {\n    let retriesCount = 1;\n    while (retriesCount < 10) {\n      try {\n        return await callback();\n      } catch (error) {\n        let secondsToNextRetry = 1 * 3 ** retriesCount++;\n        console.error(\n          `Failed running ${callback.name} : ${error.message}. Will try again after ${secondsToNextRetry} seconds.`\n        );\n        await this._sleep(secondsToNextRetry * 1000);\n      }\n    }\n\n    console.error(\"finish retry attempts\");\n  }\n\n  async createKey() {\n    return await this._exponentialRetry(\n      this._innerBackendMap.createKey.bind(this._innerBackendMap)\n    );\n  }\n\n  async delete(key) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.delete.bind(this._innerBackendMap, key)\n    );\n  }\n\n  async set(key, value) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.set.bind(this._innerBackendMap, key, value)\n    );\n  }\n\n  async get(key) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.get.bind(this._innerBackendMap, key)\n    );\n  }\n\n  async getMd5(key) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.getMd5.bind(this._innerBackendMap, key)\n    );\n  }\n\n  async getAllKeys() {\n    return await this._exponentialRetry(\n      this._innerBackendMap.getAllKeys.bind(this._innerBackendMap)\n    );\n  }\n\n  async getSettings() {\n    return await this._exponentialRetry(\n      this._innerBackendMap.getSettings.bind(this._innerBackendMap)\n    );\n  }\n\n  async setSettings(settingsContent) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.setSettings.bind(\n        this._innerBackendMap,\n        settingsContent\n      )\n    );\n  }\n\n  async setDescription(key, description) {\n    return await this._exponentialRetry(\n      this._innerBackendMap.setDescription.bind(\n        this._innerBackendMap,\n        key,\n        description\n      )\n    );\n  }\n\n  _innerBackendMap = null;\n  _sleep(ms) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n  }\n}\n\nexport class RequestThrottler extends BackendMap {\n  _innerBackendMap = null;\n  constructor(innerMap) {\n    super();\n    if (!innerMap instanceof BackendMap)\n      throw new Error(\n        \"CachingBackendMap have to accepts instance of BackendMap\"\n      );\n    this._innerBackendMap = innerMap;\n    this._limiter = new Bottleneck({\n      maxConcurrent: 5,\n      minTime: 50,\n    });\n  }\n\n  async createKey() {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.createKey()\n    );\n  }\n\n  async delete(key) {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.delete(key)\n    );\n  }\n\n  async set(key, value) {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.set(key, value)\n    );\n  }\n\n  async get(key) {\n    return await this._limiter.schedule(() => this._innerBackendMap.get(key));\n  }\n\n  async getMd5(key) {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.getMd5(key)\n    );\n  }\n\n  async getAllKeys() {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.getAllKeys()\n    );\n  }\n\n  async getSettings() {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.getSettings()\n    );\n  }\n\n  async setSettings(settingsContent) {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.setSettings(settingsContent)\n    );\n  }\n\n  async setDescription(key, description) {\n    return await this._limiter.schedule(() =>\n      this._innerBackendMap.setDescription(key, description)\n    );\n  }\n}\n","import React from \"react\";\nimport \"./App.css\";\nimport \"fontsource-roboto\";\nimport {\n  createMuiTheme,\n  CssBaseline,\n  ThemeProvider,\n  useMediaQuery,\n} from \"@material-ui/core\";\nimport { blue, blueGrey } from \"@material-ui/core/colors\";\n\nimport { AppMenu } from \"./AppMenu.js\";\nimport { AppContent } from \"./AppContent.js\";\nimport { gdriveMap } from \"./GDriveMap\";\nimport { gdriveAuthClient, GDriveStates } from \"./GDriveAuthClient\";\nimport { EntriesTableModelImpl } from \"./EntriesTableModel\";\nimport { applyQuotaSavers } from \"./BackendQuotaSavers\";\n\nfunction App() {\n  const prefersDarkMode = useMediaQuery(\"(prefers-color-scheme: dark)\");\n\n  const theme = React.useMemo(\n    () =>\n      createMuiTheme({\n        palette: {\n          type: prefersDarkMode ? \"dark\" : \"light\",\n          primary: { main: prefersDarkMode ? blueGrey[900] : blue[800] },\n          background: {\n            default: prefersDarkMode ? \"#303030\" : blueGrey[50],\n          },\n        },\n      }),\n    [prefersDarkMode]\n  );\n  const [appBarShown, setAppBarShown] = React.useState(true);\n  const onTableEntryFocus = React.useCallback((arg) => {\n    if (window.innerHeight < 700) {\n      setAppBarShown(false);\n    }\n  }, []);\n\n  const showAppBar = React.useCallback((arg) => {\n    setAppBarShown(true);\n  }, []);\n\n  const [model, setModel] = React.useState(null);\n\n  React.useEffect(() => {\n    gdriveAuthClient.addStateListener((newState) => {\n      if (newState === GDriveStates.SIGNED_IN) {\n        setModel(\n          new EntriesTableModelImpl(\n            applyQuotaSavers(gdriveMap),\n            gdriveAuthClient\n          )\n        );\n      } else {\n        setModel((oldModel) => {\n          if (!!oldModel) oldModel.dispose();\n          return null;\n        });\n      }\n    });\n  }, []);\n\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      <AppMenu shown={appBarShown} model={model}></AppMenu>\n      <AppContent\n        onFocus={onTableEntryFocus}\n        appBarShown={appBarShown}\n        onShowAppBar={showAppBar}\n        model={model}\n      />\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import React from \"react\";\nimport { Typography, makeStyles } from \"@material-ui/core\";\n\nconst useStyles = makeStyles({\n  container: {\n    flex: 1,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n});\nexport function CenteredTypography(props) {\n  const classes = useStyles();\n  return (\n    <div className={classes.container}>\n      <Typography align=\"center\" variant=\"h4\" {...props}>\n        {props.children}\n      </Typography>\n    </div>\n  );\n}\n","class Hint {\r\n  _isEnabled;\r\n  _text;\r\n\r\n  get isEnabled() {\r\n    return this._isEnabled;\r\n  }\r\n  get text() {\r\n    return this._text;\r\n  }\r\n\r\n  setIsEnabled(isEnabled) {\r\n    return new Hint({ isEnabled, text: this._text });\r\n  }\r\n\r\n  setText(text) {\r\n    return new Hint({ text, isEnabled: this._isEnabled });\r\n  }\r\n\r\n  constructor(data) {\r\n    if (typeof data === \"string\") data = JSON.parse(data);\r\n\r\n    if (typeof data.isEnabled !== \"boolean\" || typeof data.text !== \"string\")\r\n      throw new Error(\"Wrong hint data \" + JSON.stringify(data));\r\n    this._isEnabled = data.isEnabled;\r\n    this._text = data.text;\r\n  }\r\n\r\n  stringify() {\r\n    return JSON.stringify({ isEnabled: this._isEnabled, text: this._text });\r\n  }\r\n}\r\n\r\nexport class Settings {\r\n  get emojiList() {\r\n    return this._emojiList;\r\n  }\r\n  get leftHint() {\r\n    return this._leftHint;\r\n  }\r\n  get rightHint() {\r\n    return this._rightHint;\r\n  }\r\n\r\n  setEmojiList(emojiList) {\r\n    return new Settings({\r\n      emojiList,\r\n      leftHint: this._leftHint,\r\n      rightHint: this._rightHint,\r\n    });\r\n  }\r\n  setLeftHint(leftHint) {\r\n    return new Settings({\r\n      emojiList: this._emojiList,\r\n      leftHint,\r\n      rightHint: this._rightHint,\r\n    });\r\n  }\r\n\r\n  setRightHint(rightHint) {\r\n    return new Settings({\r\n      emojiList: this._emojiList,\r\n      leftHint: this._leftHint,\r\n      rightHint,\r\n    });\r\n  }\r\n\r\n  stringify() {\r\n    return JSON.stringify({\r\n      emojiList: this._emojiList,\r\n      leftHint: this._leftHint.stringify(),\r\n      rightHint: this._rightHint.stringify(),\r\n    });\r\n  }\r\n\r\n  constructor(json) {\r\n    try {\r\n      if (typeof json === \"string\") json = JSON.parse(json);\r\n\r\n      if (\r\n        !Array.isArray(json.emojiList) ||\r\n        !json.emojiList.every(\r\n          (x) => typeof String.fromCodePoint(x.codePoint) === \"string\"\r\n        )\r\n      ) {\r\n        throw new Error(\"Bad emoji list: \" + JSON.stringify(json));\r\n      }\r\n\r\n      this._emojiList = json.emojiList;\r\n      this._leftHint = new Hint(json.leftHint);\r\n      this._rightHint = new Hint(json.rightHint);\r\n    } catch (error) {\r\n      if (!!json) console.error(\"Settings format error:\" + error.message);\r\n      this._mutateToDefaults();\r\n    }\r\n  }\r\n\r\n  _mutateToDefaults() {\r\n    this._leftHint = new Hint({\r\n      isEnabled: true,\r\n      text: \"What happened?\\nWhat were your immediate thoughts?\",\r\n    });\r\n\r\n    this._rightHint = new Hint({\r\n      isEnabled: true,\r\n      text:\r\n        \"Why is it bad?\\n\" +\r\n        \"What would your therapist say?\\n\" +\r\n        \"Is your view of the problem biased?\",\r\n    });\r\n\r\n    this._emojiList = [\r\n      { codePoint: 0x1f44e, text: \"discontent\" },\r\n      { codePoint: 0x1f628, text: \"fear\" },\r\n      { codePoint: 0x1f622, text: \"sadness\" },\r\n      { codePoint: 0x1f62d, text: \"grief\" },\r\n      { codePoint: 0x1f631, text: \"horror\" },\r\n      { codePoint: 0x1f616, text: \"pain\" },\r\n      { codePoint: 0x1f621, text: \"anger\" },\r\n      { codePoint: 0x1f922, text: \"disgust\" },\r\n    ];\r\n  }\r\n\r\n  _emojiList;\r\n  _leftHint;\r\n  _rightHint;\r\n}\r\n"],"sourceRoot":""}