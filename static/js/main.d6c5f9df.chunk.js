(this["webpackJsonpself-help-sheets"]=this["webpackJsonpself-help-sheets"]||[]).push([[0],{119:function(e,t,n){e.exports=n(157)},124:function(e,t,n){},125:function(e,t,n){},13:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return f}));var r=n(64),a=n(2),i=n.n(a),s=n(4),o=n(11),c=n(10),u=n(9),l=n(27),h={LOADING:"loading",SIGNED_IN:"signed_in",SIGNED_OUT:"signed_out",FAILED:"failed"};Object.freeze(h);var d=Object(l.a)("state"),p=Object(l.a)("stateListeners"),f=new(function(){function e(){var t=this;Object(o.a)(this,e),Object.defineProperty(this,d,{writable:!0,value:h.LOADING}),Object.defineProperty(this,p,{writable:!0,value:new Set}),function(e){console.assert("function"==typeof e),console.assert(0===e.length);var t=document.createElement("script");t.async=!0,t.src="https://apis.google.com/js/api.js",document.body.appendChild(t),t.onload=e,t.onerror=e}(Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,window.gapi){e.next=3;break}throw new Error("Failed loading GAPI");case 3:return e.next=5,new Promise((function(e){return window.gapi.load("client:auth2",e)}));case 5:return e.next=7,window.gapi.client.init({clientId:"479709565206-4ek8a502261s9sussiehpa5v146ns2ku.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:"https://www.googleapis.com/auth/drive.appfolder"});case 7:if(m()){e.next=9;break}throw new Error("Failed registering client_id.");case 9:t._updateSignInState(),window.gapi.auth2.getAuthInstance().isSignedIn.listen(t._updateSignInState.bind(t)),e.next=19;break;case 13:return e.prev=13,e.t0=e.catch(0),console.log(e.t0),Object(u.a)(t,d)[d]=h.FAILED,t._notifyStateChanged(),e.abrupt("return");case 19:case"end":return e.stop()}}),e,null,[[0,13]])}))))}return Object(c.a)(e,[{key:"addStateListener",value:function(e){console.assert("function"==typeof e),console.assert(1===e.length),console.assert(!Object(u.a)(this,p)[p].has(e)),Object(u.a)(this,p)[p].add(e)}},{key:"removeStateListener",value:function(e){console.assert("function"==typeof e),console.assert(1===e.length),console.assert(Object(u.a)(this,p)[p].has(e)),Object(u.a)(this,p)[p].delete(e)}},{key:"waitForStateChange",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){t.addStateListener((function n(r){t.removeStateListener(n),e(r)}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"state",get:function(){return Object(u.a)(this,d)[d]}}]),Object(c.a)(e,[{key:"signIn",value:function(){console.assert(m()),window.mocha?window.gapi.auth2.getAuthInstance().signIn():window.gapi.auth2.getAuthInstance().signIn({prompt:"select_account"})}},{key:"signOut",value:function(){console.assert(m()),window.gapi.auth2.getAuthInstance().signOut()}},{key:"_notifyStateChanged",value:function(){var e,t=Object(r.a)(Object(u.a)(this,p)[p]);try{for(t.s();!(e=t.n()).done;){(0,e.value)(Object(u.a)(this,d)[d])}}catch(n){t.e(n)}finally{t.f()}}},{key:"_updateSignInState",value:function(){console.assert(Object(u.a)(this,d)[d]!==h.FAILED);var e=(console.assert(m()),window.gapi.auth2.getAuthInstance().isSignedIn.get()?h.SIGNED_IN:h.SIGNED_OUT);Object(u.a)(this,d)[d]!==e&&(Object(u.a)(this,d)[d]=e,this._notifyStateChanged())}}]),e}());function m(){return window.gapi&&window.gapi.auth2&&window.gapi.client}Object.seal(f)},157:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(15),s=n.n(i),o=(n(124),n(16)),c=(n(125),n(126),n(193)),u=n(109),l=n(202),h=n(203),d=n(201),p=n(73),f=n(33),m=n(104),y=n(194),b=n(195),v=n(161),g=n(185),_=n(205),k=n(188),w=n(189),j=n(190),x=n(191),E=n(192),O=n(206),C=n(111),S=n(13),D=n(2),A=n.n(D),I=n(4),M=n(20),N=n(11),F=n(10),K=n(28),B=n(18),L=n(17),R=n(9),T=n(27),z=function(e){e.active;return a.a.createElement("div",{style:{display:"flex",padding:10}},a.a.createElement("svg",{width:"18",height:"18",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("g",{fill:"#000",fillRule:"evenodd"},a.a.createElement("path",{d:"M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z",fill:"#EA4335"}),a.a.createElement("path",{d:"M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z",fill:"#4285F4"}),a.a.createElement("path",{d:"M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z",fill:"#FBBC05"}),a.a.createElement("path",{d:"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z",fill:"#34A853"}),a.a.createElement("path",{fill:"none",d:"M0 0h18v18H0z"}))))},P=n(187),H=n(204),U=n(186),V=function(e){var t=e.children;return a.a.createElement("span",{style:{padding:10,paddingLeft:0,fontWeight:500}},t)},q={backgroundColor:"#fff",display:"inline-flex",alignItems:"center",color:"rgba(0, 0, 0, .54)",boxShadow:"0 2px 2px 0 rgba(0, 0, 0, .24), 0 0 1px 0 rgba(0, 0, 0, .24)",padding:0,borderRadius:2,border:"1px solid transparent",fontSize:14,fontWeight:"500",fontFamily:"Roboto, sans-serif",cursor:"pointer"},G={opacity:.6},W=Object(T.a)("setAuthState"),J=Object(T.a)("setButtonAnchor"),Y=Object(T.a)("getButtonStyle"),X=Object(T.a)("onClick"),$=function(e){Object(B.a)(n,e);var t=Object(L.a)(n);function n(){var e;Object(N.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={authState:e.props.gdriveAuthClient.state,prevAuthState:e.props.gdriveAuthClient.LOADING,buttonAnchor:null},Object.defineProperty(Object(K.a)(e),W,{writable:!0,value:function(t){e.setState((function(e){return Object(M.a)(Object(M.a)({},e),{},{prevAuthState:e.authState,authState:t})}))}}),Object.defineProperty(Object(K.a)(e),J,{writable:!0,value:function(t){e.setState((function(e){return Object(M.a)(Object(M.a)({},e),{},{buttonAnchor:t})}))}}),Object.defineProperty(Object(K.a)(e),Y,{writable:!0,value:function(){return e.state.authState===S.a.FAILED||e.state.authState===S.a.LOADING?Object.assign({},q,G):q}}),Object.defineProperty(Object(K.a)(e),X,{writable:!0,value:function(){var t=Object(I.a)(A.a.mark((function t(){return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state.authState===S.a.SIGNED_IN?e.props.gdriveAuthClient.signOut():e.state.authState===S.a.SIGNED_OUT&&e.props.gdriveAuthClient.signIn();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}),e}return Object(F.a)(n,[{key:"componentDidMount",value:function(){this.state.authState!==this.props.gdriveAuthClient.state&&Object(R.a)(this,W)[W](this.props.gdriveAuthClient.state),this.props.gdriveAuthClient.addStateListener(Object(R.a)(this,W)[W])}},{key:"componentWillUnmount",value:function(){this.props.gdriveAuthClient.removeStateListener(Object(R.a)(this,W)[W])}},{key:"render",value:function(){var e=this,t=function(){if(e.state.authState===S.a.FAILED)return a.a.createElement(H.a,{severity:"error"},"Failed connecting to google. Check your connection and try reloading the page.");if(e.state.authState===S.a.SIGNED_OUT){if(e.state.prevAuthState===S.a.SIGNED_IN)return a.a.createElement(H.a,{severity:"warning"},a.a.createElement(U.a,null,"Privacy note!"),"If other people have access to this browser ",a.a.createElement("br",null),"AND you don't want them to read your sheets: ",a.a.createElement("br",null),a.a.createElement("ol",null,a.a.createElement("li",null,"sign out globally: ",a.a.createElement("br",null),a.a.createElement("a",{href:"https://accounts.google.com/Logout"},"https://accounts.google.com/Logout")),a.a.createElement("li",null,"delete Google account password from the browser")));if(e.state.prevAuthState===S.a.LOADING)return a.a.createElement(H.a,{severity:"info"},"This site stores data in a hidden Google Drive folder. ",a.a.createElement("br",null),"Sign in to proceed.",a.a.createElement("br",null))}}();return a.a.createElement("button",{ref:function(t){return Object(R.a)(e,J)[J](t)},onClick:Object(R.a)(this,X)[X],style:Object(R.a)(this,Y)[Y](),type:"button"},a.a.createElement(z,{key:0,active:this.state.active}),a.a.createElement(V,{key:2},this.state.authState===S.a.SIGNED_IN?"Sign Out":"Sign In "),!!t&&!!this.state.buttonAnchor&&a.a.createElement(P.a,{key:1,style:{zIndex:1200},open:!0,anchorEl:this.state.buttonAnchor,placement:"bottom-end",disablePortal:!1,modifiers:{flip:{enabled:!1},preventOverflow:{enabled:!1},hide:{enabled:!1},offset:{offset:"0,5"}}},t))}}]),n}(a.a.PureComponent),Q=Object(v.a)((function(e){return{root:{position:"absolute",top:"5%",left:"5%",width:"90%",height:"90%",backgroundColor:e.palette.background.paper,zIndex:1}}})),Z=a.a.forwardRef((function(e,t){var n=Q();return a.a.createElement("article",Object.assign({className:n.root},e,{ref:t}),a.a.createElement("h1",null,"User Guide"))})),ee=n(55),te=a.a.lazy((function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,232))})),ne=Object(v.a)((function(e){return{buttonsContainer:{display:"flex",justifyContent:"flex-end",alignItems:"center"},titleContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},modal:Object(f.a)({position:"absolute",top:"5%",left:"5%",width:"90%",height:"90%",backgroundColor:e.palette.background.default,zIndex:1e3,borderRadius:4,overflow:"auto",padding:10},e.breakpoints.up("sm"),{padding:30})}}));function re(e){var t=a.a.useState(!1),n=Object(o.a)(t,2),r=n[0],i=n[1],s=ne();a.a.useEffect((function(){e.model&&e.model.setIgnoreKeys(r)}),[r,e.model]);var c=function(){null!=e.model&&e.model.setIgnoreKeys(!1),i(!1)};return a.a.createElement(a.a.Fragment,null,a.a.createElement(g.a,Object.assign({},e,{onClick:function(){i(!0)}}),e.children[0]),a.a.createElement(_.a,{open:r,onClose:c},a.a.createElement("div",{className:s.modal},a.a.cloneElement(e.children[1],{onClose:c}))))}function ae(e){var t=ne();return a.a.createElement(a.a.Fragment,null,a.a.createElement(k.a,{appear:!1,in:e.shown},a.a.createElement(w.a,null)),a.a.createElement(j.a,{appear:!1,direction:"down",in:e.shown},a.a.createElement(x.a,null,a.a.createElement(w.a,null,a.a.createElement(E.a,{container:!0,justify:"space-between"},a.a.createElement(O.a,{xsDown:!0},a.a.createElement(E.a,{item:!0,xs:4})),a.a.createElement(E.a,{item:!0,xs:4,className:t.titleContainer},a.a.createElement(O.a,{xsDown:!0},a.a.createElement(C.a,{variant:"h6",align:"center"},"Self-help sheets"),a.a.createElement(C.a,{variant:"caption",align:"center"},"Document your inner dialog")),a.a.createElement(O.a,{smUp:!0},a.a.createElement(C.a,{variant:"h7",align:"center"},"Self-help sheets"))),a.a.createElement(E.a,{item:!0,className:t.buttonsContainer,xs:8,sm:4},a.a.createElement(re,null,a.a.createElement(y.a,null),a.a.createElement(Z,null)),a.a.createElement(re,{model:e.model,edge:"start"},a.a.createElement(b.a,null),a.a.createElement(m.ErrorBoundary,null,a.a.createElement(r.Suspense,{fallback:a.a.createElement(ee.a,null,"Ladding...")},a.a.createElement(te,{model:e.model})))),a.a.createElement($,{gdriveAuthClient:S.b})))))))}var ie=n(24),se=n(56),oe=n(207),ce=n(197),ue=n(105),le=n.n(ue),he=n(71),de=n.n(he),pe=n(49),fe=n(196),me=Object(v.a)((function(e){return{outer:{position:"relative"},popup:{position:"absolute",display:"flex",flexDirection:"column",justifyContent:"center",minWidth:140,zIndex:2,padding:10,background:e.palette.background.paper,border:"gray solid 2px",borderRadius:4}}})),ye=a.a.forwardRef((function(e,t){var n=me();return e.in&&a.a.createElement("div",{className:n.outer},a.a.createElement(fe.a,{in:e.in},a.a.createElement("div",{ref:t,className:n.popup},e.children)))})),be=Object(v.a)((function(e){return{container:{alignSelf:"flex-start",margin:2,cursor:"pointer",borderColor:function(e){return e?"gray":"#0000"},border:"solid 2px",borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper},setupItem:{border:"2px solid",borderColor:function(e){return e?"darkgray":"#0000"},borderRadius:4,fontSize:20,display:"flex",alignItems:"center",justifyContent:"center"},icon:{cursor:"pointer",width:15,margin:0,padding:"4px 1px",height:"30px",border:"1px solid #0000",borderColor:function(e){return e?"gray":"#0000"}},emoji:{userSelect:"none",fontWeight:function(e){return 3===e?"bold":"unset"},opacity:function(e){return 3===e?1:2===e?.7:.3}}}}));function ve(e){var t=e.emoji,n=e.text,r=Object(ie.a)(e,["emoji","text"]),i=be(r.value);return a.a.createElement("span",Object.assign({className:i.emoji,role:"img","aria-label":n},r),String.fromCodePoint(t))}function ge(e){var t=e.selectedValue,n=e.value,r=Object(ie.a)(e,["selectedValue","value"]),i=be(t===n),s=5*(3-n)+1;return a.a.createElement(pe.a,Object.assign({className:i.icon,viewBox:"1 1 7 15"},r),a.a.createElement("rect",{y:s,width:"9",height:16-s,fill:n<=t?"red":"lightGray"}))}function _e(e){var t=e.value,n=e.isActive,r=Object(ie.a)(e,["value","isActive"]),i=be(n);return a.a.createElement("div",{className:i.setupItem},a.a.createElement(ve,Object.assign({},r,{value:3,onClick:function(){return r.onChange((t+1)%4)}})),a.a.createElement(ge,{onClick:function(){return r.onChange(0)},selectedValue:t,value:0}),a.a.createElement(ge,{onClick:function(){return r.onChange(1)},selectedValue:t,value:1}),a.a.createElement(ge,{onClick:function(){return r.onChange(2)},selectedValue:t,value:2}),a.a.createElement(ge,{onClick:function(){return r.onChange(3)},selectedValue:t,value:3}))}function ke(e){var t=a.a.useState(!1),n=Object(o.a)(t,2),r=n[0],i=n[1],s=a.a.useState(-1),c=Object(o.a)(s,2),u=c[0],l=c[1],h=a.a.useRef(),d=be(r);if(0===e.emojiArray.length)return null;var p=e.emojiArray.filter((function(e){return e.value>0})),f=0;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{tabIndex:0,onFocus:function(t){e.onFocus(t),i(!0)},onBlur:function(t){h.current.contains(document.activeElement)||(i(!1),e.onBlur(t))},className:d.container,onKeyDown:function(t){if("ArrowLeft"===t.key){if(u<0&&l(u=0),u<e.emojiArray.length){var n=Object(se.a)(e.emojiArray);n[u].value--,n[u].value<0&&(n[u].value=3),e.onEmojiArrayChange(n)}}else if("ArrowRight"===t.key){if(u<0&&l(u=0),u<e.emojiArray.length){var r=Object(se.a)(e.emojiArray);r[u].value++,r[u].value>3&&(r[u].value=0),e.onEmojiArrayChange(r)}}else if("ArrowDown"===t.key)++u>=e.emojiArray.length&&(u=0),l(u);else if("ArrowUp"===t.key)--u<0&&(u=e.emojiArray.length-1),l(u);else{if("Escape"!==t.key&&"Enter"!==t.key)return;e.inputRef.current.focus()}t.preventDefault()}},p.length>0?p.map((function(e){return a.a.createElement(ve,{key:e.codePoint,emoji:e.codePoint,text:e.text,value:e.value})})):a.a.createElement(C.a,{variant:"caption",color:"textSecondary"},"add mood"),a.a.createElement(ye,{in:r,ref:h},a.a.createElement(C.a,{align:"center",variant:"body1"},e.text),e.emojiArray.map((function(t){return a.a.createElement(_e,{key:t.codePoint,isActive:f++===u,emoji:t.codePoint,text:t.text,value:t.value,onChange:function(n){e.onEmojiArrayChange(e.emojiArray.map((function(e){return e.codePoint===t.codePoint?Object(M.a)(Object(M.a)({},e),{},{value:n}):e})))}})})),a.a.createElement(C.a,{align:"center",variant:"caption"},"Use arrow keys."))," "))}var we="loading",je="hidden",xe="deleted",Ee="editLeft",Oe="editRight",Ce="none",Se=function(){function e(t,n,r){Object(N.a)(this,e),this._data=n,this._key=t,this._initiallyCollapsed=!1,this._focused=!1,this.lastChange=Ce,this._setDescriptionImpl(r)}return Object(F.a)(e,[{key:"isDataLoaded",value:function(){return this._data!==we&&this._data!==je}},{key:"setDescription",value:function(e){var t=this.clone();return t._setDescriptionImpl(e),t}},{key:"setLeft",value:function(e){if(!this.isDataLoaded())return console.error("bad status"),this;var t=this.clone();return t._data=Object(M.a)(Object(M.a)({},this._data),{},{left:e}),t.lastChange=Ee,t}},{key:"setRight",value:function(e){if(!this.isDataLoaded())return console.error("bad status"),this;var t=this.clone();return t._data=Object(M.a)(Object(M.a)({},this._data),{},{right:e}),t.lastChange=Oe,t}},{key:"setEmojiLeft",value:function(t){var n=this.setDescription(e._generateDescription(t,this._emojiArrays[1],this._creationTime));return n.lastChange=Ee,n}},{key:"setEmojiRight",value:function(t){var n=this.setDescription(e._generateDescription(this._emojiArrays[0],t,this._creationTime));return n.lastChange=Oe,n}},{key:"setCreationTime",value:function(t){return this.setDescription(e._generateDescription(this._emojiArrays[0],this._emojiArrays[1],t))}},{key:"setInitiallyCollapsed",value:function(e){var t=this.clone();return t._initiallyCollapsed=e,t}},{key:"setFocused",value:function(e){var t=this.clone();return t._focused=e,t}},{key:"delete",value:function(){return new e(this._key,xe,xe)}},{key:"clear",value:function(){return new e(this._key,{left:"",right:""},"")}},{key:"show",value:function(){if(this._data!==je)throw new Error("show() has been called for entry that is not hidden");return new e(this._key,we,this._description)}},{key:"clone",value:function(){var t=new e(this._key,this.data);return t._emojiArrays=this._emojiArrays,t._creationTime=this._creationTime,t._description=this._description,t._initiallyCollapsed=this._initiallyCollapsed,t._focused=this._focused,t.lastChange=this.lastChange,t}},{key:"data",get:function(){return this._data instanceof Object?Object(M.a)({},this._data):this._data}},{key:"key",get:function(){return this._key}},{key:"description",get:function(){return this.isDataLoaded()?this._description:""}},{key:"left",get:function(){return this.isDataLoaded()?this._data.left:""}},{key:"right",get:function(){return this.isDataLoaded()?this._data.right:""}},{key:"emojiArrays",get:function(){return this._emojiArrays}},{key:"creationTime",get:function(){return this._creationTime}},{key:"initiallyCollapsed",get:function(){return this._initiallyCollapsed}},{key:"focused",get:function(){return this._focused}}]),Object(F.a)(e,[{key:"_setDescriptionImpl",value:function(e){if(this._emojiArrays=[[],[]],this._creationTime=null,this._description=e,"string"===typeof e&&e.length>0&&e!==xe){var t=e.split("-"),n=Object(o.a)(t,2),r=n[0],a=n[1];this._emojiArrays=r.split(":").map((function(e){return Array.from(e).map((function(e){return Number(e)}))})),2!==this._emojiArrays.length&&this._emojiArrays.push([]),this._creationTime=new Date(Number(a)),isNaN(this._creationTime.getTime())&&(this._creationTime=null)}}}],[{key:"_generateDescription",value:function(e,t,n){var r;return r=e.every((function(e){return 0===e}))&&t.every((function(e){return 0===e}))?"":e.join("")+":"+t.join(""),null!=n&&(r=r+"-"+n.getTime()),r}}]),e}(),De=function(e){return{border:"solid",borderRadius:4,backgroundColor:e.palette.background.paper,padding:function(e){return e.focused?4:5},borderWidth:function(e){return!0===e.focused?2:1},borderColor:function(t){return!0===t.focused?e.palette.primary.light:"gray"}}},Ae=Object(v.a)((function(e){return{inner:Object(f.a)({display:"flex",flex:1,flexDirection:"column",position:"relative"},e.breakpoints.up("sm"),De(e)),input:{padding:0,marginTop:function(e){return e.hasCreationTime?0:19},minHeight:function(e){return e.hasEmoji?76:104},alignItems:"flex-start"},outer:Object(f.a)({display:"flex",alignItems:"flex-start",flexDirection:"row"},e.breakpoints.down("xs"),De(e)),date:{border:"0px !important"},hint:{backgroundColor:e.palette.background.paper,whiteSpace:"pre-line"}}}));function Ie(e){var t=e.onFocus,n=e.emojiText,r=e.emojiArray,i=e.onDelete,s=e.creationTime,c=e.onEmojiArrayChange,u=e.onCollapseExited,l=e.collapsed,h=e.deleteXsDown,d=e.deleteSmUp,p=Object(ie.a)(e,["onFocus","emojiText","emojiArray","onDelete","creationTime","onEmojiArrayChange","onCollapseExited","collapsed","deleteXsDown","deleteSmUp"]),f=a.a.useState(!1),m=Object(o.a)(f,2),y=m[0],b=m[1],v=a.a.useState(!1),_=Object(o.a)(v,2),w=_[0],j=_[1];a.a.useEffect((function(){y&&t(null,!0)}),[y,t]);var x=Ae({hasCreationTime:!!s,hasEmoji:r.length>0,focused:y||w}),E=a.a.useRef();return a.a.useEffect((function(){!l&&p.autoFocus&&E.current.focus()}),[l,p.autoFocus]),a.a.createElement(k.a,{in:!l,onExited:u,onEntered:function(){p.autoFocus&&E.current.focus()}},a.a.createElement("div",{className:x.outer},a.a.createElement("div",{className:x.inner,onClick:function(){0===window.getSelection().toString().length&&E.current.focus()}},s&&a.a.createElement(C.a,{variant:"caption",color:"textSecondary",align:"center"},de()(s).format("h:mm a")),a.a.createElement(oe.a,Object.assign({className:x.input,fullWidth:!0,multiline:!0,placeholder:p.hint?p.hint.text:"",variant:"outlined",inputRef:E,onFocus:function(e){b(!0),t(e)},onBlur:function(e){b(!1)}},p)),a.a.createElement(ke,{text:n,onEmojiArrayChange:c,emojiArray:r,inputRef:E,onFocus:function(e){t(e),j(!0)},onBlur:function(e){j(!1)}}),null!=p.hint&&p.hint.isEnabled&&p.value.length>0&&a.a.createElement(ye,{in:y},a.a.createElement(C.a,{className:x.hint,color:"textSecondary",padding:10},p.hint.text))),a.a.createElement(O.a,{xsDown:!h,smUp:!d},a.a.createElement(g.a,{"aria-label":"delete",size:"small",onClick:i},a.a.createElement(le.a,{color:"action",fontSize:"small"})))))}var Me=a.a.forwardRef((function(e,t){var n=e.onFocus,r=e.onUpdate,i=(e.onRightChanged,e.entry),s=e.settings,c=Object(ie.a)(e,["onFocus","onUpdate","onRightChanged","entry","settings"]),u=Ae(),l=!!i.text||i.initiallyCollapsed,h=a.a.useState(l),d=Object(o.a)(h,2),p=d[0],f=d[1];if(a.a.useEffect((function(){l&&f(!1)}),[l]),i.text)return a.a.createElement("tr",{ref:t,className:u.date},a.a.createElement("td",{colSpan:2},a.a.createElement(k.a,{in:!p},a.a.createElement(C.a,{variant:"body2",align:"center",color:"textSecondary"},i.text))));console.assert(i instanceof Se),a.a.useEffect((function(){i.initiallyCollapsed&&r(i.setInitiallyCollapsed(!1),!0)}),[i,r]),a.a.useEffect((function(){i.data===je&&r(i.show(),!0)}));var m=[],y=[];if(null!=s)for(var b=0;b<s.emojiList.length;b++)m.push(Object(M.a)({value:null==i.emojiArrays[0][b]?0:i.emojiArrays[0][b]},s.emojiList[b])),y.push(Object(M.a)({value:null==i.emojiArrays[1][b]?0:i.emojiArrays[1][b]},s.emojiList[b]));var v=function(e){r(e)},g=function(e,t){i.focused&&r(i.setFocused(!1),!0),t||n(e)};return a.a.createElement("tr",{ref:t},a.a.createElement("td",{key:"issueElement"},i.isDataLoaded()?a.a.createElement(Ie,Object.assign({autoFocus:i.focused&&i.lastChange!==Oe,color:"secondary",creationTime:i.creationTime,value:i.left,onChange:function(e){return v(i.setLeft(e.target.value))},onFocus:g,onDelete:function(){f(!0)},deleteXsDown:!0,collapsed:p,hint:null==s?null:s.leftHint,emojiText:"How do you feel now?",emojiArray:m,onEmojiArrayChange:function(e){return v(i.setEmojiLeft(e.map((function(e){return e.value}))))}},c)):a.a.createElement(ce.a,{variant:"rect",height:135})),a.a.createElement("td",{key:"resolutionElement"},i.isDataLoaded()?a.a.createElement(Ie,Object.assign({autoFocus:i.focused&&i.lastChange===Oe,color:"primary",variant:"outlined",value:i.right,onChange:function(e){return v(i.setRight(e.target.value))},onFocus:g,deleteSmUp:!0,onDelete:function(){f(!0)},collapsed:p,onCollapseExited:function(e){return r(i.delete())},hint:null==s?null:s.rightHint,emojiText:"How do you feel after writing resolution?",emojiArray:y,onEmojiArrayChange:function(e){return v(i.setEmojiRight(e.map((function(e){return e.value}))))}},c)):a.a.createElement(ce.a,{variant:"rect",height:135})))})),Ne=n(106),Fe=n.n(Ne),Ke=n(41),Be=n.n(Ke),Le=n(199),Re=n(7),Te=n(64),ze=Object(T.a)("onHeightChanged"),Pe=Object(T.a)("resizeObserver"),He=function(e){Object(B.a)(n,e);var t=Object(L.a)(n);function n(){var e;Object(N.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).ref=a.a.createRef(),Object.defineProperty(Object(K.a)(e),ze,{writable:!0,value:function(){e.ref.current&&e.props.onHeightChanged(e.props.entry,e.ref.current.offsetHeight)}}),Object.defineProperty(Object(K.a)(e),Pe,{writable:!0,value:null}),e}return Object(F.a)(n,[{key:"componentDidMount",value:function(){this.ref.current&&(Object(R.a)(this,Pe)[Pe]=new ResizeObserver(Object(R.a)(this,ze)[ze]),Object(R.a)(this,Pe)[Pe].observe(this.ref.current))}},{key:"componentWillUnmount",value:function(){this.ref.current.contains(document.activeElement)&&this.props.scrollableContainerRef.current&&this.props.scrollableContainerRef.current.focus(),Object(R.a)(this,Pe)[Pe]&&(Object(R.a)(this,Pe)[Pe].disconnect(),Object(R.a)(this,Pe)[Pe]=null)}},{key:"render",value:function(){var e=this.props,t=(e.scrollableContainerRef,e.ItemComponent),n=(e.onHeightChanged,Object(ie.a)(e,["scrollableContainerRef","ItemComponent","onHeightChanged"]));return a.a.createElement(t,Object.assign({ref:this.ref},n))}}]),n}(a.a.PureComponent);function Ue(e){var t=e.entries,n=e.defaultHeight,r=void 0===n?150:n,i=e.scrollableContainerRef,s=e.ItemComponent,c=e.PlaceholderComponent,u=Object(ie.a)(e,["entries","defaultHeight","scrollableContainerRef","ItemComponent","PlaceholderComponent"]),l=a.a.useState(0),h=Object(o.a)(l,2),d=h[0],p=h[1],f=a.a.useState(window.innerHeight),m=Object(o.a)(f,2),y=m[0],b=m[1],v=a.a.useState(new Map),g=Object(o.a)(v,2),_=g[0],k=g[1],w=a.a.useCallback((function(e,t){k((function(n){var r=new Map(n);return r.set(e.key,t),r}))}),[]),j=new Set(t.map((function(e){return e.key}))),x=[];_.forEach((function(e,t){j.has(t)||x.push(t)})),x.length>0&&k((function(e){var t=new Map(e);return x.forEach((function(n){e.has(n)&&t.delete(n)})),t}));var E=function(){i.current&&p(i.current.scrollTop),b(window.innerHeight)};a.a.useEffect((function(){return i.current&&(i.current.onscroll=E),window.addEventListener("resize",E),function(){window.removeEventListener("resize",E)}}));var O,C=[],S=0,D=0,A=0,I=Object(Te.a)(t);try{for(I.s();!(O=I.n()).done;){var M=O.value,N=r;_.has(M.key)&&(N=_.get(M.key)),S+N<d-window.innerHeight?(M.focused&&i.current&&(i.current.scrollTop=S),D+=N):S<d+2*y?C.push(a.a.createElement(He,Object.assign({key:M.key,onHeightChanged:w,entry:M,ItemComponent:s,scrollableContainerRef:i},u))):(M.focused&&i.current&&(i.current.scrollTop=S),A+=N),S+=N}}catch(F){I.e(F)}finally{I.f()}return 0!==D&&C.unshift(a.a.createElement(c,{height:D,key:"placeholderTop"})),0!==A&&C.push(a.a.createElement(c,{height:A,key:"placeholderBottom"})),C}var Ve=n(198);function qe(e){var t=e.height,n=Object(ie.a)(e,["height"]);return a.a.createElement("tr",n,a.a.createElement("td",{colSpan:"2"},a.a.createElement("div",{style:{height:t}})))}var Ge=function(e){Object(B.a)(n,e);var t=Object(L.a)(n);function n(){var e;Object(N.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={entries:[]},e._onEntriesChanged=function(t,n,r){var a=r.canRedo,i=r.canUndo;if(t.length>0){for(var s=function(e){this.key=this.text=de()(e).calendar({sameDay:"[Today], MMM Do, ddd",lastDay:"[Yesterday] , MMM Do, ddd",lastWeek:"MMM Do YYYY, ddd",sameElse:"MMM Do YYYY, ddd"})},o=(t=Object(se.a)(t))[t.length-1].creationTime,c=t.length-2;c>=0;c--){var u=t[c].creationTime;null!=o?null==u||u.getTime()<o.getTime()||null!=u&&u.getYear()===o.getYear()&&u.getMonth()===o.getMonth()&&u.getDay()===o.getDay()||(t.splice(c+1,0,new s(o)),o=u):o=u}null!=o&&t.splice(0,0,new s(o))}e.setState({entries:t,settings:n,canRedo:a,canUndo:i})},e._tableRef=a.a.createRef(),e._scrollableContainerRef=a.a.createRef(),e._columnResizer=null,e._resizeObserver=null,e}return Object(F.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.model.subscribe(this._onEntriesChanged),this._columnResizer=new Fe.a(this._tableRef.current,{liveDrag:!0,minWidth:100,gripInnerHtml:"<div class='".concat(this.props.classes.grip,"'></div>"),onResize:function(e){window.dispatchEvent(new Event("resize"))}}),window.removeEventListener("resize",this._columnResizer.onResize),this._resizeObserver=new ResizeObserver(Be.a.throttle((function(){e._columnResizer.onResize()}),200)),this._resizeObserver.observe(this._tableRef.current)}},{key:"componentDidUpdate",value:function(e){this.props.model!==e.model&&(e.model.unsubscribe(this._onEntriesChanged),this.props.model.subscribe(this._onEntriesChanged))}},{key:"componentWillUnmount",value:function(){this.props.model.unsubscribe(this._onEntriesChanged),this._columnResizer.destroy(),this._resizeObserver.unobserve(this._tableRef.current)}},{key:"render",value:function(){var e=this;return a.a.createElement(a.a.Fragment,null,a.a.createElement(E.a,{className:this.props.classes.buttonsContainer,container:!0,justify:"space-between",spacing:0},a.a.createElement(E.a,{item:!0,xs:1,sm:2},!this.props.appBarShown&&a.a.createElement(g.a,{size:"small",onClick:this.props.onShowAppBar},a.a.createElement(Ve.a,{color:"primary"}))),a.a.createElement(E.a,{className:this.props.classes.buttons,item:!0,xs:6,sm:3},a.a.createElement(Le.a,{size:"small",onClick:function(){e.props.model.addNewItemThrottled()}},"Add new item")),a.a.createElement(E.a,{className:this.props.classes.buttons,item:!0,xs:5,sm:2},a.a.createElement(Le.a,{fullWidth:!0,size:"small",fontSize:"small",onClick:this.props.model.undo,disabled:!this.state.canUndo},"Undo"),a.a.createElement(Le.a,{fullWidth:!0,size:"small",fontSize:"small",disabled:!this.state.canRedo,onClick:this.props.model.redo},"Redo"))),a.a.createElement("div",{ref:this._scrollableContainerRef,className:this.props.classes.container,tabIndex:0},a.a.createElement("table",{cellPadding:0,cellSpacing:0,className:this.props.classes.entriesTable,ref:this._tableRef},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null),a.a.createElement("th",null))),a.a.createElement("tbody",null,a.a.createElement(Ue,{entries:this.state.entries,ItemComponent:Me,PlaceholderComponent:qe,scrollableContainerRef:this._scrollableContainerRef,onUpdate:this.props.model.onUpdate,onFocus:this.props.onFocus,settings:this.state.settings})))))}}]),n}(a.a.PureComponent),We=Object(Re.a)((function(e){return{container:{overflow:"auto",flex:1,willChange:"transform"},grip:{"&:hover":{backgroundColor:"#00F8",transitionDuration:"0s"},width:8,zIndex:10,position:"absolute",height:"100%",backgroundColor:"#0000",cursor:"col-resize",transitionProperty:"background-color",transitionDuration:"1s"},entriesTable:Object(f.a)({width:"100%",borderSpacing:0,"& th":{backgroundColor:e.palette.background.paper,zIndex:3,top:0,position:"sticky",borderSpacing:0,borderBottom:"1px solid lightGray"},"& td":{padding:2,verticalAlign:"top",borderLeft:"5px solid #0000",overflow:"inherit !important"},"& td:nth-child(odd)":{borderRight:"5px solid #0000",borderLeft:"20px solid #0000"}},e.breakpoints.down("xs"),{"& thead":{display:"none"},"& tbody tr":{display:"grid",padding:5,borderRadius:4,border:"1px solid #000"},"& td:nth-child(odd)":{borderRight:0,borderLeft:0},"& tbody td":{display:"block",borderLeft:0}}),buttonsContainer:{backgroundColor:e.palette.background.paper},buttons:{display:"flex",justifyContent:"center"}}}))(Ge),Je=n(208),Ye=n(200);function Xe(e){var t=e.model,n=Object(ie.a)(e,["model"]),r=a.a.useState(S.b.state),i=Object(o.a)(r,2),s=i[0],c=i[1];return a.a.useEffect((function(){S.b.addStateListener(c)}),[]),s===S.a.SIGNED_IN&&t?a.a.createElement(We,Object.assign({},n,{model:t})):s===S.a.SIGNED_OUT?a.a.createElement(ee.a,null,"Sign in to proceed..."):a.a.createElement(a.a.Fragment,null,a.a.createElement(Je.a,{invisible:!0,open:!0},a.a.createElement(Ye.a,{color:"inherit"})),";",a.a.createElement(ee.a,null," Loading...")," ")}var $e=n(107),Qe=function(){function e(){Object(N.a)(this,e)}return Object(F.a)(e,[{key:"requireFunction",value:function(e){var t=this;setTimeout((function(){if("function"!==typeof t[e])throw new Error(e+" is not implemented")}),0)}}]),e}(),Ze=function(e){Object(B.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(N.a)(this,n),(e=t.call(this)).requireFunction("createKey"),e.requireFunction("delete","key"),e.requireFunction("set","key","contentString"),e.requireFunction("get","key"),e.requireFunction("getMd5","key"),e.requireFunction("getAllKeys"),e.requireFunction("getSettings"),e.requireFunction("setSettings","settings"),e.requireFunction("setDescription","key","description"),e}return n}(Qe),et=Object(T.a)("settings_key"),tt=new(function(e){Object(B.a)(n,e);var t=Object(L.a)(n);function n(){var e;Object(N.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object.defineProperty(Object(K.a)(e),et,{writable:!0,value:null}),e}return Object(F.a)(n,[{key:"_getSettingsKey",value:function(){var e=Object(I.a)(A.a.mark((function e(){var t,n,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===Object(R.a)(this,et)[et]){e.next=2;break}return e.abrupt("return",Object(R.a)(this,et)[et]);case 2:return e.next=4,ft('name = "settings.json"');case 4:if(0!==(t=e.sent).length){e.next=9;break}return e.next=8,at("settings.json");case 8:return e.abrupt("return",e.sent);case 9:if(1!==t.length){e.next=11;break}return e.abrupt("return",t[0].id);case 11:return console.error("Invalid state. Multiple settings.json. "),n=Object($e.a)(t),r=n[0],n.slice(1).map((function(e){return yt(e.id)})),e.abrupt("return",r.id);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createKey",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nt(),e.next=3,at("item.json");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nt(),e.next=3,yt(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nt(),e.next=3,ct(t,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(I.a)(A.a.mark((function e(t){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nt(),e.next=3,dt(t);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMd5",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nt(),e.next=3,lt(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllKeys",value:function(){var e=Object(I.a)(A.a.mark((function e(){var t;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nt(),e.next=3,ft('name = "item.json"');case 3:return(t=e.sent).forEach((function(e){e.description||(e.description="")})),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getSettings",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nt(),e.t0=dt,e.next=4,this._getSettingsKey();case 4:return e.t1=e.sent,e.next=7,(0,e.t0)(e.t1);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSettings",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nt(),e.t0=ct,e.next=4,this._getSettingsKey();case 4:return e.t1=e.sent,e.t2=t,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setDescription",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nt(),e.abrupt("return",st(t,n));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(Ze));function nt(){if(S.b.state!==S.a.SIGNED_IN)throw new Error("Incorrect state. Sign in to continue.")}function rt(e,t){var n=(new Error).stack;return new Promise((function(r,a){e(t).then((function(e){e&&(e.status<200||e.status>299)?(console.log("GAPI call returned bad status",n,e),a(e)):r(e)}),(function(e){console.log("GAPI call failed ",n,e),a(e)}))}))}function at(e,t){return it.apply(this,arguments)}function it(){return(it=Object(I.a)(A.a.mark((function e(t,n){var r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt(window.gapi.client.drive.files.create,{resource:{name:t,mimeType:n||"text/plain",parents:["appDataFolder"]},fields:"id"});case 2:return r=e.sent,e.abrupt("return",r.result.id);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function st(e,t){return ot.apply(this,arguments)}function ot(){return(ot=Object(I.a)(A.a.mark((function e(t,n){var r,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.assert("string"===typeof n),"\r\n--"+(r="-------314159265358979323846")+"\r\n","\r\n--"+r+"--",a="\r\n---------314159265358979323846\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify({description:n})+"\r\n---------314159265358979323846--",e.next=7,rt(window.gapi.client.request,{path:"/upload/drive/v3/files/".concat(t),method:"PATCH",params:{uploadType:"multipart"},body:a,headers:{"Content-Type":'multipart/mixed; boundary="'+r+'"'}});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ct(e,t){return ut.apply(this,arguments)}function ut(){return(ut=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.assert("string"===typeof n),e.next=3,rt(window.gapi.client.request,{path:"/upload/drive/v3/files/".concat(t),method:"PATCH",params:{uploadType:"media"},fields:"md5Checksum",body:n});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lt(e){return ht.apply(this,arguments)}function ht(){return(ht=Object(I.a)(A.a.mark((function e(t){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt(window.gapi.client.request,{path:"/drive/v3/files/".concat(t),method:"GET",params:{fields:"md5Checksum"}});case 2:return n=e.sent,e.abrupt("return",n.result.md5Checksum);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(e){return pt.apply(this,arguments)}function pt(){return(pt=Object(I.a)(A.a.mark((function e(t){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rt(window.gapi.client.drive.files.get,{fileId:t,alt:"media"});case 3:return n=e.sent,e.abrupt("return",n.body);case 7:if(e.prev=7,e.t0=e.catch(0),404===e.t0.status){e.next=11;break}throw e.t0;case 11:return e.abrupt("return",void 0);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function ft(e){return mt.apply(this,arguments)}function mt(){return(mt=Object(I.a)(A.a.mark((function e(t){var n,r,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=[];case 2:return e.next=4,rt(window.gapi.client.drive.files.list,{spaces:"appDataFolder",fields:"files(id, description, md5Checksum), nextPageToken",pageSize:1e3,pageToken:r,orderBy:"createdTime",q:t});case 4:a=e.sent,n=n.concat(a.result.files),r=a.result.nextPageToken;case 7:if(r){e.next=2;break}case 8:return e.abrupt("return",n);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function yt(e){return bt.apply(this,arguments)}function bt(){return(bt=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rt(window.gapi.client.drive.files.delete,{fileId:t});case 3:return e.abrupt("return",!0);case 6:if(e.prev=6,e.t0=e.catch(0),404!==e.t0.status){e.next=10;break}return e.abrupt("return",!1);case 10:throw e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}Object.seal(tt);var vt=n(93),gt=n(72),_t=function(e){Object(B.a)(n,e);var t=Object(L.a)(n);function n(e,r){var a;return Object(N.a)(this,n),console.assert(e instanceof Ze),(a=t.call(this)).addNewItemThrottled=Be.a.throttle((function(){a.addNewItem()}),500),a.addNewItem=Object(I.a)(A.a.mark((function e(){var t,n,r,i=arguments;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]&&i[0],e.next=3,a._addNewItemMutex.acquire();case 3:if(n=e.sent,e.t0=a._tryFindVacantEntry(),e.t0){e.next=9;break}return e.next=8,a._createNewEntry();case 8:e.t0=e.sent;case 9:r=e.t0,a.onUpdate(r.clear().setFocused(!0).setInitiallyCollapsed(!0).setCreationTime(new Date(Date.now())),t),n();case 12:case"end":return e.stop()}}),e)}))),a.undo=function(){if(0!==a._historyIndex){a._historyIndex--;var e=a._history[a._historyIndex].old;e.data!==xe&&(e=e.setFocused(!0),a._history[a._historyIndex].new.data===xe&&(e=e.setInitiallyCollapsed(!0))),a._entries.set(e.key,e),a._sendEntryToBackend(e),a._onEntriesChanged()}},a.redo=function(){if(!(a._historyIndex>=a._history.length)){var e=a._history[a._historyIndex++],t=e.new;t.data!==xe&&(t=t.setFocused(!0),e.old.data===xe&&(t=t.setInitiallyCollapsed(!0))),a._entries.set(t.key,t),a._sendEntryToBackend(t),a._onEntriesChanged()}},a.sync=Object(I.a)(A.a.mark((function e(){var t,n,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a._disposed){e.next=2;break}return e.abrupt("return");case 2:if(a._authClient.state===S.a.SIGNED_IN){e.next=7;break}return e.next=5,a._authClient.waitForStateChange();case 5:e.next=2;break;case 7:return e.next=9,a._backendMap.getAllKeys();case 9:if(t=e.sent,n=new Map,t.forEach((function(e){var r;a._entries.has(e.id)?r=a._entries.get(e.id):e.description===xe?(e.outdated=!1,r=new Se(e.id).delete()):(e.outdated=!0,r=new Se(e.id,n.size<t.length-30?je:we,e.description),a._descriptions.set(e.id,e.description)),e.description!==a._descriptions.get(e.id)&&(r=r.setDescription(e.description),a._descriptions.set(e.id,e.description)),n.set(e.id,r)})),r=[],null==a._settings&&r.push(a._fetchSettings()),t.reverse().forEach((function(e){e.outdated&&n.get(e.id).data!==je&&r.push(a._fetch(e.id))})),a._entries.has(null)&&n.set(null,a._entries.get(null)),a._entries=n,0!==a._entries.size){e.next=21;break}return e.next=20,a.addNewItem(!0);case 20:return e.abrupt("return");case 21:return a._onEntriesChanged(),e.next=24,Promise.all(r);case 24:case"end":return e.stop()}}),e)}))),a.onSettingsUpdate=Be.a.debounce((function(e){a._settings=e,a._onEntriesChanged(),a._backendMap.setSettings(e.stringify())}),1e3),a.onUpdate=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(a._entries.has(e.key)){var n=a._entries.get(e.key);e.data!==we?(a._sendEntryToBackend(e),t||a._addHistoryItem(e),a._entries.set(e.key,e),a._onEntriesChanged()):n.data===je&&(a._fetch(e.key),a._entries.set(e.key,e))}},a._disposed=!1,a._historyIndex=0,a._history=[],a._authClient=null,a._backendMap=null,a._addNewItemMutex=new gt.a,a._entries=new Map,a._settings=null,a._descriptions=new Map,a._subscriptions=new Set,a._syncLoop=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.sync();case 2:setTimeout(a._syncLoop,15e3);case 3:case"end":return e.stop()}}),e)}))),a._onKeyPress=function(e){if(!a._ignoreKeys&&e.ctrlKey){if(90===e.keyCode)a.undo();else if(89===e.keyCode)a.redo();else{if(13!==e.keyCode)return;a.addNewItemThrottled()}e.preventDefault()}},a._fetch=function(){var e=Object(I.a)(A.a.mark((function e(t){var n,r,i,s;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a._backendMap.get(t);case 2:if(n=e.sent,a._entries.has(t)){e.next=6;break}return console.error("Entry for fetch doesn't exist anymore. "+t),e.abrupt("return");case 6:if(void 0!==n){e.next=11;break}return console.error("Key "+t+" is missing"),a._entries.delete(t),a._onEntriesChanged(),e.abrupt("return");case 11:if(e.prev=11,""!==n){e.next=18;break}r=new Se(t).delete(),a._addHistoryItem(r),a._entries.set(t,r),e.next=25;break;case 18:if((i=JSON.parse(n))===xe||null!=i.left&&null!=i.right){e.next=21;break}throw new Error("bad format "+n);case 21:i===xe&&a._descriptions.get(t)!==xe&&a._backendMap.setDescription(t,xe),s=new Se(t,i,a._descriptions.get(t)),a._addHistoryItem(s),a._entries.set(t,s);case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(11),console.error(e.t0.message+" "+t+" "+n),a._entries.get(t).isDataLoaded()||(a._entries.delete(t),a._descriptions.delete(t),a._backendMap.delete(t));case 31:a._onEntriesChanged();case 32:case"end":return e.stop()}}),e,null,[[11,27]])})));return function(t){return e.apply(this,arguments)}}(),a._backendMap=e,a._authClient=r,a._syncLoop(),window.addEventListener("keydown",a._onKeyPress),a}return Object(F.a)(n,[{key:"dispose",value:function(){this._disposed=!0,window.removeEventListener("keydown",this._onKeyPress),this._subscriptions=new Set}},{key:"subscribe",value:function(e){this._subscriptions.add(e),this._entries.size>0&&e(this._getFilteredEntriesArray(),this._settings)}},{key:"unsubscribe",value:function(e){this._subscriptions.delete(e)}},{key:"_tryFindVacantEntry",value:function(){var e=null;return this._entries.forEach((function(t){t.data===xe?null==e&&(e=t):e=null})),e}},{key:"_createNewEntry",value:function(){var e=Object(I.a)(A.a.mark((function e(){var t,n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._entries.has(null)){e.next=2;break}return e.abrupt("return");case 2:return this._entries.set(null,new Se(null).delete()),e.next=5,this._backendMap.createKey();case 5:if(t=e.sent,this._entries.has(null)){e.next=8;break}throw new Error("A null key should persist until the new key is created");case 8:return n=new Se(t,this._entries.get(null).data,""),this._entries.set(t,n),e.next=12,this._sendEntryToBackend(n);case 12:return this._entries.delete(null),e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setIgnoreKeys",value:function(e){this._ignoreKeys=e}},{key:"_addHistoryItem",value:function(e){if(null==e.key)throw new Error("null key shouldn't have value. There is no point to restore it.");this._entries.has(e.key)&&this._entries.get(e.key).isDataLoaded()&&(this._history=this._history.slice(0,this._historyIndex),this._history.push({old:this._entries.has(e.key)?this._entries.get(e.key):new Se(e.key).delete(),new:e}),this._historyIndex=this._history.length)}},{key:"_sendEntryToBackend",value:function(){var e=Object(I.a)(A.a.mark((function e(t){var n,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,t.description!==this._descriptions.get(t.key)&&(n=this._backendMap.setDescription(t.key,t.description),this._descriptions.set(t.key,t.description)),r=null,t.isDataLoaded()&&(r=this._backendMap.set(t.key,JSON.stringify(t.data))),e.next=6,Promise.all([n,r]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchSettings",value:function(){var e=Object(I.a)(A.a.mark((function e(){var t;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._backendMap.getSettings();case 2:if(t=e.sent,this._serializedSettings!==t){e.next=5;break}return e.abrupt("return");case 5:this._serializedSettings=t,this._settings=new vt.a(t),this._onEntriesChanged();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getFilteredEntriesArray",value:function(){return Array.from(this._entries.values()).reverse().filter((function(e){return e.data!==xe&&null!==e.key}))}},{key:"_onEntriesChanged",value:function(){var e=this,t=this._getFilteredEntriesArray();this._subscriptions.forEach((function(n){n(t,e._settings,{canRedo:e._history.length>e._historyIndex,canUndo:e._history.length>0&&e._historyIndex>0})}))}}]),n}(function(e){Object(B.a)(n,e);var t=Object(L.a)(n);function n(){var e;return Object(N.a)(this,n),(e=t.call(this)).requireFunction("subscribe","callback"),e.requireFunction("unsubscribe","callback"),e.requireFunction("onUpdate","entry","omitHistory"),e.requireFunction("onSettingsUpdate","settings"),e.requireFunction("setIgnoreKeys","ignoreKeys"),e.requireFunction("addNewItem"),e.requireFunction("undo"),e.requireFunction("redo"),e.requireFunction("sync"),e}return n}(Qe)),kt=n(82),wt=n.n(kt),jt=n(108),xt=n.n(jt);var Et=function(e){Object(B.a)(n,e);var t=Object(L.a)(n);function n(e){var r;if(Object(N.a)(this,n),(r=t.call(this))._changeKeysMutex=new gt.a,r._innerKeys=null,r._innerBackendMap=null,r._createChunkConnector=function(e){return{setValue:function(t){r._innerBackendMap.set(e,t)},setDescription:function(t){r._innerBackendMap.setDescription(e,t)},getValue:function(){var t=Object(I.a)(A.a.mark((function t(){return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r._innerBackendMap.get(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),delete:function(){var t=Object(I.a)(A.a.mark((function t(){return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r._innerKeys.splice(r._innerKeys.indexOf(e),1),r._chunks.delete(e),t.next=4,r._innerBackendMap.delete(e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},r._chunks=new Map,r._Chunk=function(){function e(t){var n=this,r=t.connector,a=t.serializedDescriptions,i=t.md5Checksum;Object(N.a)(this,e),this._onValueSet=Be.a.debounce((function(){n._serializedValues=JSON.stringify(n._values),n._connector.setValue(n._serializedValues)}),1e3),this._onDescriptionSet=Be.a.debounce((function(){n._serializedDescriptions=n._descriptions.map((function(e){return null===e?"null":e})).join(","),n._connector.setDescription(n._serializedDescriptions)}),1e3),this._fetchValuesSynchronised=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==n._fetchPromise&&(n._fetchPromise=n._fetchValues()),e.next=3,n._fetchPromise;case 3:n._fetchPromise=null;case 4:case"end":return e.stop()}}),e)}))),this._fetchPromise=null,this._fetchValues=Object(I.a)(A.a.mark((function e(){var t,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._connector.getValue();case 2:if(t=e.sent,e.prev=3,r=JSON.parse(t),Array.isArray(r)){e.next=7;break}throw new Error("Bad server data. Not valid array");case 7:for(;r.length<n._descriptions.length;)r.push("");n._values=r,n._serializedValues=t,n._initialMd5Checksum=wt()(t),n._isDirty=!1,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),console.error("Bad response from server:"+e.t0.message+" "+t),n._shouldKeepOnFormatError?(n._values=Array(8).fill(""),n._isDirty=!0,n._serializedValues=null,n._onValueSet()):n._connector.delete();case 18:case"end":return e.stop()}}),e,null,[[3,14]])}))),this._connector=r,this._initialMd5Checksum=i,void 0===a?(this._values=Array(8).fill(""),this._descriptions=[],this._isDirty=!0):(this._serializedDescriptions=a,this._isDirty=!1,this._descriptions=a.split(",").map((function(e){return"null"===e?null:e})))}return Object(F.a)(e,[{key:"isFull",value:function(){return this._descriptions.length>=8}},{key:"listSubKeys",value:function(){for(var e=[],t=0;t<this._descriptions.length&&t<8;t++)null!=this._descriptions[t]&&e.push(t);return e}},{key:"createSubKey",value:function(){var e=Object(I.a)(A.a.mark((function e(){var t;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._shouldKeepOnFormatError=!0,e.prev=1,null!=this._values){e.next=5;break}return e.next=5,this._fetchValuesSynchronised();case 5:if(null!=this._values){e.next=7;break}return e.abrupt("return",null);case 7:if(!this.isFull()){e.next=9;break}throw new Error("Do not call createSubKey for full chunks");case 9:return t=this._descriptions.length,this._descriptions.push(""),this.setDescription(t,""),e.abrupt("return",t);case 13:return e.prev=13,this._shouldKeepOnFormatError=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[1,,13,16]])})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this._descriptions[t]){e.next=2;break}throw new Error("item is already deleted");case 2:if(1!==this._descriptions.filter((function(e){return null!=e})).length){e.next=7;break}return e.next=5,this._connector.delete();case 5:e.next=8;break;case 7:this.setDescription(t,null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setValue",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this._values){e.next=3;break}return e.next=3,this._fetchValuesSynchronised();case 3:if(null!=this._values){e.next=5;break}return e.abrupt("return");case 5:this._values[t]=n,this._isDirty=!0,this._serializedValues=null,this._onValueSet();case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getValue",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._descriptions[t]){e.next=2;break}return e.abrupt("return",void 0);case 2:if(null!=this._values){e.next=5;break}return e.next=5,this._fetchValuesSynchronised();case 5:if(null!=this._values){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.abrupt("return",this._values[t]);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setDescription",value:function(e,t){if(e>=this._descriptions.length||null==this._descriptions[e])throw new Error("null description means subkey doesn't exist. Did you call createKey?");this._descriptions[e]=t,this._serializedDescriptions=null,this._isDirty=!0,this._onDescriptionSet()}},{key:"getDescription",value:function(e){return this._descriptions[e]}},{key:"onMetadataUpdate",value:function(e,t){return this._isDirty?(null!=this._serializedValues&&null!=this._serializedDescriptions&&wt()(this._serializedValues)===t&&this._serializedDescriptions===e&&(this._isDirty=!1,this._initialMd5Checksum=t),{outdated:!1}):(this._serializedDescriptions!==e&&(this._serializedDescriptions=e,this._descriptions=e.split(",").map((function(e){return"null"===e?null:e}))),this._initialMd5Checksum!==t?(this._serializedValues=null,this._values=null,{outdated:!0}):{outdated:!1})}}]),e}(),r._splitOuterKey=function(e){var t=e.indexOf("-");return{prefixKey:Number(e.substring(0,t)),innerKey:e.substring(t+1)}},!e instanceof Ze)throw new Error("CachingBackendMap have to accepts instance of BackendMap");return r._innerBackendMap=e,r}return Object(F.a)(n,[{key:"createKey",value:function(){var e=Object(I.a)(A.a.mark((function e(){var t,n,r,a,i,s=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._changeKeysMutex.acquire();case 2:if(t=e.sent,e.prev=3,null!==this._innerKeys){e.next=6;break}throw new Error("You should call getAllKeys first");case 6:if(n=function(){if(0!==s._innerKeys.length)return s._innerKeys[s._innerKeys.length-1]},0!==this._innerKeys.length&&!this._chunks.get(n()).isFull()){e.next=13;break}return e.next=10,this._innerBackendMap.createKey();case 10:r=e.sent,this._innerKeys.push(r),this._chunks.set(r,new this._Chunk({connector:this._createChunkConnector(r)}));case 13:return a=n(),e.next=16,this._chunks.get(a).createSubKey();case 16:return i=e.sent,e.abrupt("return",i+"-"+a);case 18:return e.prev=18,t(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[3,,18,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(I.a)(A.a.mark((function e(t){var n,r,a,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._changeKeysMutex.acquire();case 2:if(n=e.sent,e.prev=3,r=this._splitOuterKey(t),a=r.prefixKey,i=r.innerKey,this._chunks.has(i)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this._chunks.get(i).delete(a);case 9:return e.prev=9,n(),e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[3,,9,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){var r,a,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._splitOuterKey(t),a=r.prefixKey,i=r.innerKey,this._chunks.has(i)){e.next=3;break}return e.abrupt("return");case 3:this._chunks.get(i).setValue(a,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getMd5",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Don't call getMd5 on this class. Server cannot compute md5 for this item because it is multiplexed.In order to sync call |getAllKeys| and if some item has |outdated===true| call |get|.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(I.a)(A.a.mark((function e(t){var n,r,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._splitOuterKey(t),r=n.prefixKey,a=n.innerKey,this._chunks.has(a)){e.next=3;break}return e.abrupt("return",void 0);case 3:return e.abrupt("return",this._chunks.get(a).getValue(r));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllKeys",value:function(){var e=Object(I.a)(A.a.mark((function e(){var t,n,r,a,i,s=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._changeKeysMutex.acquire();case 2:return t=e.sent,e.prev=3,e.next=6,this._innerBackendMap.getAllKeys();case 6:return n=e.sent,r=[],a=new Map,i=0,n.forEach((function(e){var t=!0,n=0===i++;if(s._chunks.has(e.id)){var o=s._chunks.get(e.id);a.set(e.id,o),t=o.onMetadataUpdate(e.description,e.md5Checksum).outdated}else a.set(e.id,new s._Chunk({connector:s._createChunkConnector(e.id),serializedDescriptions:e.description,isFirstChunk:n,md5Checksum:e.md5Checksum}));var c=a.get(e.id);c.listSubKeys().forEach((function(n){r.push({id:n+"-"+e.id,outdated:t,description:c.getDescription(n)})}))})),this._chunks=a,this._innerKeys=n.map((function(e){return e.id})),e.abrupt("return",r);case 14:return e.prev=14,t(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[3,,14,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"getSettings",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._innerBackendMap.getSettings();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSettings",value:function(){var e=Object(I.a)(A.a.mark((function e(t){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._changeKeysMutex.acquire();case 2:return n=e.sent,e.next=5,this._innerBackendMap.setSettings(t);case 5:n();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setDescription",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){var r,a,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._splitOuterKey(t),a=r.prefixKey,i=r.innerKey,this._chunks.has(i)){e.next=3;break}return e.abrupt("return");case 3:this._chunks.get(i).setDescription(a,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(Ze),Ot=function(e){Object(B.a)(n,e);var t=Object(L.a)(n);function n(e){var r;if(Object(N.a)(this,n),(r=t.call(this))._innerBackendMap=null,!e instanceof Ze)throw new Error("CachingBackendMap have to accepts instance of BackendMap");return r._innerBackendMap=e,r}return Object(F.a)(n,[{key:"_exponentialRetry",value:function(){var e=Object(I.a)(A.a.mark((function e(t){var n,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=1;case 1:if(!(n<10)){e.next=16;break}return e.prev=2,e.next=5,t();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),r=1*Math.pow(3,n++),console.error("Failed running ".concat(t.name," : ").concat(e.t0.message,". Will try again after ").concat(r," seconds.")),e.next=14,this._sleep(1e3*r);case 14:e.next=1;break;case 16:console.error("finish retry attempts");case 17:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createKey",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.createKey.bind(this._innerBackendMap));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.delete.bind(this._innerBackendMap,t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.set.bind(this._innerBackendMap,t,n));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.get.bind(this._innerBackendMap,t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMd5",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.getMd5.bind(this._innerBackendMap,t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllKeys",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.getAllKeys.bind(this._innerBackendMap));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSettings",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.getSettings.bind(this._innerBackendMap));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSettings",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.setSettings.bind(this._innerBackendMap,t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setDescription",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._exponentialRetry(this._innerBackendMap.setDescription.bind(this._innerBackendMap,t,n));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_sleep",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}]),n}(Ze),Ct=function(e){Object(B.a)(n,e);var t=Object(L.a)(n);function n(e){var r;if(Object(N.a)(this,n),(r=t.call(this))._innerBackendMap=null,!e instanceof Ze)throw new Error("CachingBackendMap have to accepts instance of BackendMap");return r._innerBackendMap=e,r._limiter=new xt.a({maxConcurrent:5,minTime:50}),r}return Object(F.a)(n,[{key:"createKey",value:function(){var e=Object(I.a)(A.a.mark((function e(){var t=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return t._innerBackendMap.createKey()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(I.a)(A.a.mark((function e(t){var n=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return n._innerBackendMap.delete(t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){var r=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return r._innerBackendMap.set(t,n)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(I.a)(A.a.mark((function e(t){var n=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return n._innerBackendMap.get(t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMd5",value:function(){var e=Object(I.a)(A.a.mark((function e(t){var n=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return n._innerBackendMap.getMd5(t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllKeys",value:function(){var e=Object(I.a)(A.a.mark((function e(){var t=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return t._innerBackendMap.getAllKeys()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSettings",value:function(){var e=Object(I.a)(A.a.mark((function e(){var t=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return t._innerBackendMap.getSettings()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSettings",value:function(){var e=Object(I.a)(A.a.mark((function e(t){var n=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return n._innerBackendMap.setSettings(t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setDescription",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){var r=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._limiter.schedule((function(){return r._innerBackendMap.setDescription(t,n)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(Ze);var St=function(){var e=Object(c.a)("(prefers-color-scheme: dark)"),t=a.a.useMemo((function(){return Object(u.a)({palette:{type:e?"dark":"light",primary:{main:e?d.a[900]:p.a[800]},background:{default:e?"#303030":d.a[50]}}})}),[e]),n=a.a.useState(!0),r=Object(o.a)(n,2),i=r[0],s=r[1],f=a.a.useCallback((function(e){window.innerHeight<700&&s(!1)}),[]),m=a.a.useCallback((function(e){s(!0)}),[]),y=a.a.useState(null),b=Object(o.a)(y,2),v=b[0],g=b[1];return a.a.useEffect((function(){S.b.addStateListener((function(e){e===S.a.SIGNED_IN?g(new _t(new Et(new Ct(new Ot(tt))),S.b)):g((function(e){return e&&e.dispose(),null}))}))}),[]),a.a.createElement(l.a,{theme:t},a.a.createElement(h.a,null),a.a.createElement(ae,{shown:i,model:v}),a.a.createElement(Xe,{onFocus:f,appBarShown:i,onShowAppBar:m,model:v}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(St,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},55:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a=n.n(r),i=n(161),s=n(111),o=Object(i.a)({container:{flex:1,display:"flex",justifyContent:"center",alignItems:"center"}});function c(e){var t=o();return a.a.createElement("div",{className:t.container},a.a.createElement(s.a,Object.assign({variant:"h4"},e),e.children))}},93:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(10),i=function(){function e(t){if(Object(r.a)(this,e),"string"===typeof t&&(t=JSON.parse(t)),"boolean"!==typeof t.isEnabled||"string"!==typeof t.text)throw new Error("Wrong hint data "+JSON.stringify(t));this._isEnabled=t.isEnabled,this._text=t.text}return Object(a.a)(e,[{key:"setIsEnabled",value:function(t){return new e({isEnabled:t,text:this._text})}},{key:"setText",value:function(t){return new e({text:t,isEnabled:this._isEnabled})}},{key:"isEnabled",get:function(){return this._isEnabled}},{key:"text",get:function(){return this._text}}]),Object(a.a)(e,[{key:"stringify",value:function(){return JSON.stringify({isEnabled:this._isEnabled,text:this._text})}}]),e}(),s=function(){function e(t){Object(r.a)(this,e);try{if("string"===typeof t&&(t=JSON.parse(t)),!Array.isArray(t.emojiList)||!t.emojiList.every((function(e){return"string"===typeof String.fromCodePoint(e.codePoint)})))throw new Error("Bad emoji list: "+JSON.stringify(t));this._emojiList=t.emojiList,this._leftHint=new i(t.leftHint),this._rightHint=new i(t.rightHint)}catch(n){t&&console.error("Settings format error:"+n.message),this._mutateToDefaults()}}return Object(a.a)(e,[{key:"setEmojiList",value:function(t){return new e({emojiList:t,leftHint:this._leftHint,rightHint:this._rightHint})}},{key:"setLeftHint",value:function(t){return new e({emojiList:this._emojiList,leftHint:t,rightHint:this._rightHint})}},{key:"setRightHint",value:function(t){return new e({emojiList:this._emojiList,leftHint:this._leftHint,rightHint:t})}},{key:"stringify",value:function(){return JSON.stringify({emojiList:this._emojiList,leftHint:this._leftHint.stringify(),rightHint:this._rightHint.stringify()})}},{key:"emojiList",get:function(){return this._emojiList}},{key:"leftHint",get:function(){return this._leftHint}},{key:"rightHint",get:function(){return this._rightHint}}]),Object(a.a)(e,[{key:"_mutateToDefaults",value:function(){this._leftHint=new i({isEnabled:!0,text:"What happened?\nWhat were your immediate thoughts?"}),this._rightHint=new i({isEnabled:!0,text:"Why is it bad?\nWhat would your therapist say?\nIs your view of the problem biased?"}),this._emojiList=[{codePoint:128078,text:"discontent"},{codePoint:128552,text:"fear"},{codePoint:128546,text:"sadness"},{codePoint:128557,text:"grief"},{codePoint:128561,text:"horror"},{codePoint:128534,text:"pain"},{codePoint:128545,text:"anger"},{codePoint:129314,text:"disgust"}]}}]),e}()}},[[119,1,2]]]);
//# sourceMappingURL=main.d6c5f9df.chunk.js.map